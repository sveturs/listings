# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: GIS –º–æ–¥—É–ª—å –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ Sve Tu (–≤–µ—Ä—Å–∏—è 2.0)

**–î–∞—Ç–∞**: 2025-01-10  
**–í–µ—Ä—Å–∏—è**: 2.0  
**–°—Ç–∞—Ç—É—Å**: –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —É—á–µ—Ç–æ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π](#—Ä–µ–∑—é–º–µ-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è](#–∞–Ω–∞–ª–∏–∑-—Ç–µ–∫—É—â–µ–≥–æ-—Å–æ—Å—Ç–æ—è–Ω–∏—è)
3. [–¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏](#—Ü–µ–ª–∏-–∏-–∑–∞–¥–∞—á–∏)
4. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
5. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
6. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–∏-–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
7. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–∏-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
8. [–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–ø–ª–∞–Ω-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
9. [–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞](#–º–µ—Ç—Ä–∏–∫–∏-—É—Å–ø–µ—Ö–∞)
10. [–†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è](#—Ä–∏—Å–∫–∏-–∏-–º–∏—Ç–∏–≥–∞—Ü–∏—è)

## üîÑ –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –≤–µ—Ä—Å–∏–∏ 2.0:
- ‚úÖ –£—á–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π GIS –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–º–æ–¥—É–ª–∏ geocode, marketplace/map)
- ‚úÖ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ —Å DECIMAL –Ω–∞ PostGIS –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenSearch –¥–ª—è –≥–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ offline —Ä–µ–∂–∏–º
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö –∏ GDPR compliance
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –°–µ—Ä–±–∏–∏ (—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –¥–≤—É—è–∑—ã—á–Ω–æ—Å—Ç—å)
- ‚úÖ –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å quick wins

## 1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 1.1 –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL:
```sql
-- –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
marketplace_listings:
  - latitude DECIMAL(10,8)
  - longitude DECIMAL(11,8)
  - show_on_map BOOLEAN
  - city, country VARCHAR
  
user_storefronts:
  - latitude, longitude DECIMAL
  - address, city, country VARCHAR
```

#### Backend –º–æ–¥—É–ª–∏:
- `internal/proj/geocode/` - —Å–µ—Ä–≤–∏—Å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
  - `/api/v1/geocode/reverse` - –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `/api/v1/geocode/cities` - –ø–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤
- `internal/proj/marketplace/map/` - —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ä—Ç–∞–º–∏
  - `/api/v1/marketplace/map/bounds` - –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö
  - `/api/v1/marketplace/map/clusters` - –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

#### Frontend:
- Leaflet v1.9.4 + React-Leaflet v5.0.0
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: LocationMap, LocationStep, MapFilters
- OpenStreetMap –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1.2 –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ:**
   - –ù–µ—Ç PostGIS ‚Üí –º–µ–¥–ª–µ–Ω–Ω—ã–µ –≥–µ–æ–∑–∞–ø—Ä–æ—Å—ã
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≥–µ–æ–ø–æ–ª—è ‚Üí –Ω–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è ‚Üí –ª–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã

2. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:**
   - –ù–µ—Ç –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏
   - –ù–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

3. **UX:**
   - –ë–∞–∑–æ–≤—ã–π UI –∫–∞—Ä—Ç—ã
   - –ù–µ—Ç –º–æ–±–∏–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç offline —Ä–µ–∂–∏–º

## 2. –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏

### 2.1 –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π GIS –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π **—Ä–∞—Å—à–∏—Ä–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É** –∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç Sve Tu –≤ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å.

### 2.2 –ö–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏
1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ** - —É–ª—É—á—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –º–æ–¥—É–ª–µ–π
2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞** - –Ω–æ–≤—ã–µ GIS –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
3. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏** - —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π –≥–µ–æ–ø–æ–∏—Å–∫
4. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –°–µ—Ä–±–∏–∏** - —É—á–µ—Ç –º–µ—Å—Ç–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏
5. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–æ—Å—Ç—É

## 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 3.1 –ö–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### 3.1.1 –£–ª—É—á—à–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```typescript
// –ê–ø–≥—Ä–µ–π–¥ —Ç–µ–∫—É—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
LocationMap.tsx ‚Üí InteractiveMap.tsx
  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—ã –∑—É–º–∞
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∂–µ—Å—Ç–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
  - –ö–Ω–æ–ø–∫–∞ "–ú–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ"
  - –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–ª–æ–µ–≤ –∫–∞—Ä—Ç—ã

MapFilters.tsx ‚Üí AdvancedMapFilters.tsx
  - –§–∏–ª—å—Ç—Ä –ø–æ —Ä–∞–¥–∏—É—Å—É (1-50 –∫–º)
  - –§–∏–ª—å—Ç—Ä –ø–æ —Ä–∞–π–æ–Ω–∞–º
  - –¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –Ω–∞ –∫–∞—Ä—Ç–µ
  - –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –º–∞–≥–∞–∑–∏–Ω–æ–≤
```

#### 3.1.2 –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```typescript
// –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã GIS
src/components/GIS/
‚îú‚îÄ‚îÄ Mobile/
‚îÇ   ‚îú‚îÄ‚îÄ MobileMapView.tsx      // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ OfflineMap.tsx         // Offline —Ä–µ–∂–∏–º
‚îú‚îÄ‚îÄ Analytics/
‚îÇ   ‚îú‚îÄ‚îÄ HeatMap.tsx            // –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Å–ø—Ä–æ—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ DensityMap.tsx         // –ü–ª–æ—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ PriceMap.tsx           // –ö–∞—Ä—Ç–∞ —Ü–µ–Ω –ø–æ —Ä–∞–π–æ–Ω–∞–º
‚îú‚îÄ‚îÄ Routing/
‚îÇ   ‚îú‚îÄ‚îÄ RouteSearch.tsx        // –ü–æ–∏—Å–∫ "–ø–æ –ø—É—Ç–∏"
‚îÇ   ‚îî‚îÄ‚îÄ DeliveryZones.tsx      // –ó–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏
‚îî‚îÄ‚îÄ Accessibility/
    ‚îú‚îÄ‚îÄ A11yMap.tsx            // –î–æ—Å—Ç—É–ø–Ω–∞—è –∫–∞—Ä—Ç–∞
    ‚îî‚îÄ‚îÄ VoiceControl.tsx       // –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```

### 3.2 –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫

#### 3.2.1 –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ API
```typescript
// –ù–æ–≤—ã–µ endpoints
GET  /api/v1/gis/search/radius      // –ü–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ
GET  /api/v1/gis/search/route       // –ü–æ–∏—Å–∫ –≤–¥–æ–ª—å –º–∞—Ä—à—Ä—É—Ç–∞
GET  /api/v1/gis/search/polygon     // –ü–æ–∏—Å–∫ –≤ –ø–æ–ª–∏–≥–æ–Ω–µ
POST /api/v1/gis/zones              // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–æ–Ω–∞–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
GET  /api/v1/gis/analytics/heatmap  // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã
```

#### 3.2.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenSearch
```json
// –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenSearch
{
  "query": {
    "bool": {
      "filter": {
        "geo_distance": {
          "distance": "10km",
          "location": {
            "lat": 44.8178,
            "lon": 20.4568
          }
        }
      }
    }
  }
}
```

### 3.3 –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –°–µ—Ä–±–∏–∏

#### 3.3.1 –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ
```sql
-- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
CREATE TABLE serbian_municipalities (
  id SERIAL PRIMARY KEY,
  code VARCHAR(10) UNIQUE,
  name_sr_cyrl VARCHAR(100), -- –°—Ä–ø—Å–∫–∏
  name_sr_latn VARCHAR(100), -- Srpski
  name_en VARCHAR(100),      -- English
  district_id INT,
  boundary GEOMETRY(MULTIPOLYGON, 4326),
  population INT,
  metadata JSONB
);
```

#### 3.3.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º
- API GSP –ë–µ–ª–≥—Ä–∞–¥ (–∞–≤—Ç–æ–±—É—Å—ã, —Ç—Ä–∞–º–≤–∞–∏)
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–µ–∑–¥–æ–≤ –ñ–µ–ª–µ–∑–Ω–∏—Ü–µ –°—Ä–±–∏—ò–µ
- –ü–∞—Ä–∫–æ–≤–∫–∏ —á–µ—Ä–µ–∑ Parking Servis Beograd

### 3.4 –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

#### 3.4.1 Progressive Web App
```javascript
// Service Worker –¥–ª—è offline –∫–∞—Ä—Ç
self.addEventListener('fetch', event => {
  if (event.request.url.includes('tile.openstreetmap.org')) {
    event.respondWith(
      caches.match(event.request)
        .then(response => response || fetch(event.request))
    );
  }
});
```

#### 3.4.2 –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π UI
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ < 768px
- –°–≤–∞–π–ø—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤
- –ö—Ä—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–∞—á-—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–µ–π –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 4.1 –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostGIS

#### 4.1.1 –ü–æ—ç—Ç–∞–ø–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```sql
-- –§–∞–∑–∞ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PostGIS
CREATE EXTENSION IF NOT EXISTS postgis;

-- –§–∞–∑–∞ 2: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
ALTER TABLE marketplace_listings 
ADD COLUMN location GEOGRAPHY(POINT, 4326);

-- –§–∞–∑–∞ 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
UPDATE marketplace_listings 
SET location = ST_Point(longitude, latitude)
WHERE longitude IS NOT NULL;

-- –§–∞–∑–∞ 4: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ PostGIS
-- –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–ª–æ–Ω–∫–∏
```

#### 4.1.2 –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
```sql
-- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_listings_location_gist 
ON marketplace_listings USING GIST(location);

CREATE INDEX idx_listings_location_geohash 
ON marketplace_listings (ST_GeoHash(location));
```

### 4.2 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 4.2.1 Redis –¥–ª—è –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö
```typescript
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
const cacheKey = `geocode:${hashAddress(address)}`;
const cached = await redis.get(cacheKey);
if (cached) return JSON.parse(cached);

const result = await nominatim.geocode(address);
await redis.setex(cacheKey, 86400, JSON.stringify(result));
```

#### 4.2.2 CDN –¥–ª—è —Ç–∞–π–ª–æ–≤
- Cloudflare –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è OSM —Ç–∞–π–ª–æ–≤
- –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–∞–π–ª–æ–≤
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–∞–π–ª–æ–≤ –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

### 4.3 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
backend/internal/proj/gis/
‚îú‚îÄ‚îÄ handler/
‚îÇ   ‚îú‚îÄ‚îÄ spatial_search.go      // –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ analytics.go           // –ì–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ zones.go               // –ó–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ routing.go             // –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ postgis/               // PostGIS –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ opensearch/            // –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä—ã OpenSearch
‚îÇ   ‚îú‚îÄ‚îÄ cache/                 // Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ external/              // –í–Ω–µ—à–Ω–∏–µ API
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îú‚îÄ‚îÄ geolocation.go         // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ rate_limit.go          // –õ–∏–º–∏—Ç—ã –Ω–∞ –≥–µ–æ API
‚îÇ   ‚îî‚îÄ‚îÄ privacy.go             // –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ migrations/
    ‚îú‚îÄ‚îÄ 001_enable_postgis.sql
    ‚îú‚îÄ‚îÄ 002_migrate_coordinates.sql
    ‚îî‚îÄ‚îÄ 003_serbian_boundaries.sql
```

## 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

### 5.1 –ó–∞—â–∏—Ç–∞ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö

#### 5.1.1 –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è
```go
// –†–∞–∑–º—ã—Ç–∏–µ —Ç–æ—á–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
func AnonymizeLocation(lat, lng float64) (float64, float64) {
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ 50-100–º
    offset := 0.0005 + rand.Float64() * 0.0005
    angle := rand.Float64() * 2 * math.Pi
    
    newLat := lat + offset * math.Cos(angle)
    newLng := lng + offset * math.Sin(angle)
    
    return newLat, newLng
}
```

#### 5.1.2 GDPR Compliance
```typescript
// –û—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –≥–µ–æ–¥–∞–Ω–Ω—ã–µ
interface GeoConsent {
  allowPreciseLocation: boolean;
  allowLocationHistory: boolean;
  allowLocationAnalytics: boolean;
  retentionDays: number; // max 30
}
```

### 5.2 –ê–Ω—Ç–∏—Å–ø—É—Ñ–∏–Ω–≥

```go
// –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —á–µ—Ä–µ–∑ IP
func ValidateLocationByIP(ip string, lat, lng float64) bool {
    ipLocation := geoip.Lookup(ip)
    distance := haversine(ipLocation.Lat, ipLocation.Lng, lat, lng)
    
    // –†–∞–∑—Ä–µ—à–∞–µ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –¥–æ 100–∫–º
    return distance < 100
}
```

## 6. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### 6.1 –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –û–ø–µ—Ä–∞—Ü–∏—è | –¶–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è |
|----------|---------------|-------------------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã | < 1.5 —Å–µ–∫ | < 3 —Å–µ–∫ |
| –ì–µ–æ–ø–æ–∏—Å–∫ (1000 –æ–±—ä–µ–∫—Ç–æ–≤) | < 150 –º—Å | < 300 –º—Å |
| –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ 500 –º–∞—Ä–∫–µ—Ä–æ–≤ | < 50 –º—Å | < 100 –º—Å |
| –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å –∫—ç—à–µ–º) | < 50 –º—Å | < 100 –º—Å |
| Mobile TTI | < 3 —Å–µ–∫ | < 5 —Å–µ–∫ |

### 6.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### 6.2.1 –ë–∞–∑–æ–≤—ã–µ
- –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ –ø—Ä–∏ zoom < 14
- Lazy loading –º–∞—Ä–∫–µ—Ä–æ–≤ –≤–Ω–µ viewport
- Debounce –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã
- Virtual scrolling –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

#### 6.2.2 –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ
- WebGL —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ Mapbox GL
- Web Workers –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö
- –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —Ç–∞–π–ª—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- GraphQL –¥–ª—è –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª–µ–π

### 6.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```typescript
// –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è DataDog
interface GeoMetrics {
  mapLoadTime: number;
  searchLatency: number;
  markerRenderTime: number;
  geocodingHitRate: number;
  tileLoadErrors: number;
}
```

## 7. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1 –Ω–µ–¥–µ–ª—è)
- [x] –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- [x] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –¢–ó
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostGIS –Ω–∞ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Leaflet, React-Leaflet)

### –§–∞–∑–∞ 1: Quick Wins (1 –Ω–µ–¥–µ–ª—è)
- [ ] –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≥–µ–æ–ø–æ–ª—è –¥–ª—è –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- [ ] –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ä–∞–¥–∏—É—Å—É
- [ ] –£–ª—É—á—à–µ–Ω–∏–µ UI —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–∞—Ä—Ç—ã
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

### –§–∞–∑–∞ 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (2 –Ω–µ–¥–µ–ª–∏)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostGIS
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≥–µ–æ–ø–æ–∏—Å–∫
- [ ] –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- [ ] –ó–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è storefronts

### –§–∞–∑–∞ 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (2 –Ω–µ–¥–µ–ª–∏)
- [ ] –ü–æ–∏—Å–∫ "–ø–æ –ø—É—Ç–∏"
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º
- [ ] –ì–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ç–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã
- [ ] Offline —Ä–µ–∂–∏–º

### –§–∞–∑–∞ 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (1 –Ω–µ–¥–µ–ª—è)
- [ ] Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –≥–µ–æ
- [ ] –ü—Ä–æ–º–æ-–∞–∫—Ü–∏–∏ –ø–æ —Ä–∞–π–æ–Ω–∞–º
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

## 8. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### 8.1 –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏
| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–µ–µ | –¶–µ–ª–µ–≤–æ–µ | –°—Ä–æ–∫ |
|---------|---------|---------|------|
| –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ–∏—Å–∫–∞ | 3.2% | 4.5% | 3 –º–µ—Å |
| –û–±—ä—è–≤–ª–µ–Ω–∏–π —Å –≥–µ–æ | 45% | 90% | 2 –º–µ—Å |
| –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏ | - | +30% | 3 –º–µ—Å |
| –í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ | 4:30 | 6:00 | 2 –º–µ—Å |

### 8.2 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- Uptime GIS —Å–µ—Ä–≤–∏—Å–æ–≤ > 99.9%
- P95 latency < 200ms
- –ö—ç—à hit rate > 85%
- –û—à–∏–±–æ–∫ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è < 5%

### 8.3 UX –º–µ—Ç—Ä–∏–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã > 60% —Å–µ—Å—Å–∏–π
- CTR –º–∞—Ä–∫–µ—Ä–æ–≤ > 15%
- Bounce rate –Ω–∞ –∫–∞—Ä—Ç–µ < 20%
- Mobile engagement +40%

## 9. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### 9.1 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –°–ª–æ–∂–Ω–æ—Å—Ç—å PostGIS | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã, –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç |
| –õ–∏–º–∏—Ç—ã Nominatim | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –°–≤–æ–π –∏–Ω—Å—Ç–∞–Ω—Å, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è |
| Mobile crashes | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |

### 9.2 –ë–∏–∑–Ω–µ—Å —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-----------|
| –ù–∏–∑–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è | –û–±—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, A/B —Ç–µ—Å—Ç—ã |
| –ù–µ—Ç–æ—á–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –°–µ—Ä–±–∏–∏ | –†—É—á–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è, feedback loop |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è | –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ –¥–ª—è –°–µ—Ä–±–∏–∏ |
| –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∫–∞—Ä—Ç—ã | Open source —Ä–µ—à–µ–Ω–∏—è, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è |

## 10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–£–ª—É—á—à–µ–Ω–Ω–æ–µ –¢–ó —É—á–∏—Ç—ã–≤–∞–µ—Ç:
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â—É—é GIS –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ü–æ—ç—Ç–∞–ø–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é –±–µ–∑ downtime
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏–∫—É —Å–µ—Ä–±—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞
- ‚úÖ –ú–æ–±–∏–ª—å–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏ offline
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: 95%**

---
*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —Å —É—á–µ—Ç–æ–º –∞–Ω–∞–ª–∏–∑–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö best practices –≤ –æ–±–ª–∞—Å—Ç–∏ GIS –¥–ª—è e-commerce.*