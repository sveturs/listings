# üìç –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Sve Tu Marketplace –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ GIS

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2025-01-10
**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**: –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ GIS —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞–º–∏

## üéØ –†–µ–∑—é–º–µ

–ü—Ä–æ–µ–∫—Ç **—É–∂–µ –∏–º–µ–µ—Ç –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π –∏ –∫–∞—Ä—Ç–∞–º–∏. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ GIS –º–æ–¥—É–ª—è.

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

#### –¢–∞–±–ª–∏—Ü—ã —Å –≥–µ–æ–¥–∞–Ω–Ω—ã–º–∏:
- **marketplace_listings**
  - `latitude` DECIMAL(10,8)
  - `longitude` DECIMAL(11,8)
  - `location` VARCHAR(255)
  - `city` VARCHAR(100)
  - `country` VARCHAR(100)
  - `show_on_map` BOOLEAN
  - –ò–Ω–¥–µ–∫—Å: `idx_marketplace_listings_location` ON (latitude, longitude)

- **user_storefronts**
  - `latitude` DECIMAL(10,8)
  - `longitude` DECIMAL(11,8)
  - `address` VARCHAR(255)
  - `city` VARCHAR(100)
  - `country` VARCHAR(100)

- **users**
  - `city` VARCHAR(100)
  - `country` VARCHAR(100)

#### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–µ DECIMAL –≤–º–µ—Å—Ç–æ PostGIS
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- –í—Å–µ –≥–µ–æ–ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã (NULL —Ä–∞–∑—Ä–µ—à–µ–Ω)

### 2. Backend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### –ú–æ–¥—É–ª–∏:
- **geocode** - —Å–µ—Ä–≤–∏—Å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
  - `/api/v1/geocode/reverse` - –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `/api/v1/geocode/cities` - –ø–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤

- **marketplace/map** - —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ä—Ç–∞–º–∏
  - `/api/v1/marketplace/map/bounds` - –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö
  - `/api/v1/marketplace/map/clusters` - –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤

- **storefronts/map** - –∫–∞—Ä—Ç–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤
  - `/api/v1/storefronts/map` - –º–∞–≥–∞–∑–∏–Ω—ã –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –∫–∞—Ä—Ç—ã

#### –°–µ—Ä–≤–∏—Å—ã:
- `GeocodeService` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- `MapService` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞—Ä—Ç
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –≤ OpenSearch

### 3. Frontend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- **leaflet** v1.9.4 - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞—Ä—Ç
- **react-leaflet** v5.0.0 - React –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **@types/leaflet** - TypeScript —Ç–∏–ø—ã

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `LocationMap.tsx` - –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã —Å –≤—ã–±–æ—Ä–æ–º –ª–æ–∫–∞—Ü–∏–∏
- `LocationStep.tsx` - —à–∞–≥ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `MapFilters.tsx` - —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –∫–∞—Ä—Ç—ã (storefronts)

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenStreetMap (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ API –∫–ª—é—á–µ–π)
- –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ GIS —Ñ—É–Ω–∫—Ü–∏–∏

## üîß –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostGIS –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≥–µ–æ—Ñ—É–Ω–∫—Ü–∏–π
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –¥–ª—è –ø–æ–ª–∏–≥–æ–Ω–æ–≤ —Ä–∞–π–æ–Ω–æ–≤/–∑–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏
- [ ] –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π

### 2. Backend
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ geocode —Å–µ—Ä–≤–∏—Å–∞ (–º–∞—Ä—à—Ä—É—Ç—ã, –ø–æ–ª–∏–≥–æ–Ω—ã)
- [ ] API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–æ–Ω–∞–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
- [ ] –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –ø–æ–∏—Å–∫–µ (—Ä–∞–¥–∏—É—Å, –ø–æ–ª–∏–≥–æ–Ω—ã)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ GIS —Å–µ—Ä–≤–∏—Å–∞–º–∏

### 3. Frontend
- [ ] –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- [ ] –†–∏—Å–æ–≤–∞–Ω–∏–µ –∑–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è storefronts
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤
- [ ] –¢–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- [ ] –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫–∞—Ä—Ç

## üìä –û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏: 70%

### ‚úÖ –ì–æ—Ç–æ–≤–æ:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î –¥–ª—è —Ç–æ—á–µ—á–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –ë–∞–∑–æ–≤—ã–µ API endpoints
- Leaflet –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ü—Ä–æ—Å—Ç–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ

### ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è:
- PostGIS –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–ª–∏–≥–æ–Ω—ã –∏ –∑–æ–Ω—ã
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

### –§–∞–∑–∞ 1 (Quick wins):
1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–µ–æ–ø–æ–ª–µ–π –¥–ª—è –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–∞–¥–∏—É—Å—É –≤ –ø–æ–∏—Å–∫–µ
3. –£–ª—É—á—à–∏—Ç—å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∫–∞—Ä—Ç—ã

### –§–∞–∑–∞ 2 (–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª):
1. –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostGIS
2. –ó–æ–Ω—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è storefronts
3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ
4. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –§–∞–∑–∞ 3 (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏):
1. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
2. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
3. –¢–µ–ø–ª–æ–≤—ã–µ –∫–∞—Ä—Ç—ã —Å–ø—Ä–æ—Å–∞
4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ª–æ–≥–∏—Å—Ç–∏–∫–æ–π

## üí° –í—ã–≤–æ–¥

–ü—Ä–æ–µ–∫—Ç **—Ö–æ—Ä–æ—à–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω** –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è GIS –º–æ–¥—É–ª—è. –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ, –Ω–∞—á–∏–Ω–∞—è —Å –ø—Ä–æ—Å—Ç—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.