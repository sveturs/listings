# ‚úÖ Google Console OAuth - –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## üéØ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å OAuth callback

OAuth flow —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç! –°—Ç—Ä–∞–Ω–∏—Ü–∞ callback —Å–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –æ—Ç Google.

## üîó Authorized redirect URIs –¥–ª—è Google Console

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –î–æ–±–∞–≤—å—Ç–µ –í–°–ï —ç—Ç–∏ URIs –≤ Google Console

#### –î–ª—è localhost (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):
```
http://localhost:3001/auth/oauth/google/callback
http://localhost:3001/en/auth/oauth/google/callback
http://localhost:3001/ru/auth/oauth/google/callback
http://localhost:3001/sr/auth/oauth/google/callback
```

#### –î–ª—è production (svetu.rs):
```
https://svetu.rs/auth/oauth/google/callback
https://svetu.rs/en/auth/oauth/google/callback
https://svetu.rs/ru/auth/oauth/google/callback
https://svetu.rs/sr/auth/oauth/google/callback
https://www.svetu.rs/auth/oauth/google/callback
https://www.svetu.rs/en/auth/oauth/google/callback
https://www.svetu.rs/ru/auth/oauth/google/callback
https://www.svetu.rs/sr/auth/oauth/google/callback
```

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç OAuth flow —Å–µ–π—á–∞—Å:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Login with Google"**
   - Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/api/v1/auth/google` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `redirect_uri`

2. **Backend —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ Google**
   - Google OAuth URL —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º callback URL

3. **Google —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –æ–±—Ä–∞—Ç–Ω–æ**
   - –ù–∞ `http://localhost:3001/{locale}/auth/oauth/google/callback?code=...&state=...`

4. **Frontend callback —Å—Ç—Ä–∞–Ω–∏—Ü–∞**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Processing login..." 
   - –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ backend `/api/v1/auth/google/callback` —Å –∫–æ–¥–æ–º

5. **Backend –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç –∫–æ–¥ –Ω–∞ —Ç–æ–∫–µ–Ω—ã**
   - –°–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é
   - –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ frontend —Å —Ç–æ–∫–µ–Ω–æ–º

## ‚öôÔ∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –≤ Google Console:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **APIs & Services** ‚Üí **Credentials**
4. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à **OAuth 2.0 Client ID**: 
   - `917315728307-au9ga5fl7o3bbid9nv7e4l92gut194pq.apps.googleusercontent.com`
5. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
6. –í —Å–µ–∫—Ü–∏–∏ **Authorized redirect URIs**:
   - –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URIs
   - –î–æ–±–∞–≤—å—Ç–µ –í–°–ï URIs –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
7. –ù–∞–∂–º–∏—Ç–µ **Save**
8. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ OAuth callback** 
   - `/[locale]/auth/oauth/google/callback/page.tsx`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –æ—Ç Google
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js**
   - –ò—Å–∫–ª—é—á—ë–Ω OAuth callback –∏–∑ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ frontend

3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω middleware**
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç query parameters –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ª–æ–∫–∞–ª–∏
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è OAuth flow

4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ loginWithGoogle**
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ª–æ–∫–∞–ª—å
   - –ü–µ—Ä–µ–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π redirect_uri

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### –û—à–∏–±–∫–∞ "redirect_uri_mismatch"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ –í–°–ï URIs —Å —É—á—ë—Ç–æ–º –ª–æ–∫–∞–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (–±–µ–∑ trailing slash)
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Processing login..." –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend

### –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Ö–æ–¥
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ AuthContext –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ —Ä–µ–∂–∏–º–µ
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:3001
3. –ù–∞–∂–º–∏—Ç–µ "Login with Google"
4. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ Google
5. –î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏

---
*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: 07.09.2025*
*–°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ*