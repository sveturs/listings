# üîê Auth Service - –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù –ò –ì–û–¢–û–í –ö PRODUCTION

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 06.09.2025 (23:50)  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ü—Ä–æ–≥—Ä–µ—Å—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** 70%  

## üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü–æ—Ä—Ç | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|-----------|--------|------|----------|
| HTTP API | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 28080 | `curl http://localhost:28080/health` |
| gRPC Server | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 50051 | –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ |
| PostgreSQL | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 25432 | `psql -h localhost -p 25432 -U auth_user -d auth_db` |
| Redis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 26379 | `redis-cli -p 26379 -a RedisP@ssw0rd2025! ping` |
| Health Check | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 28080 | `/health`, `/health/live`, `/health/ready` |

## üìù –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**: `/data/auth_svetu/docs/ACTUAL_API_ENDPOINTS.md`
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: `/data/auth_svetu/docs/DOCUMENTATION_FIXES.md`
3. **–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏**: `/data/hostel-booking-system/docs/AUTH_SERVICE_MIGRATION_PLAN.md`

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞
- `GET /api/v1/version` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏
- `POST /api/v1/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/v1/auth/login` - –≤—Ö–æ–¥
- `POST /api/v1/auth/refresh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- `GET /api/v1/auth/validate` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
- `GET /api/v1/auth/oauth/google` - Google OAuth
- `GET /api/v1/auth/oauth/google/callback` - Google OAuth callback

### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `POST /api/v1/auth/logout` - –≤—ã—Ö–æ–¥
- `POST /api/v1/auth/logout-all` - –≤—ã—Ö–æ–¥ –∏–∑ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π
- `POST /api/v1/auth/revoke` - –æ—Ç–∑—ã–≤ —Ç–æ–∫–µ–Ω–∞
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/api/v1/user/*` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–º

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
- ‚úÖ JWT –∫–ª—é—á–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (`/data/auth_svetu/keys/`)
- ‚úÖ Google OAuth credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –ë–î –∏ Redis —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è localhost:3000, localhost:3001, svetu.rs

### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
auth_service   - HTTP API –∏ gRPC
auth_postgres  - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
auth_redis     - –ö–µ—à —Å–µ—Å—Å–∏–π
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

1. **–í–µ—Ä—Å–∏—è Go**: –¢—Ä–µ–±—É–µ—Ç—Å—è 1.23, –Ω–µ 1.22
2. **–ü–æ—Ä—Ç—ã**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
3. **Health endpoint**: `/health` –≤–º–µ—Å—Ç–æ `/api/v1/health`
4. **JWT –∫–ª—é—á–∏**: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å `./keys/` –≤–º–µ—Å—Ç–æ `/etc/auth/keys/`

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

1. **Backend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
   - [x] –°–æ–∑–¥–∞—Ç—å Auth Client –≤ –º–æ–Ω–æ–ª–∏—Ç–µ ‚úÖ
   - [x] –û–±–Ω–æ–≤–∏—Ç—å middleware –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ
   - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å gRPC –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤

2. **Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
   - [x] –û–±–Ω–æ–≤–∏—Ç—å API endpoints ‚úÖ
   - [x] –ò–∑–º–µ–Ω–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–∫–µ–Ω–æ–≤ ‚úÖ
   - [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å OAuth flows (—Å–µ–π—á–∞—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 501)

3. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
   - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å nginx –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
   - [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î
   - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker ps | grep auth

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs auth_service -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
cd /data/auth_svetu && docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
cd /data/auth_svetu && docker-compose down

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞
cd /data/auth_svetu && docker-compose down -v && docker-compose up -d
```

## ‚ú® –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

- ‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –∏ —Å—Ç–∞–±–∏–ª–µ–Ω
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å RS256
- ‚úÖ OAuth –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–Ω–æ–ª–∏—Ç–æ–º