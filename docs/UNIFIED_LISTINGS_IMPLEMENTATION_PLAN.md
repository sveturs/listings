# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Unified Listings (C2C + B2C –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-11
**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-10-11 17:10
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û! Backend + Frontend + OpenSearch + Tests + Commit!
**–¶–µ–ª—å:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ C2C –∏ B2C —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

---

## üî• –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –¢–†–ï–ë–û–í–ê–ù–ò–ï: –ü–û–°–¢–û–Ø–ù–ù–ê–Ø –ê–ö–¢–£–ê–õ–ò–ó–ê–¶–ò–Ø –ü–õ–ê–ù–ê

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –ö–ê–ñ–î–û–ô –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ Claude –û–ë–Ø–ó–ê–ù:

1. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å "–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π"** - –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É —Å –¥–∞—Ç–æ–π, –∑–∞–¥–∞—á–µ–π, –≤—Ä–µ–º–µ–Ω–µ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
2. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∞** (–≤–≤–µ—Ä—Ö—É –¥–æ–∫—É–º–µ–Ω—Ç–∞) - –æ—Ç—Ä–∞–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø
3. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å "–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞"** - —É–∫–∞–∑–∞—Ç—å —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
4. ‚úÖ **–ó–∞–ø–∏—Å–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** - –µ—Å–ª–∏ –±—ã–ª–∏ –æ—à–∏–±–∫–∏ –∏–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
5. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞** - –æ—Ç–º–µ—Ç–∏—Ç—å —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

**–ü–û–ß–ï–ú–£ –≠–¢–û –í–ê–ñ–ù–û:**
- –ü–ª–∞–Ω - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
- –ë–µ–∑ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è
- –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–∂–µ —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞–±–æ—Ç–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞

**–ö–ê–ö –ê–ö–¢–£–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨:**
- –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ (–Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—è!)
- –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –∞ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ
- –£–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Ü–∏—Ñ—Ä—ã
- –û—Ç–º–µ—á–∞—Ç—å –ª—é–±—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –ø–ª–∞–Ω–∞

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê

### üö´ –ù–ò–ö–ê–ö–ò–• –ö–û–°–¢–´–õ–ï–ô –ò –†–£–î–ò–ú–ï–ù–¢–û–í!

**–ü—Ä–æ–¥—É–∫—Ç –≤ —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** - –Ω–µ –≤ production! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. ‚ùå **–ó–ê–ü–†–ï–©–ï–ù–û –æ—Å—Ç–∞–≤–ª—è—Ç—å —Ä—É–¥–∏–º–µ–Ω—Ç—ã** - –≤–µ—Å—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥ –£–î–ê–õ–Ø–ï–¢–°–Ø
2. ‚ùå **–ó–ê–ü–†–ï–©–ï–ù–ê –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –∫–æ—Å—Ç—ã–ª—è–º–∏
3. ‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û –ª–æ–º–∞—Ç—å —Å—Ç–∞—Ä–æ–µ** - –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
4. ‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å** - –µ—Å–ª–∏ –ø–æ—è–≤–∏–ª—Å—è –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±

### üìù –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ö–ê–ñ–î–û–ô –∑–∞–¥–∞—á–∏:**
1. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –≤ —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –¥–∞—Ç—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è
3. ‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
4. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π"

### üß™ –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**JWT —Ç–æ–∫–µ–Ω:** `/tmp/token` (100% —Ä–∞–±–æ—á–∏–π!)

**–ü–æ—Å–ª–µ –ö–ê–ñ–î–û–ì–û –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–π:**
```bash
# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
TOKEN=$(cat /tmp/token)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å unified listings
curl -H "Authorization: Bearer $TOKEN" \
  "http://localhost:3000/api/v1/unified/listings" | jq '.'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
curl -H "Authorization: Bearer $TOKEN" \
  "http://localhost:3000/api/v1/unified/listings?source_type=c2c" | jq '.'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
curl -H "Authorization: Bearer $TOKEN" \
  "http://localhost:3000/api/v1/unified/listings" | jq '.data[0].images'
```

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π](#–∏—Å—Ç–æ—Ä–∏—è-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã](#–æ–±–∑–æ—Ä-–ø—Ä–æ–±–ª–µ–º—ã)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
4. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-postgresql)
5. [Backend (Go/Fiber)](#backend-gofiber)
6. [Frontend (Next.js/React)](#frontend-nextjsreact)
7. [–ü–æ–∏—Å–∫ (OpenSearch)](#–ø–æ–∏—Å–∫-opensearch)
8. [–•—Ä–∞–Ω–∏–ª–∏—â–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (S3/MinIO)](#—Ö—Ä–∞–Ω–∏–ª–∏—â–µ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π-s3minio)
9. [–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#–º–∏–≥—Ä–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
10. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
11. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
12. [–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏](#–æ—Ü–µ–Ω–∫–∞-–≤—Ä–µ–º–µ–Ω–∏)

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –í—Ä–µ–º—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|--------|-------|-------------|
| 2025-10-11 | –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ | ‚úÖ | 1 —á–∞—Å | –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ 65 —Å—Ç—Ä–∞–Ω–∏—Ü |
| 2025-10-11 | –ú–∏–≥—Ä–∞—Ü–∏—è 000177 | ‚úÖ | 30 –º–∏–Ω | –£–¥–∞–ª–µ–Ω —Ç—Ä–∏–≥–≥–µ—Ä, —É–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã |
| 2025-10-11 | –ú–∏–≥—Ä–∞—Ü–∏—è 000178 (VIEW) | ‚úÖ | 45 –º–∏–Ω | –°–æ–∑–¥–∞–Ω VIEW unified_listings —Å UNION query |
| | | | | **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è VIEW:** |
| | | | | - C2C listings: 4 —à—Ç. ‚úÖ |
| | | | | - B2C products: 5 —à—Ç. ‚úÖ |
| | | | | - –í—Å–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ ‚úÖ |
| | | | | - C2C images –∏–∑ c2c_images ‚úÖ |
| | | | | - B2C images –∏–∑ b2c_product_images ‚úÖ |
| 2025-10-11 15:17 | –ú–∏–≥—Ä–∞—Ü–∏—è 000179 (–∏–Ω–¥–µ–∫—Å—ã) | ‚úÖ | 20 –º–∏–Ω | –°–æ–∑–¥–∞–Ω–æ 12 –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:** |
| | | | | - C2C: 6 –∏–Ω–¥–µ–∫—Å–æ–≤ (active_created, category, price, location, text_search, images) |
| | | | | - B2C: 6 –∏–Ω–¥–µ–∫—Å–æ–≤ (active_created, category, price, storefront, text_search, images) |
| 2025-10-11 15:25 | Backend models | ‚úÖ | 15 –º–∏–Ω | UnifiedListing, UnifiedImage, —Ñ–∏–ª—å—Ç—Ä—ã |
| 2025-10-11 15:40 | Backend storage | ‚úÖ | 30 –º–∏–Ω | UnifiedStorage —Å GetUnifiedListings, GetByID |
| 2025-10-11 15:55 | Backend handler | ‚úÖ | 20 –º–∏–Ω | UnifiedHandler —Å routes GET /listings, GET /listings/:id |
| 2025-10-11 15:47 | Server.go –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ | 25 –º–∏–Ω | –î–æ–±–∞–≤–ª–µ–Ω unified handler –≤ Server struct, NewServer, registrars |
| | | | | **–ò–∑–º–µ–Ω–µ–Ω–∏—è:** |
| | | | | - Added field: `unified *unifiedHandler.UnifiedHandler` |
| | | | | - Import packages: unified handler + storage |
| | | | | - Initialization in NewServer() |
| | | | | - Registration in routes |
| 2025-10-11 15:48 | Bug fix: logger types | ‚úÖ | 10 –º–∏–Ω | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –ª–æ–≥–≥–µ—Ä–æ–≤ —Å logger.Logger –Ω–∞ zerolog.Logger |
| | | | | **–§–∞–π–ª—ã:** |
| | | | | - unified_storage.go: `log *zerolog.Logger` |
| | | | | - unified_handler.go: `log *zerolog.Logger` |
| | | | | - –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ logging calls |
| 2025-10-11 15:49 | Bug fix: Scan mismatch | ‚úÖ | 15 –º–∏–Ω | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –≤ Scan |
| | | | | **–ü—Ä–æ–±–ª–µ–º–∞:** VIEW –≤–æ–∑–≤—Ä–∞—â–∞–ª 25 –∫–æ–ª–æ–Ω–æ–∫, –∫–æ–¥ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª 23 |
| | | | | **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã dummy –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è extra –ø–æ–ª–µ–π: |
| | | | | - external_id (interface{}) |
| | | | | - needs_reindex (interface{}) |
| | | | | - address_multilingual (interface{}) |
| | | | | **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤:** |
| | | | | - GetUnifiedListings() |
| | | | | - GetUnifiedListingByID() |
| | | | | - GetUnifiedListingsByIDs() |
| 2025-10-11 15:50 | API testing | ‚úÖ | 15 –º–∏–Ω | –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ unified API endpoints |
| | | | | **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** |
| | | | | - ‚úÖ All listings: 9 total (4 C2C + 5 B2C) |
| | | | | - ‚úÖ C2C filter: 4 listings |
| | | | | - ‚úÖ B2C filter: 5 products |
| | | | | - ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü |
| | | | | - ‚úÖ Metadata –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (storefront_id –¥–ª—è B2C) |
| | | | | - ‚úÖ –í—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã |
| 2025-10-11 16:00 | –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞ | ‚úÖ | 10 –º–∏–Ω | –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ |
| | | | | - –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è —Å 5 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ —à–∞–≥–∞–º–∏ |
| | | | | - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| | | | | - –û–±–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å: Backend –ü–û–õ–ù–û–°–¢–¨–Æ –∑–∞–≤–µ—Ä—à–µ–Ω |
| 2025-10-11 16:15 | OpenSearch –∏–Ω–¥–µ–∫—Å | ‚úÖ | 45 –º–∏–Ω | –°–æ–∑–¥–∞–Ω unified –∏–Ω–¥–µ–∫—Å –∏ —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** |
| | | | | - reindex_unified.py: —Å–∫—Ä–∏–ø—Ç Python –¥–ª—è –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ |
| | | | | - Mapping —Å nested images, geo_point location |
| | | | | - Serbian analyzer –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ |
| | | | | **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** |
| | | | | - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å OpenSearch API (index= –ø–∞—Ä–∞–º–µ—Ç—Ä) |
| | | | | - –£–±—Ä–∞–Ω display_order –∏–∑ c2c_images (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å—Ö–µ–º–µ) |
| | | | | - –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ display_order –≤ Python |
| | | | | **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:** |
| | | | | - ‚úÖ –°–æ–∑–¥–∞–Ω –∏–Ω–¥–µ–∫—Å unified_listings |
| | | | | - ‚úÖ C2C: 4 listings –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã |
| | | | | - ‚úÖ B2C: 5 products –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã |
| | | | | - ‚úÖ –í—Å–µ–≥–æ: 9 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–µ |
| | | | | - ‚úÖ –í—Å–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ |
| | | | | **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞:** |
| | | | | - Total count: 9 ‚úÖ |
| | | | | - C2C filter: 4 ‚úÖ |
| | | | | - B2C filter: 5 ‚úÖ |
| | | | | - Text search "baterija": 5 results ‚úÖ |
| | | | | - Images present in documents ‚úÖ |
| | | | | - Storefront info in B2C docs ‚úÖ |
| 2025-10-11 16:25 | Frontend types | ‚úÖ | 15 –º–∏–Ω | –°–æ–∑–¥–∞–Ω unified-listing.ts —Å —Ç–∏–ø–∞–º–∏ –∏ helper functions |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** |
| | | | | - src/types/unified-listing.ts: —Ç–∏–ø—ã UnifiedListing, UnifiedImage, —Ñ–∏–ª—å—Ç—Ä—ã |
| | | | | **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã:** |
| | | | | - ListingSourceType = 'c2c' \| 'b2c' \| 'all' |
| | | | | - UnifiedListing (–ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å 20+ –ø–æ–ª—è–º–∏) |
| | | | | - UnifiedListingsFilters (8 —Ñ–∏–ª—å—Ç—Ä–æ–≤) |
| | | | | - UnifiedListingsResponse |
| | | | | **Helper functions:** |
| | | | | - isC2CListing(), isB2CListing() - type guards |
| | | | | - getUnifiedListingDetailUrl() - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è URL |
| | | | | - getMainImage(), sortImages() - —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ |
| 2025-10-11 16:30 | Frontend API client | ‚úÖ | 20 –º–∏–Ω | –°–æ–∑–¥–∞–Ω unified-listings-api.ts service |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª:** |
| | | | | - src/services/unified-listings-api.ts: API client —Å 7 –º–µ—Ç–æ–¥–∞–º–∏ |
| | | | | **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:** |
| | | | | - getListings(filters) - –ø–æ–ª—É—á–∏—Ç—å —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ |
| | | | | - getListingById(id, type) - –ø–æ–ª—É—á–∏—Ç—å –ø–æ ID |
| | | | | - getListingsByIds(ids[]) - batch –ø–æ–ª—É—á–µ–Ω–∏–µ |
| | | | | - getListingsByCategory(id) - –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| | | | | - getListingsByStorefront(id) - –ø–æ –≤–∏—Ç—Ä–∏–Ω–µ |
| | | | | - search(query) - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ |
| | | | | - getListingsByPriceRange(min, max) - –ø–æ —Ü–µ–Ω–µ |
| | | | | **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** |
| | | | | - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è BFF proxy /api/v2 |
| | | | | - Singleton instance pattern |
| | | | | - TypeScript typed responses |
| 2025-10-11 16:35 | Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | ‚úÖ | 30 –º–∏–Ω | –°–æ–∑–¥–∞–Ω—ã ListingTypeFilter –∏ UnifiedListingCard |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** |
| | | | | - src/components/unified/ListingTypeFilter.tsx (380 —Å—Ç—Ä–æ–∫) |
| | | | | - src/components/unified/UnifiedListingCard.tsx (360 —Å—Ç—Ä–æ–∫) |
| | | | | **ListingTypeFilter –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:** |
| | | | | - 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è: buttons, tabs, pills |
| | | | | - 3 —Ä–∞–∑–º–µ—Ä–∞: sm, md, lg |
| | | | | - ShowCounts –æ–ø—Ü–∏—è (–±–µ–π–¥–∂–∏ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º) |
| | | | | - –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è (select) –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö |
| | | | | - Responsive wrapper (auto-switch) |
| | | | | **UnifiedListingCard –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:** |
| | | | | - 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞: grid, list |
| | | | | - Type badges (C2C/B2C) |
| | | | | - Storefront info –¥–ª—è B2C |
| | | | | - Views count –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ |
| | | | | - Helper components: UnifiedListingsGrid, UnifiedListingsList |
| 2025-10-11 16:40 | Frontend –ø–µ—Ä–µ–≤–æ–¥—ã | ‚úÖ | 10 –º–∏–Ω | –î–æ–±–∞–≤–ª–µ–Ω—ã i18n –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è ru, en, sr |
| | | | | **–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** |
| | | | | - src/messages/ru/unified.json |
| | | | | - src/messages/en/unified.json |
| | | | | - src/messages/sr/unified.json |
| | | | | **–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏:** |
| | | | | - filter.all, c2c, b2c (+ descriptions, short, aria_label) |
| | | | | - badge.c2c, b2c (+ tooltips) |
| | | | | - condition.new, used, refurbished, like_new |
| | | | | - no_image, no_listings_found, from_storefront |
| | | | | - results_count (—Å plural forms) |
| 2025-10-11 16:45 | Frontend API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ | 10 –º–∏–Ω | –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã unified API endpoints |
| | | | | **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** |
| | | | | - ‚úÖ GET /api/v1/unified/listings: 9 total |
| | | | | - ‚úÖ GET /api/v1/unified/listings?source_type=c2c: 4 listings |
| | | | | - ‚úÖ GET /api/v1/unified/listings?source_type=b2c: 5 products |
| | | | | - ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —É –≤—Å–µ—Ö (images_count: 1) |
| | | | | - ‚úÖ storefront_id –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —É B2C |
| | | | | - ‚úÖ Response structure –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è |
| | | | | **–ü—Ä–∏–º–µ—Ä—ã:**|
| | | | | - C2C: "–ü—Ä–∏–Ω—Ç–µ—Ä Canon G3420" (id: 1067) |
| | | | | - B2C: "Baterija za LG B2050 950 mAh" (id: 1061, storefront: 43) |
| 2025-10-11 17:00 | Pre-commit check + –∫–æ–º–º–∏—Ç | ‚úÖ | 25 –º–∏–Ω | –í—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω—ã–π pre-commit check –∏ –∫–æ–º–º–∏—Ç |
| | | | | **Pre-commit check —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:** |
| | | | | - ‚úÖ Backend format (gofumpt + goimports) |
| | | | | - ‚úÖ Backend lint (golangci-lint): 0 issues |
| | | | | - ‚úÖ Backend build: —É—Å–ø–µ—à–Ω–æ |
| | | | | - ‚úÖ Frontend format (prettier): unchanged |
| | | | | - ‚úÖ Frontend lint (eslint): 0 warnings/errors |
| | | | | - ‚úÖ Frontend build: —É—Å–ø–µ—à–Ω–æ (92.61s) |
| | | | | **Git commit:** |
| | | | | - Commit hash: 4ec102ff |
| | | | | - 26 files changed, 5274 insertions(+), 46 deletions(-) |
| | | | | - –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ 0.2.4 |
| 2025-10-11 17:05 | –§–∏–Ω–∞–ª—å–Ω–æ–µ API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ | 5 –º–∏–Ω | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã unified API —Å JWT —Ç–æ–∫–µ–Ω–æ–º |
| | | | | **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** |
| | | | | - ‚úÖ GET /api/v1/unified/listings: total=9, success=true |
| | | | | - ‚úÖ –§–∏–ª—å—Ç—Ä C2C: total=4, –≤—Å–µ —Å source_type="c2c" |
| | | | | - ‚úÖ –§–∏–ª—å—Ç—Ä B2C: total=5, –≤—Å–µ —Å source_type="b2c" |
| | | | | - ‚úÖ –í—Å–µ listings —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (images array –∑–∞–ø–æ–ª–Ω–µ–Ω) |
| | | | | - ‚úÖ B2C listings —Å–æ–¥–µ—Ä–∂–∞—Ç storefront_id –∏ metadata |
| | | | | - ‚úÖ Metadata –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è (stock_status, currency, attributes) |
| | | | | - ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ created_at DESC —Ä–∞–±–æ—Ç–∞–µ—Ç |
| | | | | **–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:** |
| | | | | - C2C #1067: "–ü—Ä–∏–Ω—Ç–µ—Ä Canon G3420" (15000 RSD, used) |
| | | | | - C2C #1066: "–≠–ª–µ–∫—Ç—Ä–æ–æ—Ç–≤–µ—Ä—Ç–∫–∞ Xiaomi" (4500 RSD, new) |
| | | | | - C2C #1060: "PS5" (45000 RSD, used) |
| | | | | - B2C #1065: "Baterija Nokia BL-6F" (390 RSD, new, storefront: 43) |
| | | | | - B2C #1061: "Baterija LG B2050" (590 RSD, new, storefront: 43) |

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–û! Backend + Frontend + OpenSearch + Tests + Commit!

**–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞:**
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–º PR)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (–¥–æ –º–∏–≥—Ä–∞—Ü–∏–∏ 000177):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  b2c_products   ‚îÇ
‚îÇ  (5 —Ç–æ–≤–∞—Ä–æ–≤)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ TRIGGER sync_storefront_to_marketplace()
         ‚îÇ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ c2c_listings    ‚îÇ
‚îÇ  - 4 C2C        ‚îÇ
‚îÇ  - 5 B2C (–¥—É–±–ª) ‚îÇ ‚ùå –ë–ï–ó –ö–ê–†–¢–ò–ù–û–ö!
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–æ–¥–∏–Ω —Ç–æ–≤–∞—Ä –≤ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö)
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —É B2C —Ç–æ–≤–∞—Ä–æ–≤ –≤ c2c_listings
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚ùå –ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ "–∏—Å—Ç–æ—á–Ω–∏–∫–µ –ø—Ä–∞–≤–¥—ã"

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ 000177 (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  b2c_products   ‚îÇ     ‚îÇ c2c_listings    ‚îÇ
‚îÇ  (5 —Ç–æ–≤–∞—Ä–æ–≤)    ‚îÇ     ‚îÇ  (4 C2C)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚úÖ                       ‚úÖ
  –¢—Ä–∏–≥–≥–µ—Ä —É–¥–∞–ª–µ–Ω!       –î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–ø–µ—Ä—å B2C —Ç–æ–≤–∞—Ä—ã –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ!

### –¶–µ–ª–µ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  b2c_products   ‚îÇ     ‚îÇ c2c_listings    ‚îÇ
‚îÇ  (5 —Ç–æ–≤–∞—Ä–æ–≤)    ‚îÇ     ‚îÇ  (4 C2C)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ UNION query
                     ‚ñº
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ   Unified    ‚îÇ
              ‚îÇ   Listings   ‚îÇ
              ‚îÇ   (9 –≤—Å–µ–≥–æ)  ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã:

1. **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
2. **Unified –∑–∞–ø—Ä–æ—Å—ã** - UNION –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è C2C + B2C
3. **–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å: –í—Å–µ / C2C / B2C
5. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** - –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

```json
{
  "id": 1061,
  "source": "b2c",  // –∏–ª–∏ "c2c"
  "title": "–¢–æ–≤–∞—Ä",
  "description": "...",
  "price": 590,
  "images": [
    {
      "id": 123,
      "url": "https://s3.svetu.rs/...",
      "is_main": true
    }
  ],
  "storefront": {  // —Ç–æ–ª—å–∫–æ –¥–ª—è B2C
    "id": 43,
    "name": "...",
    "slug": "..."
  }
}
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

### –≠—Ç–∞–ø 1: –ú–∏–≥—Ä–∞—Ü–∏—è 000177 (‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∞)

**–§–∞–π–ª—ã:**
- `backend/migrations/000177_remove_storefront_sync_trigger.up.sql`
- `backend/migrations/000177_remove_storefront_sync_trigger.down.sql`

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –£–¥–∞–ª–µ–Ω —Ç—Ä–∏–≥–≥–µ—Ä `sync_storefront_product_to_marketplace()`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑ `c2c_listings` (–≥–¥–µ `storefront_id IS NOT NULL`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ –Ω–æ–≤–æ–º –ø–æ–¥—Ö–æ–¥–µ

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞—Ç—å VIEW –¥–ª—è unified listings

**–§–∞–π–ª:** `backend/migrations/000178_create_unified_listings_view.up.sql`

```sql
-- –°–æ–∑–¥–∞—Ç—å VIEW, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç C2C –∏ B2C listings
CREATE OR REPLACE VIEW unified_listings AS
-- C2C listings
SELECT
    l.id,
    'c2c' AS source_type,
    l.user_id,
    l.category_id,
    l.title,
    l.description,
    l.price,
    l.condition,
    l.status,
    l.location,
    l.latitude,
    l.longitude,
    l.address_city,
    l.address_country,
    l.views_count,
    l.created_at,
    l.updated_at,
    l.show_on_map,
    l.original_language,
    NULL::INTEGER AS storefront_id,
    l.metadata,
    -- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ c2c_images
    (
        SELECT COALESCE(jsonb_agg(
            jsonb_build_object(
                'id', i.id,
                'url', i.public_url,
                'is_main', i.is_main,
                'display_order', i.display_order
            ) ORDER BY i.is_main DESC, i.display_order ASC
        ), '[]'::jsonb)
        FROM c2c_images i
        WHERE i.listing_id = l.id
    ) AS images
FROM c2c_listings l
WHERE l.status = 'active'

UNION ALL

-- B2C products
SELECT
    p.id,
    'b2c' AS source_type,
    s.user_id,
    p.category_id,
    p.name AS title,
    p.description,
    p.price,
    'new' AS condition,
    CASE WHEN p.is_active THEN 'active' ELSE 'inactive' END AS status,
    COALESCE(p.individual_address, s.address) AS location,
    COALESCE(p.individual_latitude, s.latitude) AS latitude,
    COALESCE(p.individual_longitude, s.longitude) AS longitude,
    COALESCE(p.individual_address, s.city) AS address_city,
    s.country AS address_country,
    p.view_count AS views_count,
    p.created_at,
    p.updated_at,
    COALESCE(p.show_on_map, true) AS show_on_map,
    'sr' AS original_language,
    p.storefront_id,
    jsonb_build_object(
        'source', 'storefront',
        'storefront_id', p.storefront_id,
        'stock_quantity', p.stock_quantity,
        'stock_status', p.stock_status,
        'currency', p.currency,
        'sku', p.sku,
        'barcode', p.barcode,
        'attributes', p.attributes
    ) AS metadata,
    -- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ b2c_product_images
    (
        SELECT COALESCE(jsonb_agg(
            jsonb_build_object(
                'id', i.id,
                'url', i.image_url,
                'thumbnail_url', i.thumbnail_url,
                'is_main', i.is_default,
                'display_order', i.display_order
            ) ORDER BY i.is_default DESC, i.display_order ASC
        ), '[]'::jsonb)
        FROM b2c_product_images i
        WHERE i.storefront_product_id = p.id
    ) AS images
FROM b2c_products p
JOIN b2c_stores s ON p.storefront_id = s.id
WHERE p.is_active = true;

COMMENT ON VIEW unified_listings IS
'Unified view –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π C2C listings –∏ B2C products –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.';
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ VIEW:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ VIEW:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö (—Ä–µ—à–∞–µ—Ç—Å—è –∏–Ω–¥–µ–∫—Å–∞–º–∏)
- ‚ö†Ô∏è –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π (–Ω–æ –º–æ–∂–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å)

### –≠—Ç–∞–ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤

**–§–∞–π–ª:** `backend/migrations/000179_optimize_unified_listings_indexes.up.sql`

```sql
-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è c2c_listings (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
CREATE INDEX IF NOT EXISTS idx_c2c_listings_active_created
ON c2c_listings(status, created_at DESC)
WHERE status = 'active';

CREATE INDEX IF NOT EXISTS idx_c2c_listings_category_active
ON c2c_listings(category_id, status)
WHERE status = 'active';

CREATE INDEX IF NOT EXISTS idx_c2c_listings_price
ON c2c_listings(price)
WHERE status = 'active' AND price IS NOT NULL;

CREATE INDEX IF NOT EXISTS idx_c2c_listings_location
ON c2c_listings(latitude, longitude)
WHERE status = 'active' AND latitude IS NOT NULL AND longitude IS NOT NULL;

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è b2c_products
CREATE INDEX IF NOT EXISTS idx_b2c_products_active_created
ON b2c_products(is_active, created_at DESC)
WHERE is_active = true;

CREATE INDEX IF NOT EXISTS idx_b2c_products_category_active
ON b2c_products(category_id, is_active)
WHERE is_active = true;

CREATE INDEX IF NOT EXISTS idx_b2c_products_price
ON b2c_products(price)
WHERE is_active = true;

CREATE INDEX IF NOT EXISTS idx_b2c_products_storefront
ON b2c_products(storefront_id, is_active)
WHERE is_active = true;

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
CREATE INDEX IF NOT EXISTS idx_c2c_images_listing_main
ON c2c_images(listing_id, is_main, display_order);

CREATE INDEX IF NOT EXISTS idx_b2c_images_product_main
ON b2c_product_images(storefront_product_id, is_default, display_order);
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Materialized View (–¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤)

```sql
-- –ï—Å–ª–∏ VIEW —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MATERIALIZED VIEW
CREATE MATERIALIZED VIEW unified_listings_materialized AS
SELECT * FROM unified_listings;

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è materialized view
CREATE INDEX idx_unified_listings_mat_source ON unified_listings_materialized(source_type);
CREATE INDEX idx_unified_listings_mat_created ON unified_listings_materialized(created_at DESC);
CREATE INDEX idx_unified_listings_mat_category ON unified_listings_materialized(category_id);

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —á–µ—Ä–µ–∑ cron
-- SELECT refresh_materialized_view('unified_listings_materialized');
```

---

## Backend (Go/Fiber)

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É UnifiedListing

**–§–∞–π–ª:** `backend/internal/domain/models/unified_listing.go`

```go
package models

import "time"

// UnifiedListing –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç C2C listings –∏ B2C products
type UnifiedListing struct {
    ID              int                    `json:"id"`
    SourceType      string                 `json:"source_type"` // "c2c" –∏–ª–∏ "b2c"
    UserID          int                    `json:"user_id"`
    CategoryID      int                    `json:"category_id"`
    Title           string                 `json:"title"`
    Description     string                 `json:"description"`
    Price           float64                `json:"price"`
    Condition       string                 `json:"condition"`
    Status          string                 `json:"status"`
    Location        string                 `json:"location"`
    Latitude        *float64               `json:"latitude,omitempty"`
    Longitude       *float64               `json:"longitude,omitempty"`
    City            string                 `json:"city"`
    Country         string                 `json:"country"`
    ViewsCount      int                    `json:"views_count"`
    CreatedAt       time.Time              `json:"created_at"`
    UpdatedAt       time.Time              `json:"updated_at"`
    ShowOnMap       bool                   `json:"show_on_map"`
    OriginalLang    string                 `json:"original_language"`
    StorefrontID    *int                   `json:"storefront_id,omitempty"` // —Ç–æ–ª—å–∫–æ –¥–ª—è B2C
    Metadata        map[string]interface{} `json:"metadata,omitempty"`

    // –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    Images          []UnifiedImage         `json:"images"`
    User            *User                  `json:"user,omitempty"`
    Category        *Category              `json:"category,omitempty"`
    Storefront      *Storefront            `json:"storefront,omitempty"` // —Ç–æ–ª—å–∫–æ –¥–ª—è B2C
    Translations    map[string]interface{} `json:"translations,omitempty"`

    // –§–ª–∞–≥–∏
    IsFavorite      bool                   `json:"is_favorite"`
    HasDiscount     bool                   `json:"has_discount"`
}

// UnifiedImage —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
type UnifiedImage struct {
    ID           int    `json:"id"`
    URL          string `json:"url"`
    ThumbnailURL string `json:"thumbnail_url,omitempty"`
    IsMain       bool   `json:"is_main"`
    DisplayOrder int    `json:"display_order"`
}

// UnifiedListingsFilters —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è unified listings
type UnifiedListingsFilters struct {
    SourceType   string  // "all", "c2c", "b2c"
    CategoryID   int
    MinPrice     float64
    MaxPrice     float64
    Condition    string
    Query        string
    UserID       int
    StorefrontID int
    Limit        int
    Offset       int
}
```

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞—Ç—å storage –¥–ª—è unified listings

**–§–∞–π–ª:** `backend/internal/proj/unified/storage/postgres/unified_storage.go`

```go
package postgres

import (
    "context"
    "fmt"
    "strings"

    "backend/internal/domain/models"
    "github.com/jackc/pgx/v5/pgxpool"
)

type UnifiedStorage struct {
    pool *pgxpool.Pool
}

func NewUnifiedStorage(pool *pgxpool.Pool) *UnifiedStorage {
    return &UnifiedStorage{pool: pool}
}

// GetUnifiedListings –ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ C2C + B2C
func (s *UnifiedStorage) GetUnifiedListings(
    ctx context.Context,
    filters models.UnifiedListingsFilters,
) ([]models.UnifiedListing, int64, error) {

    userID, _ := ctx.Value("user_id").(int)
    if userID == 0 {
        userID = -1
    }

    // –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ VIEW
    query := `
    WITH filtered_listings AS (
        SELECT
            ul.*,
            COUNT(*) OVER() as total_count
        FROM unified_listings ul
        WHERE 1=1
    `

    args := []interface{}{}
    argCount := 0

    // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞
    if filters.SourceType != "" && filters.SourceType != "all" {
        argCount++
        query += fmt.Sprintf(" AND ul.source_type = $%d", argCount)
        args = append(args, filters.SourceType)
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if filters.CategoryID > 0 {
        argCount++
        query += fmt.Sprintf(" AND ul.category_id = $%d", argCount)
        args = append(args, filters.CategoryID)
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ
    if filters.MinPrice > 0 {
        argCount++
        query += fmt.Sprintf(" AND ul.price >= $%d", argCount)
        args = append(args, filters.MinPrice)
    }

    if filters.MaxPrice > 0 {
        argCount++
        query += fmt.Sprintf(" AND ul.price <= $%d", argCount)
        args = append(args, filters.MaxPrice)
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ —É—Å–ª–æ–≤–∏—é
    if filters.Condition != "" {
        argCount++
        query += fmt.Sprintf(" AND ul.condition = $%d", argCount)
        args = append(args, filters.Condition)
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ –≤–∏—Ç—Ä–∏–Ω–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è B2C)
    if filters.StorefrontID > 0 {
        argCount++
        query += fmt.Sprintf(" AND ul.storefront_id = $%d", argCount)
        args = append(args, filters.StorefrontID)
    }

    // –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
    if filters.Query != "" {
        argCount++
        query += fmt.Sprintf(`
            AND (
                LOWER(ul.title) LIKE LOWER($%d)
                OR LOWER(ul.description) LIKE LOWER($%d)
            )
        `, argCount, argCount)
        args = append(args, "%"+filters.Query+"%")
    }

    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
    query += `
    ORDER BY ul.created_at DESC
    LIMIT $%d OFFSET $%d
    )
    SELECT * FROM filtered_listings
    `

    argCount++
    query = strings.ReplaceAll(query, "$%d", fmt.Sprintf("$%d", argCount))
    args = append(args, filters.Limit)

    argCount++
    args = append(args, filters.Offset)

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
    rows, err := s.pool.Query(ctx, query, args...)
    if err != nil {
        return nil, 0, fmt.Errorf("failed to query unified listings: %w", err)
    }
    defer rows.Close()

    listings := []models.UnifiedListing{}
    var totalCount int64

    for rows.Next() {
        var listing models.UnifiedListing
        // ... —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π

        listings = append(listings, listing)
        totalCount = listing.TotalCount
    }

    return listings, totalCount, nil
}
```

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞—Ç—å service –¥–ª—è unified listings

**–§–∞–π–ª:** `backend/internal/proj/unified/service/unified_service.go`

```go
package service

import (
    "context"

    "backend/internal/domain/models"
)

type UnifiedService struct {
    storage           UnifiedStorageInterface
    translationSvc    TranslationService
    userService       UserService
}

func NewUnifiedService(
    storage UnifiedStorageInterface,
    translationSvc TranslationService,
    userService UserService,
) *UnifiedService {
    return &UnifiedService{
        storage:        storage,
        translationSvc: translationSvc,
        userService:    userService,
    }
}

// GetUnifiedListings —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
func (s *UnifiedService) GetUnifiedListings(
    ctx context.Context,
    filters models.UnifiedListingsFilters,
) (*models.UnifiedListingsResponse, error) {

    // –ü–æ–ª—É—á–∏—Ç—å listings –∏–∑ storage
    listings, total, err := s.storage.GetUnifiedListings(ctx, filters)
    if err != nil {
        return nil, err
    }

    // –û–±–æ–≥–∞—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    userIDs := extractUserIDs(listings)
    users, _ := s.userService.GetUsersByIDs(ctx, userIDs)
    usersMap := mapUsers(users)

    // –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã
    lang := ctx.Value("language").(string)
    for i := range listings {
        // –î–æ–±–∞–≤–∏—Ç—å user
        if user, ok := usersMap[listings[i].UserID]; ok {
            listings[i].User = user
        }

        // –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã
        if lang != listings[i].OriginalLang {
            translations := s.translationSvc.GetTranslations(
                ctx,
                "listing",
                listings[i].ID,
                lang,
            )
            listings[i].Translations = translations
        }
    }

    return &models.UnifiedListingsResponse{
        Data:       listings,
        Total:      total,
        Limit:      filters.Limit,
        Offset:     filters.Offset,
        SourceType: filters.SourceType,
    }, nil
}
```

### –≠—Ç–∞–ø 4: –°–æ–∑–¥–∞—Ç—å handler –¥–ª—è unified listings

**–§–∞–π–ª:** `backend/internal/proj/unified/handler/unified_handler.go`

```go
package handler

import (
    "strconv"

    "github.com/gofiber/fiber/v2"
    "backend/internal/domain/models"
    "backend/internal/proj/unified/service"
)

type UnifiedHandler struct {
    service *service.UnifiedService
}

func NewUnifiedHandler(service *service.UnifiedService) *UnifiedHandler {
    return &UnifiedHandler{service: service}
}

// GetUnifiedListings godoc
// @Summary Get unified listings (C2C + B2C)
// @Description –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ C2C –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ B2C —Ç–æ–≤–∞—Ä–æ–≤
// @Tags unified
// @Accept json
// @Produce json
// @Param source_type query string false "–¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞: all, c2c, b2c" default(all)
// @Param category_id query int false "ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
// @Param min_price query number false "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"
// @Param max_price query number false "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"
// @Param condition query string false "–°–æ—Å—Ç–æ—è–Ω–∏–µ: new, used, refurbished"
// @Param query query string false "–¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫"
// @Param storefront_id query int false "ID –≤–∏—Ç—Ä–∏–Ω—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è B2C)"
// @Param limit query int false "–õ–∏–º–∏—Ç" default(20)
// @Param offset query int false "–°–º–µ—â–µ–Ω–∏–µ" default(0)
// @Success 200 {object} models.UnifiedListingsResponse
// @Failure 400 {object} ErrorResponse
// @Failure 500 {object} ErrorResponse
// @Router /api/v1/unified/listings [get]
func (h *UnifiedHandler) GetUnifiedListings(c *fiber.Ctx) error {
    // –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    filters := models.UnifiedListingsFilters{
        SourceType:   c.Query("source_type", "all"),
        CategoryID:   c.QueryInt("category_id", 0),
        MinPrice:     c.QueryFloat("min_price", 0),
        MaxPrice:     c.QueryFloat("max_price", 0),
        Condition:    c.Query("condition", ""),
        Query:        c.Query("query", ""),
        StorefrontID: c.QueryInt("storefront_id", 0),
        Limit:        c.QueryInt("limit", 20),
        Offset:       c.QueryInt("offset", 0),
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if filters.Limit < 1 || filters.Limit > 100 {
        filters.Limit = 20
    }

    if filters.SourceType != "all" &&
       filters.SourceType != "c2c" &&
       filters.SourceType != "b2c" {
        filters.SourceType = "all"
    }

    // –ü–æ–ª—É—á–∏—Ç—å listings
    response, err := h.service.GetUnifiedListings(c.Context(), filters)
    if err != nil {
        return c.Status(500).JSON(fiber.Map{
            "error": "unified.failed_to_get_listings",
        })
    }

    return c.JSON(fiber.Map{
        "success": true,
        "data":    response.Data,
        "total":   response.Total,
        "limit":   response.Limit,
        "offset":  response.Offset,
    })
}
```

### –≠—Ç–∞–ø 5: –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—É—Ç—ã

**–§–∞–π–ª:** `backend/internal/proj/unified/handler/routes.go`

```go
package handler

import (
    "github.com/gofiber/fiber/v2"
    "backend/internal/middleware"
)

func (h *UnifiedHandler) RegisterRoutes(app *fiber.App, mw *middleware.Middleware) error {
    // –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
    unified := app.Group("/api/v1/unified")
    unified.Get("/listings", h.GetUnifiedListings)
    unified.Get("/listings/:id", h.GetUnifiedListingByID)

    return nil
}
```

---

## Frontend (Next.js/React)

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞—Ç—å API —Ç–∏–ø—ã

**–§–∞–π–ª:** `frontend/svetu/src/types/unified-listing.ts`

```typescript
export type ListingSourceType = 'c2c' | 'b2c' | 'all';

export interface UnifiedImage {
  id: number;
  url: string;
  thumbnail_url?: string;
  is_main: boolean;
  display_order: number;
}

export interface UnifiedListing {
  id: number;
  source_type: 'c2c' | 'b2c';
  user_id: number;
  category_id: number;
  title: string;
  description: string;
  price: number;
  condition: string;
  status: string;
  location: string;
  latitude?: number;
  longitude?: number;
  city: string;
  country: string;
  views_count: number;
  created_at: string;
  updated_at: string;
  show_on_map: boolean;
  original_language: string;
  storefront_id?: number; // —Ç–æ–ª—å–∫–æ –¥–ª—è B2C
  metadata?: Record<string, any>;

  // –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  images: UnifiedImage[];
  user?: User;
  category?: Category;
  storefront?: Storefront;
  translations?: Record<string, any>;

  // –§–ª–∞–≥–∏
  is_favorite: boolean;
  has_discount: boolean;
}

export interface UnifiedListingsFilters {
  source_type?: ListingSourceType;
  category_id?: number;
  min_price?: number;
  max_price?: number;
  condition?: string;
  query?: string;
  storefront_id?: number;
  limit?: number;
  offset?: number;
}

export interface UnifiedListingsResponse {
  success: boolean;
  data: UnifiedListing[];
  total: number;
  limit: number;
  offset: number;
}
```

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞—Ç—å API –∫–ª–∏–µ–Ω—Ç

**–§–∞–π–ª:** `frontend/svetu/src/services/unified-listings-api.ts`

```typescript
import { apiClient } from './api-client';
import type {
  UnifiedListing,
  UnifiedListingsFilters,
  UnifiedListingsResponse,
} from '@/types/unified-listing';

export const unifiedListingsApi = {
  /**
   * –ü–æ–ª—É—á–∏—Ç—å unified listings (C2C + B2C)
   */
  getListings: async (
    filters?: UnifiedListingsFilters
  ): Promise<UnifiedListingsResponse> => {
    const params = new URLSearchParams();

    if (filters?.source_type) params.append('source_type', filters.source_type);
    if (filters?.category_id) params.append('category_id', String(filters.category_id));
    if (filters?.min_price) params.append('min_price', String(filters.min_price));
    if (filters?.max_price) params.append('max_price', String(filters.max_price));
    if (filters?.condition) params.append('condition', filters.condition);
    if (filters?.query) params.append('query', filters.query);
    if (filters?.storefront_id) params.append('storefront_id', String(filters.storefront_id));
    if (filters?.limit) params.append('limit', String(filters.limit));
    if (filters?.offset) params.append('offset', String(filters.offset));

    const response = await apiClient.get<UnifiedListingsResponse>(
      `/unified/listings?${params.toString()}`
    );

    return response.data;
  },

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π unified listing –ø–æ ID –∏ —Ç–∏–ø—É
   */
  getListingById: async (
    id: number,
    sourceType: 'c2c' | 'b2c'
  ): Promise<UnifiedListing> => {
    const response = await apiClient.get<{ data: UnifiedListing }>(
      `/unified/listings/${id}?source_type=${sourceType}`
    );

    return response.data.data;
  },
};
```

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Ç–∏–ø—É

**–§–∞–π–ª:** `frontend/svetu/src/components/unified/ListingTypeFilter.tsx`

```typescript
'use client';

import { useTranslations } from 'next-intl';
import type { ListingSourceType } from '@/types/unified-listing';

interface ListingTypeFilterProps {
  value: ListingSourceType;
  onChange: (value: ListingSourceType) => void;
  className?: string;
}

export function ListingTypeFilter({
  value,
  onChange,
  className = '',
}: ListingTypeFilterProps) {
  const t = useTranslations('unified');

  const options: { value: ListingSourceType; label: string }[] = [
    { value: 'all', label: t('filter.all') },
    { value: 'c2c', label: t('filter.c2c') },
    { value: 'b2c', label: t('filter.b2c') },
  ];

  return (
    <div className={`flex gap-2 ${className}`}>
      {options.map((option) => (
        <button
          key={option.value}
          onClick={() => onChange(option.value)}
          className={`
            px-4 py-2 rounded-lg font-medium transition-colors
            ${value === option.value
              ? 'bg-blue-600 text-white'
              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
            }
          `}
        >
          {option.label}
        </button>
      ))}
    </div>
  );
}
```

### –≠—Ç–∞–ø 4: –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç UnifiedListingCard

**–§–∞–π–ª:** `frontend/svetu/src/components/unified/UnifiedListingCard.tsx`

```typescript
'use client';

import Image from 'next/image';
import Link from 'next/link';
import { useTranslations } from 'next-intl';
import type { UnifiedListing } from '@/types/unified-listing';

interface UnifiedListingCardProps {
  listing: UnifiedListing;
  locale: string;
}

export function UnifiedListingCard({ listing, locale }: UnifiedListingCardProps) {
  const t = useTranslations('unified');

  // –ü–æ–ª—É—á–∏—Ç—å –≥–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  const mainImage = listing.images.find((img) => img.is_main) || listing.images[0];

  // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  const detailUrl = listing.source_type === 'c2c'
    ? `/${locale}/c2c/listings/${listing.id}`
    : `/${locale}/b2c/products/${listing.id}`;

  // –ë–µ–π–¥–∂ —Ç–∏–ø–∞
  const typeBadge = (
    <span
      className={`
        absolute top-2 right-2 px-2 py-1 rounded text-xs font-semibold
        ${listing.source_type === 'c2c'
          ? 'bg-green-500 text-white'
          : 'bg-blue-500 text-white'
        }
      `}
    >
      {listing.source_type === 'c2c' ? t('badge.c2c') : t('badge.b2c')}
    </span>
  );

  return (
    <Link href={detailUrl}>
      <div className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
        {/* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ */}
        <div className="relative aspect-square">
          {mainImage ? (
            <Image
              src={mainImage.url}
              alt={listing.title}
              fill
              className="object-cover"
            />
          ) : (
            <div className="w-full h-full bg-gray-200 flex items-center justify-center">
              <span className="text-gray-400">No image</span>
            </div>
          )}
          {typeBadge}
        </div>

        {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}
        <div className="p-4">
          <h3 className="font-semibold text-lg mb-2 line-clamp-2">
            {listing.title}
          </h3>

          <p className="text-gray-600 text-sm mb-3 line-clamp-2">
            {listing.description}
          </p>

          <div className="flex items-center justify-between">
            <span className="text-xl font-bold text-blue-600">
              {listing.price.toFixed(2)} RSD
            </span>

            {listing.condition && (
              <span className="text-sm text-gray-500">
                {t(`condition.${listing.condition}`)}
              </span>
            )}
          </div>

          {/* –í–∏—Ç—Ä–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è B2C) */}
          {listing.source_type === 'b2c' && listing.storefront && (
            <div className="mt-3 pt-3 border-t">
              <span className="text-xs text-gray-500">
                {listing.storefront.name}
              </span>
            </div>
          )}
        </div>
      </div>
    </Link>
  );
}
```

### –≠—Ç–∞–ø 5: –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–§–∞–π–ª:** `frontend/svetu/src/app/[locale]/page.tsx`

```typescript
'use client';

import { useState, useEffect } from 'react';
import { useTranslations } from 'next-intl';
import { unifiedListingsApi } from '@/services/unified-listings-api';
import { UnifiedListingCard } from '@/components/unified/UnifiedListingCard';
import { ListingTypeFilter } from '@/components/unified/ListingTypeFilter';
import type { UnifiedListing, ListingSourceType } from '@/types/unified-listing';

export default function HomePage({ params: { locale } }: { params: { locale: string } }) {
  const t = useTranslations('home');
  const [listings, setListings] = useState<UnifiedListing[]>([]);
  const [sourceType, setSourceType] = useState<ListingSourceType>('all');
  const [loading, setLoading] = useState(true);
  const [total, setTotal] = useState(0);

  useEffect(() => {
    const fetchListings = async () => {
      setLoading(true);
      try {
        const response = await unifiedListingsApi.getListings({
          source_type: sourceType,
          limit: 20,
          offset: 0,
        });

        setListings(response.data);
        setTotal(response.total);
      } catch (error) {
        console.error('Failed to fetch listings:', error);
      } finally {
        setLoading(false);
      }
    };

    fetchListings();
  }, [sourceType]);

  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold mb-6">{t('title')}</h1>

      {/* –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É */}
      <ListingTypeFilter
        value={sourceType}
        onChange={setSourceType}
        className="mb-6"
      />

      {/* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */}
      <div className="mb-4 text-gray-600">
        {t('results_count', { count: total })}
      </div>

      {/* Grid */}
      {loading ? (
        <div>Loading...</div>
      ) : (
        <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
          {listings.map((listing) => (
            <UnifiedListingCard
              key={`${listing.source_type}-${listing.id}`}
              listing={listing}
              locale={locale}
            />
          ))}
        </div>
      )}
    </div>
  );
}
```

### –≠—Ç–∞–ø 6: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã

**–§–∞–π–ª:** `frontend/svetu/src/messages/ru/unified.json`

```json
{
  "filter": {
    "all": "–í—Å–µ",
    "c2c": "–û–±—ä—è–≤–ª–µ–Ω–∏—è",
    "b2c": "–í–∏—Ç—Ä–∏–Ω—ã"
  },
  "badge": {
    "c2c": "C2C",
    "b2c": "–í–∏—Ç—Ä–∏–Ω–∞"
  },
  "condition": {
    "new": "–ù–æ–≤–æ–µ",
    "used": "–ë/–£",
    "refurbished": "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ"
  }
}
```

**–§–∞–π–ª—ã:** `frontend/svetu/src/messages/{en,sr}/unified.json` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)

---

## –ü–æ–∏—Å–∫ (OpenSearch)

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞—Ç—å unified –∏–Ω–¥–µ–∫—Å

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –î–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–∞ —Å prefix**

```json
// –ò–Ω–¥–µ–∫—Å: c2c_listings
{
  "mappings": {
    "properties": {
      "id": { "type": "integer" },
      "source_type": { "type": "keyword", "index": true },
      "title": { "type": "text", "analyzer": "standard" },
      "description": { "type": "text" },
      "price": { "type": "float" },
      "category_id": { "type": "integer" },
      "created_at": { "type": "date" },
      "location": { "type": "geo_point" }
    }
  }
}

// –ò–Ω–¥–µ–∫—Å: b2c_products
// (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
```

**–ü–æ–∏—Å–∫ –ø–æ –æ–±–æ–∏–º –∏–Ω–¥–µ–∫—Å–∞–º:**

```json
GET /c2c_listings,b2c_products/_search
{
  "query": {
    "multi_match": {
      "query": "–±–∞—Ç–∞—Ä–µ–π–∫–∞ nokia",
      "fields": ["title^2", "description"]
    }
  },
  "sort": [
    { "created_at": "desc" }
  ]
}
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: –û–¥–∏–Ω –æ–±—â–∏–π –∏–Ω–¥–µ–∫—Å —Å –ø–æ–ª–µ–º source_type**

```json
// –ò–Ω–¥–µ–∫—Å: unified_listings
{
  "mappings": {
    "properties": {
      "id": { "type": "integer" },
      "source_type": { "type": "keyword" },
      "title": { "type": "text" },
      // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
    }
  }
}
```

**–§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É:**

```json
GET /unified_listings/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "title": "–±–∞—Ç–∞—Ä–µ–π–∫–∞" } }
      ],
      "filter": [
        { "term": { "source_type": "b2c" } }
      ]
    }
  }
}
```

### –≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–∏—Ç—å indexer

**–§–∞–π–ª:** `backend/internal/proj/unified/indexer/opensearch_indexer.go`

```go
package indexer

import (
    "context"
    "encoding/json"
    "fmt"

    "backend/internal/domain/models"
    opensearch "github.com/opensearch-project/opensearch-go"
)

type UnifiedIndexer struct {
    client *opensearch.Client
}

func NewUnifiedIndexer(client *opensearch.Client) *UnifiedIndexer {
    return &UnifiedIndexer{client: client}
}

// IndexC2CListing –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç C2C listing
func (i *UnifiedIndexer) IndexC2CListing(ctx context.Context, listing *models.MarketplaceListing) error {
    doc := map[string]interface{}{
        "id":          listing.ID,
        "source_type": "c2c",
        "title":       listing.Title,
        "description": listing.Description,
        "price":       listing.Price,
        "category_id": listing.CategoryID,
        "created_at":  listing.CreatedAt,
        "location": map[string]float64{
            "lat": *listing.Latitude,
            "lon": *listing.Longitude,
        },
    }

    body, _ := json.Marshal(doc)

    _, err := i.client.Index(
        "unified_listings",
        opensearch.StringBody(string(body)),
        opensearch.WithDocumentID(fmt.Sprintf("c2c_%d", listing.ID)),
        opensearch.WithContext(ctx),
    )

    return err
}

// IndexB2CProduct –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç B2C product
func (i *UnifiedIndexer) IndexB2CProduct(ctx context.Context, product *models.StorefrontProduct) error {
    doc := map[string]interface{}{
        "id":          product.ID,
        "source_type": "b2c",
        "title":       product.Name,
        "description": product.Description,
        "price":       product.Price,
        "category_id": product.CategoryID,
        "created_at":  product.CreatedAt,
        // ... location from storefront
    }

    body, _ := json.Marshal(doc)

    _, err := i.client.Index(
        "unified_listings",
        opensearch.StringBody(string(body)),
        opensearch.WithDocumentID(fmt.Sprintf("b2c_%d", product.ID)),
        opensearch.WithContext(ctx),
    )

    return err
}

// SearchUnified –ø–æ–∏—Å–∫ –ø–æ unified –∏–Ω–¥–µ–∫—Å—É
func (i *UnifiedIndexer) SearchUnified(
    ctx context.Context,
    query string,
    sourceType string,
    limit, offset int,
) ([]map[string]interface{}, int64, error) {

    searchQuery := map[string]interface{}{
        "query": map[string]interface{}{
            "bool": map[string]interface{}{
                "must": []interface{}{
                    map[string]interface{}{
                        "multi_match": map[string]interface{}{
                            "query":  query,
                            "fields": []string{"title^2", "description"},
                        },
                    },
                },
            },
        },
        "from": offset,
        "size": limit,
        "sort": []interface{}{
            map[string]interface{}{"created_at": "desc"},
        },
    }

    // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É
    if sourceType != "all" && sourceType != "" {
        searchQuery["query"].(map[string]interface{})["bool"].(map[string]interface{})["filter"] = []interface{}{
            map[string]interface{}{
                "term": map[string]interface{}{
                    "source_type": sourceType,
                },
            },
        }
    }

    body, _ := json.Marshal(searchQuery)

    res, err := i.client.Search(
        i.client.Search.WithContext(ctx),
        i.client.Search.WithIndex("unified_listings"),
        i.client.Search.WithBody(opensearch.StringBody(string(body))),
    )

    if err != nil {
        return nil, 0, err
    }
    defer res.Body.Close()

    // –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    var result map[string]interface{}
    json.NewDecoder(res.Body).Decode(&result)

    hits := result["hits"].(map[string]interface{})["hits"].([]interface{})
    total := int64(result["hits"].(map[string]interface{})["total"].(map[string]interface{})["value"].(float64))

    results := make([]map[string]interface{}, len(hits))
    for i, hit := range hits {
        results[i] = hit.(map[string]interface{})["_source"].(map[string]interface{})
    }

    return results, total, nil
}
```

### –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

**–§–∞–π–ª:** `backend/scripts/reindex_unified.py`

```python
#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ unified listings (C2C + B2C) –≤ OpenSearch
"""

import psycopg2
from opensearchpy import OpenSearch
import json
from datetime import datetime

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
DB_DSN = "postgresql://postgres:password@localhost:5432/svetubd"
OPENSEARCH_HOST = "localhost"
OPENSEARCH_PORT = 9200
INDEX_NAME = "unified_listings"

def create_index(client):
    """–°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å unified_listings"""
    index_body = {
        "settings": {
            "number_of_shards": 1,
            "number_of_replicas": 0,
            "analysis": {
                "analyzer": {
                    "serbian_analyzer": {
                        "type": "custom",
                        "tokenizer": "standard",
                        "filter": ["lowercase", "asciifolding"]
                    }
                }
            }
        },
        "mappings": {
            "properties": {
                "id": {"type": "integer"},
                "source_type": {"type": "keyword"},
                "title": {"type": "text", "analyzer": "serbian_analyzer"},
                "description": {"type": "text", "analyzer": "serbian_analyzer"},
                "price": {"type": "float"},
                "condition": {"type": "keyword"},
                "status": {"type": "keyword"},
                "category_id": {"type": "integer"},
                "user_id": {"type": "integer"},
                "storefront_id": {"type": "integer"},
                "created_at": {"type": "date"},
                "updated_at": {"type": "date"},
                "location": {"type": "geo_point"},
            }
        }
    }

    # –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∏–Ω–¥–µ–∫—Å –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if client.indices.exists(INDEX_NAME):
        client.indices.delete(INDEX_NAME)
        print(f"Deleted old index: {INDEX_NAME}")

    # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
    client.indices.create(INDEX_NAME, body=index_body)
    print(f"Created index: {INDEX_NAME}")

def index_c2c_listings(client, conn):
    """–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å C2C listings"""
    cursor = conn.cursor()
    cursor.execute("""
        SELECT
            id, user_id, category_id, title, description,
            price, condition, status, latitude, longitude,
            created_at, updated_at
        FROM c2c_listings
        WHERE status = 'active'
    """)

    count = 0
    for row in cursor:
        doc_id = f"c2c_{row[0]}"
        doc = {
            "id": row[0],
            "source_type": "c2c",
            "user_id": row[1],
            "category_id": row[2],
            "title": row[3],
            "description": row[4],
            "price": float(row[5]) if row[5] else 0,
            "condition": row[6],
            "status": row[7],
            "location": {"lat": row[8], "lon": row[9]} if row[8] and row[9] else None,
            "created_at": row[10].isoformat() if row[10] else None,
            "updated_at": row[11].isoformat() if row[11] else None,
        }

        client.index(index=INDEX_NAME, id=doc_id, body=doc)
        count += 1

    cursor.close()
    print(f"Indexed {count} C2C listings")

def index_b2c_products(client, conn):
    """–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å B2C products"""
    cursor = conn.cursor()
    cursor.execute("""
        SELECT
            p.id, s.user_id, p.category_id, p.name, p.description,
            p.price, p.is_active, s.latitude, s.longitude,
            p.created_at, p.updated_at, p.storefront_id
        FROM b2c_products p
        JOIN b2c_stores s ON p.storefront_id = s.id
        WHERE p.is_active = true
    """)

    count = 0
    for row in cursor:
        doc_id = f"b2c_{row[0]}"
        doc = {
            "id": row[0],
            "source_type": "b2c",
            "user_id": row[1],
            "category_id": row[2],
            "title": row[3],
            "description": row[4],
            "price": float(row[5]) if row[5] else 0,
            "condition": "new",
            "status": "active" if row[6] else "inactive",
            "location": {"lat": row[7], "lon": row[8]} if row[7] and row[8] else None,
            "created_at": row[9].isoformat() if row[9] else None,
            "updated_at": row[10].isoformat() if row[10] else None,
            "storefront_id": row[11],
        }

        client.index(index=INDEX_NAME, id=doc_id, body=doc)
        count += 1

    cursor.close()
    print(f"Indexed {count} B2C products")

def main():
    print("Starting unified reindexing...")

    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenSearch
    client = OpenSearch(
        hosts=[{"host": OPENSEARCH_HOST, "port": OPENSEARCH_PORT}],
        http_auth=("admin", "admin"),
        use_ssl=False,
        verify_certs=False,
    )

    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
    conn = psycopg2.connect(DB_DSN)

    try:
        # –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å
        create_index(client)

        # –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å C2C
        index_c2c_listings(client, conn)

        # –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å B2C
        index_b2c_products(client, conn)

        # Refresh –∏–Ω–¥–µ–∫—Å
        client.indices.refresh(INDEX_NAME)

        print("Reindexing completed successfully!")
    except Exception as e:
        print(f"Error: {e}")
    finally:
        conn.close()

if __name__ == "__main__":
    main()
```

---

## –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (S3/MinIO)

### –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
s3://dimalocal-listings/          # C2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  ‚îú‚îÄ‚îÄ 1007/                       # listing_id
  ‚îÇ   ‚îî‚îÄ‚îÄ image.jpg
  ‚îú‚îÄ‚îÄ 1060/
  ‚îÇ   ‚îî‚îÄ‚îÄ image.jpg
  ‚îî‚îÄ‚îÄ ...

s3://dimalocal-storefronts/       # B2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  ‚îú‚îÄ‚îÄ 43/                         # storefront_id
  ‚îÇ   ‚îî‚îÄ‚îÄ products/
  ‚îÇ       ‚îú‚îÄ‚îÄ 1061/               # product_id
  ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ image.jpg
  ‚îÇ       ‚îî‚îÄ‚îÄ ...
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è: –ù–ï –¢–†–ï–ë–£–Æ–¢–°–Ø! ‚úÖ

–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ S3 **–∏–¥–µ–∞–ª—å–Ω–∞** –¥–ª—è unified listings:
- ‚úÖ C2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±–∞–∫–µ—Ç–µ
- ‚úÖ B2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±–∞–∫–µ—Ç–µ
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ ID (—Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏)
- ‚úÖ –õ–µ–≥–∫–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å –ø–æ URL

**URLs:**
```
C2C: https://s3.svetu.rs/dimalocal-listings/1067/image.jpg
B2C: https://s3.svetu.rs/dimalocal-storefronts/43/products/1061/image.jpg
```

---

## –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é

```bash
# –ü–æ–ª–Ω—ã–π –¥–∞–º–ø –ë–î
PGPASSWORD=mX3g1XGhMRUZEX3l pg_dump \
  -h localhost \
  -U postgres \
  -d svetubd \
  --no-owner \
  --no-acl \
  -f /tmp/backup_before_unified_$(date +%Y%m%d_%H%M%S).sql

# –î–∞–º–ø —Ç–æ–ª—å–∫–æ affected —Ç–∞–±–ª–∏—Ü
PGPASSWORD=mX3g1XGhMRUZEX3l pg_dump \
  -h localhost \
  -U postgres \
  -d svetubd \
  -t c2c_listings \
  -t c2c_images \
  -t b2c_products \
  -t b2c_product_images \
  --no-owner \
  --no-acl \
  -f /tmp/backup_unified_tables_$(date +%Y%m%d_%H%M%S).sql
```

### –≠—Ç–∞–ø 2: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
cd /data/hostel-booking-system/backend

# –ú–∏–≥—Ä–∞—Ü–∏—è 000177 (‚úÖ —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞)
./migrator up

# –ú–∏–≥—Ä–∞—Ü–∏—è 000178 (unified_listings VIEW)
./migrator up

# –ú–∏–≥—Ä–∞—Ü–∏—è 000179 (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤)
./migrator up
```

### –≠—Ç–∞–ø 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å VIEW
SELECT COUNT(*), source_type
FROM unified_listings
GROUP BY source_type;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- count | source_type
-- ------+------------
--     4 | c2c
--     5 | b2c

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
SELECT
    source_type,
    COUNT(*) as total_listings,
    SUM(jsonb_array_length(images)) as total_images
FROM unified_listings
GROUP BY source_type;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- source_type | total_listings | total_images
-- ------------+----------------+-------------
-- c2c         |              4 |            4
-- b2c         |              5 |            5
```

### –≠—Ç–∞–ø 4: –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å OpenSearch

```bash
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è unified listings
cd /data/hostel-booking-system/backend
python3 scripts/reindex_unified.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å
curl -X GET "http://localhost:9200/unified_listings/_count" | jq '.'
# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {"count": 9, ...}
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 1: Unit —Ç–µ—Å—Ç—ã

**Backend —Ç–µ—Å—Ç—ã:**

```bash
cd /data/hostel-booking-system/backend

# –¢–µ—Å—Ç—ã unified storage
go test -v ./internal/proj/unified/storage/postgres/...

# –¢–µ—Å—Ç—ã unified service
go test -v ./internal/proj/unified/service/...

# –¢–µ—Å—Ç—ã unified handler
go test -v ./internal/proj/unified/handler/...
```

**Frontend —Ç–µ—Å—Ç—ã:**

```bash
cd /data/hostel-booking-system/frontend/svetu

# Unit —Ç–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
yarn test src/components/unified/

# Integration —Ç–µ—Å—Ç—ã API
yarn test src/services/unified-listings-api.test.ts
```

### –≠—Ç–∞–ø 2: Integration —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `backend/internal/proj/unified/storage/postgres/unified_storage_test.go`

```go
package postgres_test

import (
    "context"
    "testing"

    "backend/internal/domain/models"
    "github.com/stretchr/testify/assert"
)

func TestGetUnifiedListings_All(t *testing.T) {
    storage := setupTestStorage(t)
    defer cleanupTestStorage(t, storage)

    // –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    createTestC2CListing(t, storage, 1)
    createTestB2CProduct(t, storage, 2)

    // –ü–æ–ª—É—á–∏—Ç—å unified listings (–≤—Å–µ —Ç–∏–ø—ã)
    listings, total, err := storage.GetUnifiedListings(context.Background(), models.UnifiedListingsFilters{
        SourceType: "all",
        Limit:      10,
        Offset:     0,
    })

    assert.NoError(t, err)
    assert.Equal(t, int64(2), total)
    assert.Len(t, listings, 2)

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã
    types := map[string]int{}
    for _, l := range listings {
        types[l.SourceType]++
    }
    assert.Equal(t, 1, types["c2c"])
    assert.Equal(t, 1, types["b2c"])
}

func TestGetUnifiedListings_C2COnly(t *testing.T) {
    storage := setupTestStorage(t)
    defer cleanupTestStorage(t, storage)

    createTestC2CListing(t, storage, 1)
    createTestB2CProduct(t, storage, 2)

    // –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ C2C
    listings, total, err := storage.GetUnifiedListings(context.Background(), models.UnifiedListingsFilters{
        SourceType: "c2c",
        Limit:      10,
        Offset:     0,
    })

    assert.NoError(t, err)
    assert.Equal(t, int64(1), total)
    assert.Len(t, listings, 1)
    assert.Equal(t, "c2c", listings[0].SourceType)
}

func TestGetUnifiedListings_WithImages(t *testing.T) {
    storage := setupTestStorage(t)
    defer cleanupTestStorage(t, storage)

    // –°–æ–∑–¥–∞—Ç—å C2C listing —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    listingID := createTestC2CListing(t, storage, 1)
    createTestC2CImages(t, storage, listingID, 2)

    // –°–æ–∑–¥–∞—Ç—å B2C product —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    productID := createTestB2CProduct(t, storage, 2)
    createTestB2CImages(t, storage, productID, 3)

    // –ü–æ–ª—É—á–∏—Ç—å unified listings
    listings, _, err := storage.GetUnifiedListings(context.Background(), models.UnifiedListingsFilters{
        SourceType: "all",
        Limit:      10,
    })

    assert.NoError(t, err)

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    for _, listing := range listings {
        assert.NotEmpty(t, listing.Images, "listing %d should have images", listing.ID)

        if listing.SourceType == "c2c" {
            assert.Len(t, listing.Images, 2)
        } else {
            assert.Len(t, listing.Images, 3)
        }
    }
}
```

### –≠—Ç–∞–ø 3: E2E —Ç–µ—Å—Ç—ã

**–§–∞–π–ª:** `frontend/svetu/e2e/unified-listings.spec.ts`

```typescript
import { test, expect } from '@playwright/test';

test.describe('Unified Listings', () => {
  test('should display all listings by default', async ({ page }) => {
    await page.goto('/ru');

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å listings
    await expect(page.locator('[data-testid="listing-card"]')).toHaveCount(9);
  });

  test('should filter by C2C type', async ({ page }) => {
    await page.goto('/ru');

    // –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —Ñ–∏–ª—å—Ç—Ä C2C
    await page.click('button:has-text("–û–±—ä—è–≤–ª–µ–Ω–∏—è")');

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ C2C
    const cards = page.locator('[data-testid="listing-card"]');
    await expect(cards).toHaveCount(4);

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–π–¥–∂–∏
    const badges = page.locator('[data-testid="source-badge"]');
    for (let i = 0; i < await badges.count(); i++) {
      await expect(badges.nth(i)).toHaveText('C2C');
    }
  });

  test('should filter by B2C type', async ({ page }) => {
    await page.goto('/ru');

    // –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —Ñ–∏–ª—å—Ç—Ä B2C
    await page.click('button:has-text("–í–∏—Ç—Ä–∏–Ω—ã")');

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ B2C
    const cards = page.locator('[data-testid="listing-card"]');
    await expect(cards).toHaveCount(5);

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–π–¥–∂–∏
    const badges = page.locator('[data-testid="source-badge"]');
    for (let i = 0; i < await badges.count(); i++) {
      await expect(badges.nth(i)).toHaveText('–í–∏—Ç—Ä–∏–Ω–∞');
    }
  });

  test('should display images for all listings', async ({ page }) => {
    await page.goto('/ru');

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —É –≤—Å–µ—Ö listings –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const images = page.locator('[data-testid="listing-card"] img');
    const count = await images.count();

    expect(count).toBeGreaterThan(0);

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
    for (let i = 0; i < count; i++) {
      const img = images.nth(i);
      await expect(img).toBeVisible();
      await expect(img).toHaveAttribute('src', /.+/);
    }
  });

  test('should navigate to correct detail page', async ({ page }) => {
    await page.goto('/ru');

    // –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ C2C listing
    const c2cCard = page.locator('[data-testid="source-badge"]:has-text("C2C")').first();
    await c2cCard.click();

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL
    await expect(page).toHaveURL(/\/ru\/c2c\/listings\/\d+/);

    // –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
    await page.goto('/ru');

    // –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ B2C listing
    const b2cCard = page.locator('[data-testid="source-badge"]:has-text("–í–∏—Ç—Ä–∏–Ω–∞")').first();
    await b2cCard.click();

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL
    await expect(page).toHaveURL(/\/ru\/b2c\/products\/\d+/);
  });
});
```

### –≠—Ç–∞–ø 4: –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß–µ–∫–ª–∏—Å—Ç:**

```markdown
## Backend API

- [ ] GET /api/v1/unified/listings?source_type=all - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç C2C + B2C
- [ ] GET /api/v1/unified/listings?source_type=c2c - —Ç–æ–ª—å–∫–æ C2C
- [ ] GET /api/v1/unified/listings?source_type=b2c - —Ç–æ–ª—å–∫–æ B2C
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –µ—Å—Ç—å —É –≤—Å–µ—Ö listings
- [ ] C2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ c2c_images
- [ ] B2C –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ b2c_product_images
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–µ—Ä–µ–≤–æ–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## Frontend

- [ ] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ listings
- [ ] –§–∏–ª—å—Ç—Ä "–í—Å–µ" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç C2C + B2C
- [ ] –§–∏–ª—å—Ç—Ä "–û–±—ä—è–≤–ª–µ–Ω–∏—è" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ C2C
- [ ] –§–∏–ª—å—Ç—Ä "–í–∏—Ç—Ä–∏–Ω—ã" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ B2C
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —É –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
- [ ] –ë–µ–π–¥–∂–∏ —Ç–∏–ø–∞ (C2C/B2C) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- [ ] –ö–ª–∏–∫ –Ω–∞ C2C –≤–µ–¥–µ—Ç –Ω–∞ /c2c/listings/:id
- [ ] –ö–ª–∏–∫ –Ω–∞ B2C –≤–µ–¥–µ—Ç –Ω–∞ /b2c/products/:id
- [ ] –£ B2C –∫–∞—Ä—Ç–æ—á–µ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã
- [ ] –ü–µ—Ä–µ–≤–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç (ru/en/sr)

## OpenSearch

- [ ] –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É –Ω–∞—Ö–æ–¥–∏—Ç C2C + B2C
- [ ] –§–∏–ª—å—Ç—Ä –ø–æ source_type —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ì–µ–æ–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] –§–∞—Å–µ—Ç—ã/–∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- [ ] –ó–∞–ø—Ä–æ—Å unified_listings VIEW –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è < 100ms
- [ ] API endpoint –æ—Ç–≤–µ—á–∞–µ—Ç < 200ms
- [ ] Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è < 2s
- [ ] –°–∫—Ä–æ–ª–ª —Å–ø–∏—Å–∫–∞ –ø–ª–∞–≤–Ω—ã–π (–Ω–µ—Ç –ª–∞–≥–æ–≤)
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –±—ã—Å—Ç—Ä–æ–µ

## –†–µ–≥—Ä–µ—Å—Å–∏—è

- [ ] –°—Ç–∞—Ä—ã–µ C2C endpoints –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- [ ] –°—Ç–∞—Ä—ã–µ B2C endpoints –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- [ ] Admin –ø–∞–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ C2C listing —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò–º–ø–æ—Ä—Ç B2C products —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±–∞–∫–µ—Ç—ã
```

---

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –≠—Ç–∞–ø 1: Dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd /data/hostel-booking-system/backend
./migrator up

# 2. –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å OpenSearch
python3 scripts/reindex_unified.py

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
/home/dim/.local/bin/kill-port-3000.sh
screen -dmS backend-3000 bash -c 'cd /data/hostel-booking-system/backend && go run ./cmd/api/main.go 2>&1 | tee /tmp/backend.log'

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å frontend
/home/dim/.local/bin/kill-port-3001.sh
/home/dim/.local/bin/start-frontend-screen.sh

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost:3000/api/v1/unified/listings | jq '.'
```

### –≠—Ç–∞–ø 2: dev.svetu.rs

```bash
# 1. –ö–æ–º–º–∏—Ç –∏ –ø—É—à
git add -A
git commit -m "feat: implement unified listings (C2C + B2C without duplication)"
git push origin feature/unified-listings

# 2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh svetu@svetu.rs
cd /opt/svetu-dev
git pull

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd backend
docker-compose exec backend ./migrator up

# 4. –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å
docker-compose exec backend python3 scripts/reindex_unified.py

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
make dev-restart
cd ../frontend/svetu
make dev-restart

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl https://devapi.svetu.rs/api/v1/unified/listings | jq '.'
```

### –≠—Ç–∞–ø 3: Production (svetu.rs)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å PR
git checkout main
git merge feature/unified-listings
git push origin main

# 2. –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑
git tag v0.3.0
git push origin v0.3.0

# 3. –ù–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ (–≤ maintenance window)
ssh root@svetu.rs
cd /opt/svetu

# Backup –ë–î
pg_dump ... > /backups/before_unified_$(date +%Y%m%d).sql

# Pull –∏–∑–º–µ–Ω–µ–Ω–∏–π
git pull origin main

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd backend
docker-compose exec backend ./migrator up

# –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è!)
docker-compose exec backend python3 scripts/reindex_unified.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker-compose restart backend
docker-compose restart frontend

# 4. Smoke —Ç–µ—Å—Ç—ã
curl https://api.svetu.rs/api/v1/unified/listings | jq '.total'
curl https://svetu.rs/ | grep "listings"

# 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
tail -f /var/log/svetu/backend.log
docker stats
```

---

## –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

### –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è |
|-----------|--------|-------|
| **Database** | –°–æ–∑–¥–∞—Ç—å VIEW unified_listings | 1 —á–∞—Å |
| | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã | 1 —á–∞—Å |
| | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ | 1 —á–∞—Å |
| **Backend** | –°–æ–∑–¥–∞—Ç—å models/structures | 2 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å unified storage | 4 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å unified service | 3 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å unified handler | 2 —á–∞—Å–∞ |
| | –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã | 3 —á–∞—Å–∞ |
| | –ù–∞–ø–∏—Å–∞—Ç—å integration —Ç–µ—Å—Ç—ã | 2 —á–∞—Å–∞ |
| **Frontend** | –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã TypeScript | 1 —á–∞—Å |
| | –°–æ–∑–¥–∞—Ç—å API client | 2 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞ | 2 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å UnifiedListingCard | 3 —á–∞—Å–∞ |
| | –û–±–Ω–æ–≤–∏—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É | 2 —á–∞—Å–∞ |
| | –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã | 1 —á–∞—Å |
| | –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã | 2 —á–∞—Å–∞ |
| **OpenSearch** | –°–æ–∑–¥–∞—Ç—å unified –∏–Ω–¥–µ–∫—Å | 2 —á–∞—Å–∞ |
| | –û–±–Ω–æ–≤–∏—Ç—å indexer | 3 —á–∞—Å–∞ |
| | –°–æ–∑–¥–∞—Ç—å reindex —Å–∫—Ä–∏–ø—Ç | 2 —á–∞—Å–∞ |
| | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ | 2 —á–∞—Å–∞ |
| **Testing** | E2E —Ç–µ—Å—Ç—ã | 3 —á–∞—Å–∞ |
| | –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 2 —á–∞—Å–∞ |
| | Regression —Ç–µ—Å—Ç—ã | 2 —á–∞—Å–∞ |
| **Deployment** | Dev deployment | 1 —á–∞—Å |
| | Production deployment | 2 —á–∞—Å–∞ |
| | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ fixes | 2 —á–∞—Å–∞ |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md | 1 —á–∞—Å |
| | –°–æ–∑–¥–∞—Ç—å API docs | 1 —á–∞—Å |
| | –°–æ–∑–¥–∞—Ç—å user guide | 1 —á–∞—Å |

### –ò—Ç–æ–≥–æ:

- **Database:** 3 —á–∞—Å–∞
- **Backend:** 16 —á–∞—Å–æ–≤
- **Frontend:** 13 —á–∞—Å–æ–≤
- **OpenSearch:** 9 —á–∞—Å–æ–≤
- **Testing:** 7 —á–∞—Å–æ–≤
- **Deployment:** 5 —á–∞—Å–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 3 —á–∞—Å–∞

**–ò–¢–û–ì–û: ~56 —á–∞—Å–æ–≤ (~7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)**

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–æ–≤!

1. **Database** (3 —á–∞—Å–∞) ‚Üí
2. **Backend** (16 —á–∞—Å–æ–≤) ‚Üí
3. **Frontend** (13 —á–∞—Å–æ–≤) ‚Üí
4. **OpenSearch** (9 —á–∞—Å–æ–≤) ‚Üí
5. **Testing** (7 —á–∞—Å–æ–≤) ‚Üí
6. **Deployment** (5 —á–∞—Å–æ–≤) ‚Üí
7. **Docs** (3 —á–∞—Å–∞)

**–ü—Ä–∞–≤–∏–ª–æ:** –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω –ü–û–õ–ù–û–°–¢–¨–Æ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É!

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

### –†–∏—Å–∫ 1: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å VIEW –º–µ–¥–ª–µ–Ω–Ω–∞—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ó–∞–ø—Ä–æ—Å—ã –∫ unified_listings –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è > 500ms
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ MATERIALIZED VIEW
CREATE MATERIALIZED VIEW unified_listings_mat AS
SELECT * FROM unified_listings;

-- –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
SELECT refresh_materialized_view('unified_listings_mat');
```

### –†–∏—Å–∫ 2: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–°–∏–º–ø—Ç–æ–º—ã:**
- –£ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö listings –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- URLs –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–∏—Ç—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å orphaned –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
SELECT COUNT(*) FROM c2c_images
WHERE listing_id NOT IN (SELECT id FROM c2c_listings);

SELECT COUNT(*) FROM b2c_product_images
WHERE storefront_product_id NOT IN (SELECT id FROM b2c_products);

-- –£–¥–∞–ª–∏—Ç—å orphaned
DELETE FROM c2c_images
WHERE listing_id NOT IN (SELECT id FROM c2c_listings);
```

### –†–∏—Å–∫ 3: OpenSearch –∏–Ω–¥–µ–∫—Å —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ–∏—Å–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ listings
- –ü–æ–∏—Å–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã–µ listings

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é (cron)
# –ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
*/10 * * * * cd /opt/svetu/backend && python3 scripts/reindex_unified.py

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Change Data Capture (CDC)
# –°–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è INSERT/UPDATE/DELETE –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏–Ω–¥–µ–∫—Å
```

### –†–∏—Å–∫ 4: –°–ª–æ–º–∞–ª–∏—Å—å —Å—Ç–∞—Ä—ã–µ endpoints

**–°–∏–º–ø—Ç–æ–º—ã:**
- /api/v1/c2c/listings –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- /api/v1/b2c/products –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- **–ù–ï —Ç—Ä–æ–≥–∞—Ç—å —Å—Ç–∞—Ä—ã–µ endpoints!**
- Unified endpoints - —ç—Ç–æ **–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ**, –∞ –Ω–µ –∑–∞–º–µ–Ω–∞
- –°—Ç–∞—Ä—ã–µ endpoints –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ

---

## –û—Ç–∫–∞—Ç (Rollback Plan)

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# 1. –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd /data/hostel-booking-system/backend
./migrator down

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä (–∏–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ 000177.down.sql)
psql "postgres://..." -f migrations/000177_remove_storefront_sync_trigger.down.sql

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã B2C –≤ c2c_listings
# (—Ç—Ä–∏–≥–≥–µ—Ä —Å–æ–∑–¥–∞—Å—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º UPDATE b2c_products)
psql "postgres://..." -c "
    UPDATE b2c_products
    SET updated_at = NOW()
    WHERE is_active = true;
"

# 4. –û—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–¥
git revert <commit-hash>
git push

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
/home/dim/.local/bin/kill-port-3000.sh && ...
```

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ OpenSearch
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
   - –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ API
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å lazy loading –¥–ª—è —Å–ø–∏—Å–∫–∞

3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ:**
   - –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É —Å unified listings
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–æ–∏—Å–∫–∏
   - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (similar listings)

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - API documentation (Swagger)
   - User guide –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
   - Developer guide –¥–ª—è maintenance

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è **–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ—Ç –∫–æ—Å—Ç—ã–ª—å** —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–µ—Ç —á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** - –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü—ã
‚úÖ **–ì–∏–±–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã** - –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ
‚úÖ **–ß–∏—Å—Ç—ã–π –∫–æ–¥** - –ø–æ–Ω—è—Ç–Ω–∞—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã (C2B, B2B)
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –∏–Ω–¥–µ–∫—Å—ã

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è, 2 –¥–Ω—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MVP

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 2025-10-11
**–í–µ—Ä—Å–∏—è:** 1.0
