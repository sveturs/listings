# Конфигурация для мобильного доступа

Этот файл описывает как настроить локальную разработку для доступа с мобильных устройств через VPN или локальную сеть.

## Проблема

По умолчанию Next.js приложение настроено на работу с `localhost`, что не позволяет:
- Тестировать с мобильных устройств
- Работать через VPN подключения
- Получать доступ по IP адресу

## Решение

### 1. Создайте файл `.env.local`

В корне директории `frontend/svetu/` создайте файл `.env.local` со следующим содержимым:

```env
# Local development environment for network access
# Позволяет доступ с телефона по VPN

# API Configuration
# URL бэкенд сервера - используем IP для доступа по сети
NEXT_PUBLIC_API_URL=http://100.88.44.15:3000

# MinIO Configuration  
# URL MinIO сервера для загрузки изображений
NEXT_PUBLIC_MINIO_URL=http://100.88.44.15:9000

# Frontend URL
# URL фронтенд приложения
NEXT_PUBLIC_FRONTEND_URL=http://100.88.44.15:3001

# Image domains configuration
NEXT_PUBLIC_IMAGE_HOSTS=http:100.88.44.15:9000,http:100.88.44.15:3000,http:localhost:9000,https:svetu.rs:443,http:localhost:3000

# Path pattern для изображений
NEXT_PUBLIC_IMAGE_PATH_PATTERN=/listings/**,/chat-files/**
```

### 2. Замените IP адрес

**ВАЖНО:** Замените `100.88.44.15` на ваш собственный IP адрес.

Узнать IP адрес можно командой:
```bash
# Linux/MacOS
ifconfig | grep "inet " | grep -v 127.0.0.1

# Windows
ipconfig | findstr "IPv4"

# Или через Node.js (выполнить в терминале)
node -e "console.log(require('os').networkInterfaces())"
```

### 3. Перезапустите сервер

После создания `.env.local` перезапустите Next.js:
```bash
cd frontend/svetu
yarn dev -p 3001
```

## Как это работает

1. **Универсальная конфигурация**: Приложение работает как с localhost, так и с IP адресом
2. **Автоматический fallback**: Если `.env.local` отсутствует, используются localhost значения
3. **Динамические rewrites**: Next.js автоматически направляет запросы на правильные адреса
4. **Поддержка изображений**: IP адрес добавляется в список разрешенных хостов для Next.js Image

## Доступ с мобильных устройств

После настройки вы сможете:
- Открыть `http://ВАШ_IP:3001` в браузере телефона
- Тестировать создание объявлений
- Загружать фотографии с камеры
- Полноценно использовать все функции приложения

## Важные замечания

1. **Файл `.env.local` не попадает в git** - каждый разработчик создает свой
2. **IP адрес должен быть актуальным** - при смене сети нужно обновить
3. **Backend и MinIO должны быть доступны** по указанному IP адресу
4. **Firewall** может блокировать доступ - убедитесь что порты 3000, 3001, 9000 открыты

## Отладка

Если не работает:
1. Проверьте IP адрес: `ping ВАШ_IP`
2. Проверьте доступность портов: `telnet ВАШ_IP 3000`
3. Посмотрите логи Next.js - должна быть строка: `Reload env: .env.local`
4. Убедитесь что backend запущен и доступен по IP адресу

## Пример для разных сетей

**Для VPN (Tailscale, WireGuard):**
```env
NEXT_PUBLIC_API_URL=http://100.88.44.15:3000
```

**Для локальной сети (WiFi):**
```env
NEXT_PUBLIC_API_URL=http://192.168.1.100:3000
```

**Для Docker/контейнеров:**
```env
NEXT_PUBLIC_API_URL=http://172.17.0.1:3000
```