# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Auth Service backend –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ RS256 —Ç–æ–∫–µ–Ω—ã, –Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –æ—Å—Ç–∞–ª–∏—Å—å —Å—Ç–∞—Ä—ã–µ HS256 —Ç–æ–∫–µ–Ω—ã, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏:
- `JWT validation failed - only RS256 tokens supported`
- 401 Unauthorized –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

Frontend —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –æ—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ HS256 —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

1. **TokenMigration —É—Ç–∏–ª–∏—Ç–∞** (`frontend/svetu/src/utils/tokenMigration.ts`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ä—ã—Ö HS256 —Ç–æ–∫–µ–Ω–æ–≤
   - –û—á–∏—â–∞–µ—Ç –≤—Å–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ cookies, localStorage –∏ sessionStorage
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ AuthContext

2. **–ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏**:
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏ —Å–∞–π—Ç–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç, —á—Ç–æ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
   - –ù—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ Google OAuth

## –†—É—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ)

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–û—á–∏—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è —Å–∞–π—Ç–∞**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Application/Storage
   - Clear Site Data

2. **–ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞**:
   ```javascript
   // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö cookies
   document.cookie.split(";").forEach(function(c) { 
     document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
   });
   
   // –û—á–∏—Å—Ç–∫–∞ localStorage
   localStorage.clear();
   
   // –û—á–∏—Å—Ç–∫–∞ sessionStorage  
   sessionStorage.clear();
   ```

3. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ Google OAuth

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

Backend —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ RS256 —Ç–æ–∫–µ–Ω—ã –æ—Ç Auth Service:
- –°—Ç–∞—Ä—ã–µ HS256 —Ç–æ–∫–µ–Ω—ã –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è
- –í—Å–µ —Ç–æ–∫–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–¥–∞–Ω—ã Auth Service
- –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏: `/data/hostel-booking-system/backend/keys/auth_service_public.pem`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ —É –≤–∞—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω:

```bash
# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å header —Ç–æ–∫–µ–Ω–∞
echo "YOUR_TOKEN" | cut -d'.' -f1 | base64 -d | jq .
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```json
{
  "alg": "RS256",
  "typ": "JWT"
}
```

–ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `"alg": "HS256"` - —ç—Ç–æ —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è.

## –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏

‚úÖ **Backend**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ RS256
‚úÖ **Auth Service**: –í—ã–¥–∞–µ—Ç RS256 —Ç–æ–∫–µ–Ω—ã
‚úÖ **Middleware**: –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ RS256 —Ç–æ–∫–µ–Ω—ã
‚ö†Ô∏è **–ë—Ä–∞—É–∑–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∏ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
curl -H "Authorization: Bearer YOUR_NEW_TOKEN" http://localhost:3000/api/v1/users/profile

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤
curl -H "Authorization: Bearer YOUR_NEW_TOKEN" http://localhost:3000/api/v1/admin/users
```