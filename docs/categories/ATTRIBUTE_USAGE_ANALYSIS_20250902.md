# Анализ использования системы атрибутов
## Дата: 02.09.2025

## 1. Текущее состояние системы

### Система маркетплейса (основная, работающая):
- **Уникальных атрибутов**: 85
- **Категорий использующих атрибуты**: 93  
- **Объявлений с атрибутами**: 5
- **Всего значений атрибутов**: 335
- **Записей в listing_attribute_values**: 15

### Система витрин (частично используется):
- **Уникальных атрибутов**: 14
- **Продуктов с атрибутами**: 0 (таблица storefront_product_attributes пустая)
- **Значений атрибутов**: 3

### Устаревшая система:
- **category_variant_attributes**: 4 записи
- **variant_attribute_mappings**: 4 записи (связи с категориями)

## 2. Обнаруженные дублирования

### Дублированные атрибуты между системами:
Только 1 атрибут дублируется:
- **color** - присутствует в обеих системах (marketplace и storefront)

### Количество таблиц по системам:
1. **Маркетплейс**: 3 основные таблицы
   - category_attributes (85 записей)
   - category_attribute_mapping (611 записей) 
   - listing_attribute_values (15 записей)

2. **Витрины**: 3 таблицы
   - product_variant_attributes (14 записей)
   - storefront_product_attributes (0 записей)
   - product_variant_attribute_values (3 записи)

3. **Устаревшая система**: 2 таблицы
   - category_variant_attributes (4 записи)
   - variant_attribute_mappings (4 записи)

4. **Вспомогательные**: 4 таблицы
   - attribute_groups
   - attribute_group_items
   - category_attribute_groups  
   - attribute_option_translations

## 3. Выводы

1. **Основная нагрузка** на системе маркетплейса (85 атрибутов, 93 категории)
2. **Система витрин** почти не используется (0 продуктов с атрибутами)
3. **Минимальное дублирование** - только 1 атрибут (color)
4. **Устаревшая система** содержит минимум данных (4 записи)
5. **Всего 14 таблиц** вместо оптимальных 3-4

## 4. Рекомендации для миграции

1. **Приоритет миграции**: маркетплейс → витрины → устаревшая система
2. **Особое внимание**: атрибут "color" требует специальной обработки при объединении
3. **Безопасность**: система витрин можно мигрировать с минимальным риском (почти не используется)
4. **Архивирование**: устаревшую систему можно безопасно архивировать после миграции