# üß™ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: 03.09.2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–ö–¢–ò–í–ù–û –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø  
**–¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å**: –î–µ–Ω—å 11/30 - –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

## üìã –û–±–∑–æ—Ä

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤. 
–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—à–ª–∞ –ø–æ–ª–Ω–æ–µ E2E –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üéØ –¢–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. Unit —Ç–µ—Å—Ç—ã

#### Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```bash
cd frontend/svetu

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
yarn test

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è UnifiedAttributeField
yarn test UnifiedAttributeField

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è unifiedAttributeService  
yarn test unifiedAttributeService

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
yarn test --coverage
```

#### Backend —Ç–µ—Å—Ç—ã
```bash
cd backend

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
go test ./...

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤
go test ./internal/services/attributes/...
go test ./internal/proj/marketplace/handler/...

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -cover ./...
```

---

## 2. E2E —Ç–µ—Å—Ç—ã

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. **–í–∫–ª—é—á–∏—Ç—å feature flags –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
cd frontend/svetu

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cp .env.test .env.local

# –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é
echo "NEXT_PUBLIC_USE_UNIFIED_ATTRIBUTES=true" >> .env.local
echo "NEXT_PUBLIC_USE_API_V2=true" >> .env.local
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å backend —Å feature flags:**

```bash
cd backend

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å feature flags
export FEATURE_USE_UNIFIED_ATTRIBUTES=true
export FEATURE_USE_API_V2=true

# –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
go run ./cmd/api/main.go
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å frontend:**

```bash
cd frontend/svetu
yarn dev -p 3001
```

### –†—É—á–Ω–æ–µ E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä: http://localhost:3001
2. –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
4. –ù–∞ —à–∞–≥–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –ó–∞–≥—Ä—É–∑–∫—É –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π
   - –í–∞–ª–∏–¥–∞—Ü–∏—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —à–∞–≥)

---

## 3. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–°–æ–∑–¥–∞—Ç—å JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**

```bash
cd backend

# –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω
TOKEN=$(go run scripts/create_test_jwt.go)
echo "Token: $TOKEN"

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
export AUTH_TOKEN=$TOKEN
```

2. **–£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost:3000/api/v2/attributes/health
```

### –ó–∞–ø—É—Å–∫ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

```bash
cd backend

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç (30 —Å–µ–∫—É–Ω–¥, 10 –≤–æ—Ä–∫–µ—Ä–æ–≤)
go run scripts/load_test_unified_attributes.go

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ —Ñ–∞–π–ª–µ:
# - numWorkers: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
# - testDuration: –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
# - requestsPerWorker: –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤–æ—Ä–∫–µ—Ä
```

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

‚úÖ **–•–æ—Ä–æ—à–æ:**
- RPS > 100
- Success rate > 95%
- Avg response time < 100ms
- Max response time < 500ms

‚ö†Ô∏è **–ü—Ä–∏–µ–º–ª–µ–º–æ:**
- RPS > 50
- Success rate > 80%
- Avg response time < 200ms
- Max response time < 1000ms

‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
- RPS < 50
- Success rate < 80%
- Avg response time > 200ms
- Max response time > 1000ms

---

## 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ feature flags

### –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ localStorage (–±—Ä–∞—É–∑–µ—Ä)

```javascript
// –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

// –í–∫–ª—é—á–∏—Ç—å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
localStorage.setItem('featureFlags', JSON.stringify({
  useUnifiedAttributes: true,
  useApiV2: true
}));

// –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
location.reload();

// –û—Ç–∫–ª—é—á–∏—Ç—å
localStorage.setItem('featureFlags', JSON.stringify({
  useUnifiedAttributes: false,
  useApiV2: false
}));
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
console.log('Feature flags:', JSON.parse(localStorage.getItem('featureFlags') || '{}'));

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ React DevTools
// –î–æ–ª–∂–µ–Ω –±—ã—Ç—å UnifiedAttributesStep –≤–º–µ—Å—Ç–æ AttributesStep
```

---

## 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–µ—à–∞

1. –û—Ç–∫—Ä—ã—Ç—å Network tab –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —à–∞–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
3. –ó–∞–ø–æ–º–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∫ `/api/v2/attributes/category/{id}`
4. –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —à–∞–≥
5. –°–Ω–æ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —à–∞–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
6. **–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–µ—à)
7. –ü–æ–¥–æ–∂–¥–∞—Ç—å 5 –º–∏–Ω—É—Ç
8. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥
9. **–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å** (–∫–µ—à –∏—Å—Ç–µ–∫)

### –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
// –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
window.attributesCache?.clear();
window.cacheTimestamps?.clear();
```

---

## 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### Frontend –≤–∞–ª–∏–¥–∞—Ü–∏—è

1. –û—Å—Ç–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –ø—É—Å—Ç—ã–º
2. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
3. **–î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –æ—à–∏–±–∫–∞**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ
5. **–û—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å**

### –¢–∏–ø—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

- **Email**: test@example.com ‚úÖ, invalid-email ‚ùå
- **URL**: https://example.com ‚úÖ, not-a-url ‚ùå
- **Phone**: +1234567890 ‚úÖ, abc123 ‚ùå
- **Number**: min/max –≥—Ä–∞–Ω–∏—Ü—ã
- **Required**: –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ production —Å–ª–µ–¥–∏—Ç—å –∑–∞:

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
   - –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
   - –í—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ñ–æ—Ä–º
   - Cache hit rate

2. **–û—à–∏–±–∫–∏:**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ failed API requests
   - –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   - JavaScript errors –≤ –∫–æ–Ω—Å–æ–ª–∏

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
   - –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤–∫–ª—é—á–µ–Ω–Ω–æ–π –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
   - Conversion rate (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è)

---

## üêõ –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –í–∫–ª—é—á–∏—Ç—å debug –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
localStorage.setItem('DEBUG_UNIFIED_ATTRIBUTES', 'true');

// Backend –ª–æ–≥–∏
export LOG_LEVEL=debug
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **"Failed to load attributes"**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ backend
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∫–ª—é—á–µ–Ω –ª–∏ v2 API
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

2. **–ê—Ç—Ä–∏–±—É—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å feature flags
   - –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å is_required —Ñ–ª–∞–≥ –≤ –ë–î
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–∏–ø–∞ –∞—Ç—Ä–∏–±—É—Ç–∞

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ production

- [ ] Unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (coverage > 80%)
- [ ] E2E —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã
- [ ] –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (RPS > 100, success > 95%)
- [ ] Feature flags —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—Ä—É—á–Ω—É—é)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- [ ] Backend –ª–æ–≥–∏ —á–∏—Å—Ç—ã–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞
- [ ] Rollback –ø–ª–∞–Ω –≥–æ—Ç–æ–≤

---

## üöÄ –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ production

1. **–ù–∞—á–∞—Ç—å —Å 1% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
```javascript
// Backend –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
FEATURE_UNIFIED_ATTRIBUTES_ROLLOUT_PERCENTAGE=1
```

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 24 —á–∞—Å–∞**

3. **–£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 10%**

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 48 —á–∞—Å–æ–≤**

5. **–£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 50%**

6. **–§–∏–Ω–∞–ª—å–Ω—ã–π rollout 100%**

---

**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–î–∞—Ç–∞**: 03.09.2025  
**–í–µ—Ä—Å–∏—è**: 1.0