# üìä –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π
## Sve Tu Platforma - Marketplace

*–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 02.09.2025*  
*–°—Ç–∞—Ç—É—Å: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω*

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–†–µ–∑—é–º–µ](#—Ä–µ–∑—é–º–µ)
2. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-—Å–∏—Å—Ç–µ–º—ã)
3. [–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
4. [–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π](#–ø–ª–∞–Ω-—É–ª—É—á—à–µ–Ω–∏–π)
5. [–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
6. [–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞](#–º–µ—Ç—Ä–∏–∫–∏-—É—Å–ø–µ—Ö–∞)

---

## üìù –†–µ–∑—é–º–µ

–°–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ Sve Tu Platforma –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–π, –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–ª–Ω–æ—Ç—É, —Å–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–∞–¥–∞–µ—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:
- ‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã**: –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –ø–æ–ª–Ω–∞—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å, –º–æ—â–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º—ã**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã**: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —É–ª—É—á—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## üèóÔ∏è –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
```sql
-- –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
marketplace_categories (
    id, name, slug, parent_id, level,
    icon, sort_order, is_active,
    has_custom_ui, custom_ui_component,
    seo_title, seo_description, seo_keywords
)

-- –ê—Ç—Ä–∏–±—É—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π
category_attributes (
    id, name, display_name, attribute_type,
    options (JSONB), validation_rules (JSONB),
    is_searchable, is_filterable, is_required,
    is_variant_compatible, affects_stock
)

-- –°–≤—è–∑—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
category_attribute_mapping (
    category_id, attribute_id,
    is_enabled, is_required, sort_order
)

-- –í–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
category_variant_attributes (
    category_id, variant_attribute_name, is_required
)

-- –ó–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
listing_attribute_values (
    listing_id, attribute_id,
    text_value, numeric_value, boolean_value, json_value
)

-- –ü–µ—Ä–µ–≤–æ–¥—ã
translations (
    entity_type, entity_id, language,
    field_name, translated_text
)
```

### 2. Backend API

#### –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `/api/v1/marketplace/categories` - –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `/api/v1/marketplace/category-tree` - –î–µ—Ä–µ–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å –∫–µ—à–µ–º)
- `/api/v1/marketplace/categories/{id}/attributes` - –ê—Ç—Ä–∏–±—É—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `/api/v1/marketplace/categories/{id}/attribute-ranges` - –î–∏–∞–ø–∞–∑–æ–Ω—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- `/api/v1/marketplace/popular-categories` - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

#### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ —á–µ—Ä–µ–∑ Google Translate

### 3. Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `CategorySelector` - –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `CategoryAttributes` - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- `CategoryFilter` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- `CategoryService` - –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤:
- text, textarea
- numeric/number
- boolean
- select, multiselect
- date

---

## ‚ùå –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –°—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤:
- `category_attributes` + `category_attribute_mapping`
- `category_variant_attributes` + `product_variant_attributes`

**–í–ª–∏—è–Ω–∏–µ**: 
- –ü—É—Ç–∞–Ω–∏—Ü–∞ –≤ –∫–æ–¥–µ
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –†–∏—Å–∫ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –æ–±—ã—á–Ω—ã–µ –∏ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–µ

#### 2. –ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –¢—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –ø–µ—Ä–µ–≤–æ–¥–∞–º:
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–æ–ª—è `translations` –≤ –º–æ–¥–µ–ª—è—Ö
- –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `translations`
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `attribute_option_translations`

**–í–ª–∏—è–Ω–∏–µ**:
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `translations` –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

### üü° –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 1. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ö–µ—à –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–ª—å–∫–æ 5 –º–∏–Ω—É—Ç
- –ù–µ—Ç –∫–µ—à–∞ –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- –ù–µ—Ç –∫–µ—à–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤

**–í–ª–∏—è–Ω–∏–µ**: –ò–∑–ª–∏—à–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–†–µ—à–µ–Ω–∏–µ**: –í–Ω–µ–¥—Ä–∏—Ç—å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis

#### 2. N+1 –ø—Ä–æ–±–ª–µ–º—ã –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: –ê—Ç—Ä–∏–±—É—Ç—ã –∏ –ø–µ—Ä–µ–≤–æ–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–í–ª–∏—è–Ω–∏–µ**: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN –∑–∞–ø—Ä–æ—Å—ã –∏ eager loading

### üü† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. –°–º–µ—à–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: Admin handlers —Å–æ–¥–µ—Ä–∂–∞—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤–º–µ—Å—Ç–æ service layer

**–í–ª–∏—è–Ω–∏–µ**: –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ**: –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π

#### 2. –ù–µ–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–ª–µ `custom_component` –µ—Å—Ç—å, –Ω–æ –º–µ—Ö–∞–Ω–∏–∑–º –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

**–í–ª–∏—è–Ω–∏–µ**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö UI –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–†–µ—à–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üìà –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π

### –§–∞–∑–∞ 1: –ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

#### 1.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```go
// –ù–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
const (
    CategoryTreeCacheTTL = 1 * time.Hour  // –ë—ã–ª–æ: 5 –º–∏–Ω—É—Ç
    AttributesCacheTTL = 30 * time.Minute // –ù–æ–≤–æ–µ
    TranslationsCacheTTL = 2 * time.Hour  // –ù–æ–≤–æ–µ
)
```

#### 1.2 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ N+1 –ø—Ä–æ–±–ª–µ–º
```sql
-- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
SELECT c.*, 
       array_agg(DISTINCT jsonb_build_object(
           'id', ca.id,
           'name', ca.name,
           'type', ca.attribute_type
       )) as attributes,
       array_agg(DISTINCT jsonb_build_object(
           'language', t.language,
           'field', t.field_name,
           'text', t.translated_text
       )) as translations
FROM marketplace_categories c
LEFT JOIN category_attribute_mapping cam ON c.id = cam.category_id
LEFT JOIN category_attributes ca ON cam.attribute_id = ca.id
LEFT JOIN translations t ON t.entity_type = 'category' AND t.entity_id = c.id
GROUP BY c.id;
```

#### 1.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
```sql
-- –ú–∏–≥—Ä–∞—Ü–∏—è: 000XXX_optimize_category_indexes.up.sql
CREATE INDEX IF NOT EXISTS idx_translations_entity_lookup 
ON translations(entity_type, entity_id, language);

CREATE INDEX IF NOT EXISTS idx_listing_attributes_composite 
ON listing_attribute_values(listing_id, attribute_id);

CREATE INDEX IF NOT EXISTS idx_categories_active_parent 
ON marketplace_categories(is_active, parent_id) 
WHERE is_active = true;
```

### –§–∞–∑–∞ 2: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã (2-4 –Ω–µ–¥–µ–ª–∏)

#### 2.1 –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
```go
// –ù–æ–≤–∞—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
type UnifiedAttribute struct {
    ID              int              `json:"id"`
    Name            string           `json:"name"`
    DisplayName     string           `json:"display_name"`
    Type            AttributeType    `json:"type"`
    Purpose         AttributePurpose `json:"purpose"` // regular, variant, both
    Options         json.RawMessage  `json:"options"`
    ValidationRules json.RawMessage  `json:"validation_rules"`
    UISettings      UISettings       `json:"ui_settings"`
}

type AttributePurpose string
const (
    PurposeRegular AttributePurpose = "regular"
    PurposeVariant AttributePurpose = "variant"
    PurposeBoth    AttributePurpose = "both"
)
```

#### 2.2 –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```go
// backend/internal/services/category/service.go
type CategoryService interface {
    GetTree(ctx context.Context, lang string) (*CategoryTree, error)
    GetWithAttributes(ctx context.Context, id int, lang string) (*CategoryWithAttributes, error)
    CreateCategory(ctx context.Context, input CreateCategoryInput) (*Category, error)
    UpdateCategory(ctx context.Context, id int, input UpdateCategoryInput) (*Category, error)
    DeleteCategory(ctx context.Context, id int) error
    
    // –ê—Ç—Ä–∏–±—É—Ç—ã
    AssignAttribute(ctx context.Context, categoryID, attributeID int) error
    RemoveAttribute(ctx context.Context, categoryID, attributeID int) error
    UpdateAttributeSettings(ctx context.Context, categoryID, attributeID int, settings AttributeSettings) error
}
```

#### 2.3 –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
```sql
-- –ú–∏–≥—Ä–∞—Ü–∏—è: 000XXX_unify_translations.up.sql

-- –ü–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –∏–∑ attribute_option_translations
INSERT INTO translations (entity_type, entity_id, language, field_name, translated_text)
SELECT 'attribute_option', 
       attribute_id || '_' || option_key,
       CASE 
           WHEN ru_translation IS NOT NULL THEN 'ru'
           WHEN sr_translation IS NOT NULL THEN 'sr'
       END,
       'label',
       COALESCE(ru_translation, sr_translation)
FROM attribute_option_translations;

-- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π —Ç–∞–±–ª–∏—Ü—ã
DROP TABLE IF EXISTS attribute_option_translations;
```

### –§–∞–∑–∞ 3: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (4-8 –Ω–µ–¥–µ–ª—å)

#### 3.1 –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI
```typescript
// frontend/svetu/src/components/category/DynamicCategoryUI.tsx
interface DynamicCategoryUIProps {
    category: Category;
    componentName: string;
    props?: Record<string, any>;
}

const DynamicCategoryUI: React.FC<DynamicCategoryUIProps> = ({ 
    category, 
    componentName, 
    props 
}) => {
    const Component = useMemo(() => {
        return lazy(() => import(`./custom/${componentName}`));
    }, [componentName]);
    
    return (
        <Suspense fallback={<CategorySkeleton />}>
            <Component category={category} {...props} />
        </Suspense>
    );
};
```

#### 3.2 –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenSearch
```go
// backend/internal/storage/opensearch/category_indexer.go
type CategoryIndexer struct {
    client *opensearch.Client
}

func (ci *CategoryIndexer) IndexCategory(ctx context.Context, category *models.Category) error {
    doc := map[string]interface{}{
        "id":          category.ID,
        "name":        category.Name,
        "slug":        category.Slug,
        "path":        category.GetPath(),
        "level":       category.Level,
        "attributes":  category.GetAttributesForIndex(),
        "keywords":    category.GetKeywords(),
        "popularity":  category.GetPopularityScore(),
    }
    
    return ci.client.Index(ctx, "categories", doc)
}
```

#### 3.3 AI-powered –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
```go
// backend/internal/services/ai/categorizer.go
type Categorizer interface {
    SuggestCategory(ctx context.Context, title, description string) (*CategorySuggestion, error)
    ExtractAttributes(ctx context.Context, text string, categoryID int) (map[string]interface{}, error)
    ValidateCategory(ctx context.Context, listingID int) (*ValidationResult, error)
}
```

### –§–∞–∑–∞ 4: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (8+ –Ω–µ–¥–µ–ª—å)

#### 4.1 –í—ã–¥–µ–ª–µ–Ω–∏–µ Category Service
```yaml
# docker-compose.yml
services:
  category-service:
    build: ./services/category
    ports:
      - "3001:3001"
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
      - KAFKA_BROKERS=${KAFKA_BROKERS}
```

#### 4.2 Event-driven —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```go
// –°–æ–±—ã—Ç–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
type CategoryEvent struct {
    Type      EventType       `json:"type"`
    CategoryID int            `json:"category_id"`
    Payload   json.RawMessage `json:"payload"`
    Timestamp time.Time       `json:"timestamp"`
}

type EventType string
const (
    CategoryCreated EventType = "category.created"
    CategoryUpdated EventType = "category.updated"
    CategoryDeleted EventType = "category.deleted"
    AttributeAssigned EventType = "attribute.assigned"
    AttributeRemoved EventType = "attribute.removed"
)
```

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)
1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ N+1 –ø—Ä–æ–±–ª–µ–º** - 2 –¥–Ω—è
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –ë–î** - 1 –¥–µ–Ω—å
3. **–ë–∞–∑–æ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - 3 –¥–Ω—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)
1. **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤** - 1 –Ω–µ–¥–µ–ª—è
2. **–°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π** - 1 –Ω–µ–¥–µ–ª—è
3. **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤** - 3 –¥–Ω—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
1. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - 1 –Ω–µ–¥–µ–ª—è
2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenSearch** - 4 –¥–Ω—è
3. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis** - 3 –¥–Ω—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4 (–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ)
1. **AI –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** - 2 –Ω–µ–¥–µ–ª–∏
2. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - 1-2 –º–µ—Å—è—Ü–∞
3. **Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - 2-3 –Ω–µ–¥–µ–ª–∏

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚è±Ô∏è **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ä–µ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π**: < 100ms (—Å–µ–π—á–∞—Å: ~500ms)
- ‚è±Ô∏è **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤**: < 50ms (—Å–µ–π—á–∞—Å: ~200ms)
- üìâ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É**: < 10 (—Å–µ–π—á–∞—Å: 30-50)
- üíæ **Hit rate –∫–µ—à–∞**: > 80% (—Å–µ–π—á–∞—Å: ~20%)

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- üìù **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: > 80% (—Å–µ–π—á–∞—Å: ~40%)
- üêõ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–≥–æ–≤ –≤ –º–µ—Å—è—Ü**: < 5 (—Å–µ–π—á–∞—Å: ~15)
- üîÑ **–í—Ä–µ–º—è –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞**: < 30 –º–∏–Ω—É—Ç (—Å–µ–π—á–∞—Å: ~2 —á–∞—Å–∞)

### –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏
- üìà **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö**: +15%
- üéØ **–¢–æ—á–Ω–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏**: > 95%
- ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞**: -30% –≤—Ä–µ–º–µ–Ω–∏
- üòä **–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–∞–≤—Ü–æ–≤**: +20%

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (—ç—Ç–∞ –Ω–µ–¥–µ–ª—è):
1. –°–æ–∑–¥–∞—Ç—å –±—ç–∫–ª–æ–≥ –∑–∞–¥–∞—á –≤ —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏
2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–¥-—Ä–µ–≤—å—é —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤
3. –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (—ç—Ç–æ—Ç –º–µ—Å—è—Ü):
1. –ó–∞–≤–µ—Ä—à–∏—Ç—å –§–∞–∑—É 1 (–±—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
2. –ù–∞—á–∞—Ç—å –§–∞–∑—É 2 (—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è)
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ (—ç—Ç–æ—Ç –∫–≤–∞—Ä—Ç–∞–ª):
1. –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
2. –í–Ω–µ–¥—Ä–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π
3. –†–∞–±–æ—Ç–∞—é—â–∞—è AI –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
4. –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [CATEGORY_ATTRIBUTES_STATUS.md](./CATEGORY_ATTRIBUTES_STATUS.md) - –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- [IMPLEMENTATION_CATEGORY_SELECTOR.md](./IMPLEMENTATION_CATEGORY_SELECTOR.md) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–µ–ª–µ–∫—Ç–æ—Ä—É
- [DISPLAY_CATEGORIES_INSTRUCTION.md](./DISPLAY_CATEGORIES_INSTRUCTION.md) - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- [MAP_CATEGORIES_FILTERS_INSTRUCTION.md](./MAP_CATEGORIES_FILTERS_INSTRUCTION.md) - –§–∏–ª—å—Ç—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ
- [ADMIN_VARIANT_ATTRIBUTES_EXTENSION_PLAN.md](../ADMIN_VARIANT_ATTRIBUTES_EXTENSION_PLAN.md) - –ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

---

**–ê–≤—Ç–æ—Ä**: System Architect  
**–î–∞—Ç–∞**: 02.09.2025  
**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
