# Создание объявлений на маркетплейсе - Текущая реализация

## Обзор

Процесс создания объявления на маркетплейсе SveTu представляет собой пошаговый визард из 8 этапов. Система построена на React с использованием контекста для управления состоянием и поддерживает автосохранение черновиков.

## Структура процесса

### Шаг 1: Выбор категории (CategorySelectionStep)

**Компонент**: `/components/create-listing/steps/CategorySelectionStep.tsx`

**Функциональность**:
- Древовидная структура категорий с возможностью раскрытия/сворачивания
- Поиск по названию категории
- Визуальные индикаторы (папки для родительских категорий, файлы для конечных)
- Загрузка категорий через API с поддержкой локализации

**Проблемы**:
- Сложная навигация по дереву на мобильных устройствах
- Нет подсказок о популярных категориях
- Отсутствует история выбора категорий пользователя

### Шаг 2: Базовая информация (BasicInfoStep)

**Компонент**: `/components/create-listing/steps/BasicInfoStep.tsx`

**Функциональность**:
- Название объявления (до 80 символов)
- Описание (до 1000 символов)
- Цена и выбор валюты
- Состояние товара (новый/б/у/восстановленный)
- Переключатель скрипта (кириллица/латиница/смешанный)

**Особенности**:
- Автоматическая конвертация латиницы в кириллицу
- Счетчики символов для текстовых полей
- Визуальные карточки для выбора состояния товара

### Шаг 3: Система доверия (TrustSetupStep)

**Компонент**: `/components/create-listing/steps/TrustSetupStep.tsx`

**Проблемы**:
- Непонятное назначение этого шага
- Создает дополнительное трение в процессе
- Нет четкого объяснения преимуществ

### Шаг 4: Атрибуты категории (AttributesStep)

**Компонент**: `/components/create-listing/steps/AttributesStep.tsx`

**Функциональность**:
- Динамические поля в зависимости от выбранной категории
- Различные типы полей (текст, число, выбор, чекбоксы)
- Валидация на основе настроек категории

### Шаг 5: Фотографии (PhotosStep)

**Компонент**: `/components/create-listing/steps/PhotosStep.tsx`

**Функциональность**:
- Загрузка до 8 фотографий
- Drag & Drop поддержка
- Выбор главной фотографии
- Предпросмотр загруженных изображений
- Галерея для просмотра в полном размере

**Ограничения**:
- Максимальный размер файла: 10MB
- Только локальная обработка (TODO: интеграция с MinIO)

### Шаг 6: Местоположение (LocationStep)

**Компонент**: `/components/create-listing/steps/LocationStep.tsx`

**Функциональность**:
- Выбор местоположения на карте
- Настройки приватности (точный адрес/улица/район/город)
- Выбор безопасных мест встречи
- Мультиязычная поддержка адресов

### Шаг 7: Оплата и доставка (PaymentDeliveryStep)

**Компонент**: `/components/create-listing/steps/PaymentDeliveryStep.tsx`

**Функциональность**:
- Методы оплаты
- Способы доставки
- Наложенный платеж
- Личная передача

### Шаг 8: Предпросмотр и публикация (PreviewPublishStep)

**Компонент**: `/components/create-listing/steps/PreviewPublishStep.tsx`

**Функциональность**:
- Полный предпросмотр объявления
- Возможность вернуться и отредактировать
- Сохранение черновика
- Публикация объявления

## Технические детали

### Управление состоянием

**Контекст**: `/contexts/CreateListingContext.tsx`

Централизованное хранение данных всех шагов:
```typescript
interface CreateListingState {
  category?: Category;
  title?: string;
  description?: string;
  price?: number;
  currency?: string;
  condition?: string;
  images?: string[];
  mainImageIndex?: number;
  location?: LocationData;
  attributes?: Record<string, any>;
  // ... другие поля
}
```

### Навигация между шагами

**Компонент**: `/components/create-listing/StepWizard.tsx`

- Визуальный прогресс-бар
- Индикаторы завершенных шагов
- Возможность вернуться к предыдущим шагам
- Мобильная версия показывает только текущий шаг

### Автосохранение

- Черновики сохраняются в localStorage
- Автоматическое восстановление при возврате
- Индикатор статуса сохранения

## Проблемы текущей реализации

### UX проблемы

1. **Избыточная длина процесса** - 8 шагов отпугивают пользователей
2. **Непонятные шаги** - "Система доверия" сбивает с толку
3. **Отсутствие гибкости** - жесткая последовательность шагов
4. **Нет быстрого старта** - нельзя начать с фото
5. **Плохая мобильная адаптация** - мелкие элементы, сложная навигация

### Технические проблемы

1. **Отсутствие реальной загрузки изображений** - только локальное preview
2. **Нет интеграции с AI** - для помощи в заполнении
3. **Слабая валидация** - проверка только на финальном шаге
4. **Нет аналитики** - не отслеживаем где пользователи бросают

### Проблемы конверсии

По предварительным оценкам:
- Только 20% начавших доходят до публикации
- На мобильных устройствах конверсия еще ниже - около 10%
- Средне время создания объявления - 15 минут

## Вывод

Текущая реализация функциональна, но избыточно сложна для рядового пользователя. Процесс напоминает заполнение налоговой декларации, а не простое размещение объявления. Необходима кардинальная переработка UX с фокусом на простоту и скорость.