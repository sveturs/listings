# üó∫Ô∏è –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤

## üìã –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω—ã–µ** –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—è OpenStreetMap –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∏—Ö –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–µ. 

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–∏–≥–æ–Ω—ã —Å **–ø–æ–ª–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, 640/640 —Ç–æ—á–µ–∫ –¥–ª—è –í–µ—Ç–µ—Ä–Ω–∏–∫–∞) –±–µ–∑ —É–ø—Ä–æ—â–µ–Ω–∏–π.

---

## üéØ –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–í–µ—Ç–µ—Ä–Ω–∏–∫, –ù–æ–≤–∏-–°–∞–¥:**
- ‚úÖ **640 —Ç–æ—á–µ–∫** –∏–∑ OSM relation 9274009
- ‚úÖ **–ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ** —Ä–µ–∞–ª—å–Ω—ã–º –≥—Ä–∞–Ω–∏—Ü–∞–º
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ** –Ω–∞ OpenStreetMap –ø–æ–¥–ª–æ–∂–∫–µ

---

## üîç –®–∞–≥ 1: –ü–æ–∏—Å–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

### 1.1 –ß–µ—Ä–µ–∑ Nominatim API

```bash
# –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫ —Ä–∞–π–æ–Ω–∞
curl -s "https://nominatim.openstreetmap.org/search?q=Veternik,Novi+Sad,Serbia&format=json&limit=10" | jq '.'

# –° –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
curl -s "https://nominatim.openstreetmap.org/search?q=Veternik,Novi+Sad,Serbia&format=json&addressdetails=1&limit=10" | jq '.[0:3] | .[] | {display_name, osm_type, osm_id, type, place, importance}'
```

### 1.2 –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –æ–±—ä–µ–∫—Ç—ã:**
```json
{
  "osm_type": "relation",        // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û relation!
  "osm_id": 9274009,            // Relation ID
  "type": "administrative",      // –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞
  "importance": 0.42            // –í—ã—Å–æ–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å
}
```

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –æ–±—ä–µ–∫—Ç—ã:**
```json
{
  "osm_type": "node",           // –¢–æ—á–∫–∞, –Ω–µ –ø–æ–ª–∏–≥–æ–Ω
  "type": "car_parts",          // –ù–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–±—ä–µ–∫—Ç
  "importance": 0.00007         // –ù–∏–∑–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å
}
```

### 1.3 –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ Overpass API

```bash
# –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ Overpass
curl -s -X POST "https://overpass-api.de/api/interpreter" \
  --data-urlencode 'data=[out:json][timeout:25];
(
  relation["admin_level"~"^(8|9|10)$"]["name"="Veternik"];
  relation["boundary"="administrative"]["name"="Veternik"];
);
out geom;'
```

---

## üìç –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞

### 2.1 –ó–∞–ø—Ä–æ—Å –ø–æ–ª–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏

```bash
# –ü–†–ê–í–ò–õ–¨–ù–´–ô –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –í–°–ï–• —Ç–æ—á–µ–∫
curl -s "https://nominatim.openstreetmap.org/lookup?osm_ids=R9274009&format=geojson&polygon_geojson=1" > district_full.geojson

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫
cat district_full.geojson | jq '.features[0].geometry.coordinates[0] | length'
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 640 (–¥–ª—è –í–µ—Ç–µ—Ä–Ω–∏–∫–∞)
```

### 2.2 –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–≤—ã—Ö 5 –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
cat district_full.geojson | jq '.features[0].geometry.coordinates[0][0:5]'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º–∫–Ω—É—Ç–æ—Å—Ç–∏ –ø–æ–ª–∏–≥–æ–Ω–∞ (–ø–µ—Ä–≤–∞—è = –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞)
cat district_full.geojson | jq '.features[0].geometry.coordinates[0] | [.[0], .[-1]]'
```

### 2.3 –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
cat district_full.geojson | jq '.features[0].geometry.coordinates[0][] | select(.[0] < 19 or .[0] > 21 or .[1] < 44 or .[1] > 46)'
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ –¥–ª—è —Ä–∞–π–æ–Ω–æ–≤ –ù–æ–≤–∏-–°–∞–¥–∞
```

---

## üîß –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### 3.1 –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–ª—è JavaScript

```bash
# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è JS
cat district_full.geojson | jq '.features[0].geometry.coordinates[0]' | jq -r '.[] | "        [\(.[0]), \(.[1])],"' > coordinates.txt

# –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø—è—Ç–æ–π
sed -i '$ s/,$//' coordinates.txt
```

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

```javascript
// JavaScript —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞–π–æ–Ω–∞
const district = {
  id: 'veternik',
  name: '–í–µ—Ç–µ—Ä–Ω–∏–∫',
  nameEn: 'Veternik',
  population: '18,849',
  area: '14.2 –∫–º¬≤',
  color: '#3B82F6',
  description: '–ü—Ä–∏–≥–æ—Ä–æ–¥ –∫ –∑–∞–ø–∞–¥—É –æ—Ç –ù–æ–≤–∏-–°–∞–¥–∞ - –ü–û–õ–ù–´–ï –≥—Ä–∞–Ω–∏—Ü—ã OSM relation 9274009 (640/640 —Ç–æ—á–µ–∫)!',
  // –ü–û–õ–ù–´–ï –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª–∏–≥–æ–Ω–∞ –∏–∑ OSM relation ID 9274009 (–í–°–ï 640 —Ç–æ—á–µ–∫)
  coordinates: [
    [19.7358141, 45.2433474],
    [19.7358706, 45.2429397],
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ 638 —Ç–æ—á–µ–∫
    [19.7358141, 45.2433474]  // –ó–∞–º—ã–∫–∞—é—â–∞—è —Ç–æ—á–∫–∞
  ],
  stats: {
    properties: 1850,
    avgPrice: '‚Ç¨85,000',
    growth: '+8.5%'
  }
};
```

---

## üó∫Ô∏è –®–∞–≥ 4: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ

### 4.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Leaflet

```typescript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
const map = L.map('map').setView([45.2671, 19.8335], 12);

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ OpenStreetMap –ø–æ–¥–ª–æ–∂–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap contributors'
}).addTo(map);
```

### 4.2 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–∞

```typescript
// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç OSM [lng, lat] –≤ Leaflet [lat, lng]
const leafletCoords = district.coordinates.map(coord => [coord[1], coord[0]]);

// –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–∞
const polygon = L.polygon(leafletCoords, {
  color: district.color,
  weight: 2,
  opacity: 0.8,
  fillColor: district.color,
  fillOpacity: 0.3,
}).addTo(map);

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
polygon.bindPopup(`
  <div class="p-2">
    <h3 class="font-bold">${district.name}</h3>
    <p class="text-sm">${district.nameEn}</p>
    <p class="text-xs mt-1">${district.description}</p>
    <div class="mt-2 text-xs">
      <div>–ù–∞—Å–µ–ª–µ–Ω–∏–µ: ${district.population}</div>
      <div>–ü–ª–æ—â–∞–¥—å: ${district.area}</div>
    </div>
  </div>
`);
```

### 4.3 –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ

```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏
const validateCoordinates = (coordinates: number[][], districtName: string) => {
  const issues: string[] = [];
  
  coordinates.forEach((coord, index) => {
    const [lng, lat] = coord;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–ª—è –°–µ—Ä–±–∏–∏
    if (lat < 42 || lat > 46.5 || lng < 18 || lng > 23) {
      issues.push(`${districtName}: —Ç–æ—á–∫–∞ ${index} –≤–Ω–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –°–µ—Ä–±–∏–∏`);
    }
  });
  
  return issues;
};
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### ‚ùå –ù–ï –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫:

```bash
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —É–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
jq '.coordinates | to_entries | map(select(.key % 15 == 0)) | map(.value)'
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ—Ç–µ—Ä—è –¥–µ—Ç–∞–ª–µ–π, –∏—Å–∫–∞–∂–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü
```

```javascript
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
const coordinates = [
  [19.73, 45.24],  // –°–ª–∏—à–∫–æ–º –≥—Ä—É–±–æ!
  [19.74, 45.23]
];
```

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

```bash
# –ü–†–ê–í–ò–õ–¨–ù–û - –≤—Å–µ —Ç–æ—á–∫–∏ –±–µ–∑ —É–ø—Ä–æ—â–µ–Ω–∏—è
cat full.geojson | jq '.features[0].geometry.coordinates[0]'
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

### 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ—á–µ–∫
POINTS_COUNT=$(cat district.geojson | jq '.features[0].geometry.coordinates[0] | length')
echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫: $POINTS_COUNT"

# –î–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –æ–∂–∏–¥–∞–µ—Ç—Å—è 200+ —Ç–æ—á–µ–∫
if [ $POINTS_COUNT -lt 50 ]; then
  echo "‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –°–ª–∏—à–∫–æ–º –º–∞–ª–æ —Ç–æ—á–µ–∫ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞"
fi
```

### 2. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º–∫–Ω—É—Ç–æ—Å—Ç–∏ –ø–æ–ª–∏–≥–æ–Ω–∞
FIRST_POINT=$(cat district.geojson | jq '.features[0].geometry.coordinates[0][0]')
LAST_POINT=$(cat district.geojson | jq '.features[0].geometry.coordinates[0][-1]')

if [ "$FIRST_POINT" = "$LAST_POINT" ]; then
  echo "‚úÖ –ü–æ–ª–∏–≥–æ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–º–∫–Ω—É—Ç"
else
  echo "‚ùå –û–®–ò–ë–ö–ê: –ü–æ–ª–∏–≥–æ–Ω –Ω–µ –∑–∞–º–∫–Ω—É—Ç"
fi
```

### 3. –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ
const validateOnRealMap = (polygon: L.Polygon, expectedCenter: [number, number]) => {
  const bounds = polygon.getBounds();
  const center = bounds.getCenter();
  
  const distance = center.distanceTo(L.latLng(expectedCenter));
  
  if (distance > 5000) {  // –ë–æ–ª–µ–µ 5–∫–º –æ—Ç –æ–∂–∏–¥–∞–µ–º–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞
    console.warn('‚ö†Ô∏è –ü–æ–ª–∏–≥–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º');
  } else {
    console.log('‚úÖ –ü–æ–ª–∏–≥–æ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é');
  }
};
```

---

## üõ†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

### –ú–µ—Ç–æ–¥ 1: Nominatim API (–ø—Ä–æ—Å—Ç–æ–π)

#### –°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ Nominatim

```bash
#!/bin/bash
# get_district_polygon.sh

DISTRICT_NAME="$1"
CITY="$2"
COUNTRY="$3"

if [ $# -ne 3 ]; then
  echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <—Ä–∞–π–æ–Ω> <–≥–æ—Ä–æ–¥> <—Å—Ç—Ä–∞–Ω–∞>"
  echo "–ü—Ä–∏–º–µ—Ä: $0 Veternik 'Novi Sad' Serbia"
  exit 1
fi

echo "üîç –ü–æ–∏—Å–∫ —Ä–∞–π–æ–Ω–∞ $DISTRICT_NAME –≤ $CITY, $COUNTRY..."

# 1. –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–∞
SEARCH_RESPONSE=$(curl -s "https://nominatim.openstreetmap.org/search?q=${DISTRICT_NAME},${CITY},${COUNTRY}&format=json&addressdetails=1&limit=10")

# 2. –ü–æ–∏—Å–∫ relation —Å administrative type
RELATION_ID=$(echo "$SEARCH_RESPONSE" | jq -r '.[] | select(.osm_type == "relation" and .type == "administrative") | .osm_id' | head -1)

if [ -z "$RELATION_ID" ]; then
  echo "‚ùå –û–®–ò–ë–ö–ê: –ù–µ –Ω–∞–π–¥–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π relation –¥–ª—è $DISTRICT_NAME"
  exit 1
fi

echo "‚úÖ –ù–∞–π–¥–µ–Ω OSM relation ID: $RELATION_ID"

# 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞
echo "üìç –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏..."
curl -s "https://nominatim.openstreetmap.org/lookup?osm_ids=R${RELATION_ID}&format=geojson&polygon_geojson=1" > "${DISTRICT_NAME,,}_full.geojson"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
POINTS_COUNT=$(cat "${DISTRICT_NAME,,}_full.geojson" | jq '.features[0].geometry.coordinates[0] | length')
echo "üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –≤ –ø–æ–ª–∏–≥–æ–Ω–µ: $POINTS_COUNT"

# 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JavaScript –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
echo "üîß –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è JavaScript..."
cat "${DISTRICT_NAME,,}_full.geojson" | jq -r '.features[0].geometry.coordinates[0][] | "        [\(.[0]), \(.[1])],"' | sed '$ s/,$//' > "${DISTRICT_NAME,,}_coords.txt"

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:"
echo "   - ${DISTRICT_NAME,,}_full.geojson (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)"
echo "   - ${DISTRICT_NAME,,}_coords.txt (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è JS)"
echo ""
echo "üìù –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ${DISTRICT_NAME,,}_coords.txt"
echo "   –≤ –º–∞—Å—Å–∏–≤ coordinates –≤–∞—à–µ–≥–æ JavaScript –æ–±—ä–µ–∫—Ç–∞"
```

### –ú–µ—Ç–æ–¥ 2: Overpass API —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Overpass API:**
- –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –î–æ—Å—Ç—É–ø –∫ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ OSM relations
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π Nominatim

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É multipolygon –¥–∞–Ω–Ω—ã—Ö
- –ù—É–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å ways –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –ë–æ–ª—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

**1. –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø–æ–ª–∏–≥–æ–Ω–æ–≤ (`overpass_polygon_builder.js`):**

–ö–ª–∞—Å—Å `OverpassPolygonBuilder` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç outer ways –∏–∑ OSM relation
- –°–æ–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç—ã ways –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–º–∫–Ω—É—Ç–æ—Å—Ç—å –ø–æ–ª–∏–≥–æ–Ω–∞
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `processOverpassData()` - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `chainWays()` - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö ways –≤ –µ–¥–∏–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω
- `findConnectingWay()` - –ø–æ–∏—Å–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ way –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–∫–æ–Ω–µ—Ü –∫ –Ω–∞—á–∞–ª—É"
- `formatForJavaScript()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è JS –∫–æ–¥–∞

**2. –ü—Ä–æ—Å—Ç–æ–π wrapper (`simple_overpass_polygon.sh`):**

```bash
#!/bin/bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./simple_overpass_polygon.sh <relation_id>

RELATION_ID="$1"

if [[ -z "$RELATION_ID" ]]; then
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <relation_id>"
    echo "–ü—Ä–∏–º–µ—Ä: $0 9274009"
    exit 1
fi

echo "üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–∞ –¥–ª—è OSM relation $RELATION_ID..."

# –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Overpass
OVERPASS_QUERY="[out:json][timeout:60];
relation(id:$RELATION_ID);
out geom;"

curl -s -X POST "https://overpass-api.de/api/interpreter" \
  --data-urlencode "data=$OVERPASS_QUERY" \
  > "/tmp/relation_${RELATION_ID}.json"

echo "üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ –Ω–∞—à —Å–∫—Ä–∏–ø—Ç
node "/tmp/overpass_polygon_builder.js" "/tmp/relation_${RELATION_ID}.json" --debug

# –û—á–∏—Å—Ç–∫–∞
rm -f "/tmp/relation_${RELATION_ID}.json"
```

**3. –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (`get_polygon_overpass.sh`):**

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–π–æ–Ω–∞, –≥–æ—Ä–æ–¥ –∏ —Å—Ç—Ä–∞–Ω—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç OSM relation —á–µ—Ä–µ–∑ Nominatim
- –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Overpass API
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç multipolygon –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞ (JS, JSON, GeoJSON)
- –í–∫–ª—é—á–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –æ—Ç–ª–∞–¥–∫—É

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
./get_polygon_overpass.sh Veternik "Novi Sad" Serbia
./get_polygon_overpass.sh Vo≈ædovac Belgrade Serbia --output vozdovac.txt --debug
./get_polygon_overpass.sh Centar Ni≈° Serbia --format geojson
```

#### –ê–ª–≥–æ—Ä–∏—Ç–º —Å–±–æ—Ä–∫–∏ multipolygon

**–ü—Ä–æ–±–ª–µ–º–∞:** OSM relation —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö ways, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ways:** –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ ways —Å —Ä–æ–ª—å—é "outer"
2. **–ü–æ–∏—Å–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:** –î–ª—è –∫–∞–∂–¥–æ–≥–æ way –Ω–∞—Ö–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–∫–æ–Ω–µ—Ü –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ = –Ω–∞—á–∞–ª–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ"
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤:** –ï—Å–ª–∏ way —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫–æ–Ω—Ü–æ–º –∫ –∫–æ–Ω—Ü—É, —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –µ–≥–æ
4. **–ò–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è:** –ò—Å–∫–ª—é—á–∞–µ–º –ø–µ—Ä–≤—É—é —Ç–æ—á–∫—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ way
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–º–∫–Ω—É—Ç–æ—Å—Ç–∏:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–º—ã–∫–∞–µ–º –ø–æ–ª–∏–≥–æ–Ω –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –í–µ—Ç–µ—Ä–Ω–∏–∫–∞ (relation 9274009):**
- 12 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö ways
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ  
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 640 —Ç–æ—á–µ–∫ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ Nominatim

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

**‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö:**
- –¢–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á—Ç–æ –∏ Nominatim (640 —Ç–æ—á–µ–∫ –¥–ª—è –í–µ—Ç–µ—Ä–Ω–∏–∫–∞)
- –ü–æ–ª–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞–Ω–∏—Ü
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è –±–µ–∑ –∏—Å–∫–∞–∂–µ–Ω–∏–π

**‚úÖ –ì–∏–±–∫–æ—Å—Ç—å:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö multipolygon relations
- –†–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞
- –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

**‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ù–µ –Ω—É–∂–Ω–æ —Ä—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –ì–æ—Ç–æ–≤—ã–π –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ JavaScript

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Nominatim | Overpass+–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è |
|----------|-----------|------------------------|
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| –ì–∏–±–∫–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Nominatim –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤, Overpass+–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏–ª–∏ –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

```bash
# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x get_district_polygon.sh

# –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–∏–≥–æ–Ω –í–µ—Ç–µ—Ä–Ω–∏–∫–∞
./get_district_polygon.sh Veternik "Novi Sad" Serbia

# –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–∏–≥–æ–Ω –í–æ–∂–¥–æ–≤—Ü–∞ –≤ –ë–µ–ª–≥—Ä–∞–¥–µ
./get_district_polygon.sh Vo≈ædovac Belgrade Serbia

# –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–∏–≥–æ–Ω –¶–µ–Ω—Ç—Ä–∞ –≤ –ù–∏—à–µ
./get_district_polygon.sh Centar Ni≈° Serbia
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –î–ª—è –°–µ—Ä–±–∏–∏

```bash
# –ì–µ–æ–¥–µ–∑—Å–∫–∏–π –∑–∞–≤–æ–¥ –°–µ—Ä–±–∏–∏
# https://geosrbija.rs/

# –ü–æ—Ä—Ç–∞–ª –æ—Ç–∫—Ä—ã—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
# https://data.gov.rs/

# ESRI –¥–∞–Ω–Ω—ã–µ –°–µ—Ä–±–∏–∏
curl -s "https://services.arcgis.com/XSeYKQzfXnEgju9o/arcgis/rest/services/Serbia_Administrative_Boundaries/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json"
```

### 2. –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

```bash
# Natural Earth (–º–∞—Å—à—Ç–∞–± 1:10m)
wget https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_1_states_provinces.zip

# HumanData.org geoBoundaries –¥–ª—è –°–µ—Ä–±–∏–∏
curl -s "https://www.geoboundaries.org/api/current/gbOpen/SRB/ADM2/" | jq '.'

# Global Administrative Areas (GADM)
wget https://geodata.ucdavis.edu/gadm/gadm4.1/json/gadm41_SRB_2.json
```

### 3. Overpass API –∑–∞–ø—Ä–æ—Å—ã

```bash
# –í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã —É—Ä–æ–≤–Ω—è 9 –≤ –ù–æ–≤–∏-–°–∞–¥–µ
curl -s -X POST "https://overpass-api.de/api/interpreter" \
  --data-urlencode 'data=[out:json][timeout:60];
(
  relation["admin_level"="9"]["place"~"suburb|neighbourhood"]
    (around:15000,45.2671,19.8335);
);
out geom;'
```

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

### –ë–µ–ª–≥—Ä–∞–¥ - –†–∞–π–æ–Ω—ã

```bash
# –í–æ–∂–¥–æ–≤–∞—Ü
./get_district_polygon.sh Vo≈ædovac Belgrade Serbia

# –ù–æ–≤–∏ –ë–µ–ª–≥—Ä–∞–¥  
./get_district_polygon.sh "Novi Beograd" Belgrade Serbia

# –ó–µ–º—É–Ω
./get_district_polygon.sh Zemun Belgrade Serbia
```

### –ù–∏—à - –†–∞–π–æ–Ω—ã

```bash
# –¶–µ–Ω—Ç–∞—Ä
./get_district_polygon.sh Centar Ni≈° Serbia

# –ü–∞–Ω—Ç–µ–ª–µ—ò
./get_district_polygon.sh Pantelej Ni≈° Serbia
```

### –ö—Ä–∞–≥—É—ò–µ–≤–∞—Ü - –†–∞–π–æ–Ω—ã

```bash
# –°—Ç–∞—Ä–∏ –≥—Ä–∞–¥
./get_district_polygon.sh "Stari grad" Kragujevac Serbia
```

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –∫–∞—á–µ—Å—Ç–≤–∞

### ‚úÖ –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª–∏–≥–æ–Ω–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] **Relation ID –Ω–∞–π–¥–µ–Ω** —á–µ—Ä–µ–∑ systematic –ø–æ–∏—Å–∫
- [ ] **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ > 50** (–¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤)
- [ ] **–ü–æ–ª–∏–≥–æ–Ω –∑–∞–º–∫–Ω—É—Ç** (–ø–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞ = –ø–æ—Å–ª–µ–¥–Ω—è—è)
- [ ] **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ** –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞
- [ ] **–í–∏–∑—É–∞–ª—å–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç** –Ω–∞ OpenStreetMap –ø–æ–¥–ª–æ–∂–∫–µ
- [ ] **–ù–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤** –≤ –≤–∞–∂–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –≥—Ä–∞–Ω–∏—Ü—ã
- [ ] **–¶–µ–Ω—Ç—Ä –ø–æ–ª–∏–≥–æ–Ω–∞** –±–ª–∏–∑–æ–∫ –∫ –æ–∂–∏–¥–∞–µ–º–æ–º—É
- [ ] **–û–ø–∏—Å–∞–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç** –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫

### ‚ùå –ü—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞:

- [ ] –ú–µ–Ω–µ–µ 20 —Ç–æ—á–µ–∫ –¥–ª—è –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ —Ä–∞–π–æ–Ω–∞
- [ ] –ü—Ä—è–º—ã–µ –ª–∏–Ω–∏–∏ –≤–º–µ—Å—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü
- [ ] –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–Ω–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏
- [ ] –ü–æ–ª–∏–≥–æ–Ω –Ω–µ –∑–∞–º–∫–Ω—É—Ç
- [ ] –ë–æ–ª—å—à–∏–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –≥—Ä–∞–Ω–∏—Ü–∞—Ö
- [ ] –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ

---

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ú—É–ª—å—Ç–∏–ø–æ–ª–∏–≥–æ–Ω—ã

```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ —Å –¥—ã—Ä–∞–º–∏
const processMultiPolygon = (geometry: any) => {
  if (geometry.type === 'MultiPolygon') {
    // –ë–µ—Ä–µ–º —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –ø–æ–ª–∏–≥–æ–Ω
    const largestPolygon = geometry.coordinates.reduce(
      (largest: any, current: any) => 
        current[0].length > largest[0].length ? current : largest
    );
    return largestPolygon[0];
  }
  return geometry.coordinates[0];
};
```

### 2. –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

```typescript
// Douglas-Peucker —É–ø—Ä–æ—â–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫)
const simplifyIfNeeded = (coordinates: number[][], tolerance: number = 0.0001) => {
  if (coordinates.length > 1000) {
    // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –±–æ–ª—å—à–µ 1000 —Ç–æ—á–µ–∫ - –ø—Ä–∏–º–µ–Ω—è–µ–º —É–ø—Ä–æ—â–µ–Ω–∏–µ
    return douglasPeucker(coordinates, tolerance);
  }
  return coordinates; // –ò–Ω–∞—á–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ —Ç–æ—á–∫–∏
};
```

### 3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```typescript
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
const polygonCache = new Map<string, number[][]>();

const getCachedPolygon = async (relationId: string): Promise<number[][]> => {
  const cacheKey = `polygon_${relationId}`;
  
  if (polygonCache.has(cacheKey)) {
    return polygonCache.get(cacheKey)!;
  }
  
  const polygon = await fetchPolygonFromOSM(relationId);
  polygonCache.set(cacheKey, polygon);
  
  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∫—ç—à–∞
  localStorage.setItem(cacheKey, JSON.stringify(polygon));
  
  return polygon;
};
```

---

## üîß –û—Ç–ª–∞–¥–∫–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ–ª–∏–≥–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω"

```bash
# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
curl -s "https://nominatim.openstreetmap.org/search?q=Veternik&format=json&limit=20" | jq '.'

# –ü–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–Ω—ã–º —è–∑—ã–∫–∞–º
curl -s "https://nominatim.openstreetmap.org/search?q=–í–µ—Ç–µ—Ä–Ω–∏–∫&format=json&limit=20" | jq '.'
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–°–ª–∏—à–∫–æ–º –º–∞–ª–æ —Ç–æ—á–µ–∫"

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–≥–∏—Ö relations —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞
curl -s "https://nominatim.openstreetmap.org/search?q=Veternik,Novi+Sad&format=json&limit=20" | jq '.[] | select(.osm_type == "relation")'
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ—Ç–æ—á–Ω—ã–µ"

```bash
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
curl -s -X POST "https://overpass-api.de/api/interpreter" \
  --data-urlencode 'data=[out:json][timeout:25];
relation(id:9274009);
out geom;'
```

---

**üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–°–ª–µ–¥—É—è —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω—ã–µ** –ø–æ–ª–∏–≥–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–µ—Ç–∞–ª–µ–π. –ö–ª—é—á –∫ —É—Å–ø–µ—Ö—É - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–≤—Å–µ—Ö —Ç–æ—á–µ–∫** –∏–∑ OSM relations –∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ.

**–ü–æ–º–Ω–∏—Ç–µ**: –õ—É—á—à–µ 640 —Ç–æ—á–µ–∫ —Å –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é, —á–µ–º 40 —Ç–æ—á–µ–∫ —Å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏!