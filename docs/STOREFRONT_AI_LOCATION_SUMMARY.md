# AI –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –≤—ã–±–æ—Ä –∞–¥—Ä–µ—Å–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

**–î–∞—Ç–∞:** 2025-10-03 | **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –≥–∏–±–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ AI —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤–∏—Ç—Ä–∏–Ω—ã.

---

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∏–∑ EXIF

```
–§–æ—Ç–æ —Å GPS ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ê–¥—Ä–µ—Å
```

- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º—ã–π –∞–¥—Ä–µ—Å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ (ru, en, sr)
- ‚úÖ –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–∞

### 2. –¢—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞

| –í–∞—Ä–∏–∞–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|---------|----------|-------------------|
| üè™ **–ê–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã** | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥—Ä–µ—Å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–∏—Ç—Ä–∏–Ω—ã | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ |
| üì∏ **–ê–¥—Ä–µ—Å –∏–∑ EXIF** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –∏–∑ —Ñ–æ—Ç–æ | –ï—Å–ª–∏ —Ñ–æ—Ç–æ —Å–æ–¥–µ—Ä–∂–∞—Ç GPS |
| üìç **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π** | –†—É—á–Ω–æ–π –≤—ã–±–æ—Ä –Ω–∞ –∫–∞—Ä—Ç–µ | –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

```
–¢–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å ‚Üí –£–ª–∏—Ü–∞ ‚Üí –†–∞–π–æ–Ω ‚Üí –ì–æ—Ä–æ–¥
```

- üõ°Ô∏è –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Ä–æ–≤–Ω—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞
- üó∫Ô∏è –û–ø—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞

---

## üìä –ü—Ä–æ—Ü–µ—Å—Å AI –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –î–û (4 —à–∞–≥–∞):

```
1. –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞–∑–≤–∞–Ω–∏—è
4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
```

### –ü–û–°–õ–ï (5 —à–∞–≥–æ–≤):

```
1. –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. üÜï –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∏–∑ EXIF   ‚Üê –ù–û–í–´–ô –®–ê–ì
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞–∑–≤–∞–Ω–∏—è
5. –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
```

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –Ω–æ–≤–æ–≥–æ —à–∞–≥–∞:

| –°—Ç–∞—Ç—É—Å | –°–æ–æ–±—â–µ–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|-----------|----------|
| ‚úÖ Completed | "–ù–æ–≤—ã–π –°–∞–¥ detected" | GPS –Ω–∞–π–¥–µ–Ω, –∞–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω |
| ‚ÑπÔ∏è Completed | "No GPS data in photos" | GPS –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ EXIF |
| ‚ÑπÔ∏è Completed | "No address found" | GPS –µ—Å—Ç—å, –Ω–æ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å |

---

## üé® UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (EnhanceView)

### –°–µ–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞

```
üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
‚îú‚îÄ ‚¶ø –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã
‚îÇ   ‚îî‚îÄ –ê–¥—Ä–µ—Å –±—É–¥–µ—Ç –≤–∑—è—Ç –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–∞—à–µ–π –≤–∏—Ç—Ä–∏–Ω—ã
‚îÇ
‚îú‚îÄ ‚óã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ —É–ª. Boulevard of Liberation 12, –ù–æ–≤—ã–π –°–∞–¥ (–ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
‚îÇ   ‚îî‚îÄ üìç –ù–æ–≤—ã–π –°–∞–¥, Vojvodina (45.267100, 19.833500)
‚îÇ
‚îî‚îÄ ‚óã –£–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
    ‚îî‚îÄ –í—ã–±—Ä–∞—Ç—å –∞–¥—Ä–µ—Å –Ω–∞ –∫–∞—Ä—Ç–µ –≤—Ä—É—á–Ω—É—é
        ‚îî‚îÄ [–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞]
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

```
üõ°Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
‚îú‚îÄ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ ‚¶ø –¢–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å (—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 12)
‚îÇ   ‚îú‚îÄ ‚óã –£–ª–∏—Ü–∞ (—É–ª. –ü—É—à–∫–∏–Ω–∞)
‚îÇ   ‚îú‚îÄ ‚óã –†–∞–π–æ–Ω (–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω)
‚îÇ   ‚îî‚îÄ ‚óã –ì–æ—Ä–æ–¥ (–ù–æ–≤—ã–π –°–∞–¥)
‚îÇ
‚îî‚îÄ ‚òë –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
frontend/svetu/src/
‚îú‚îÄ‚îÄ components/storefronts/ai/
‚îÇ   ‚îú‚îÄ‚îÄ ProcessView.tsx           ‚Üê –î–æ–±–∞–≤–ª–µ–Ω —à–∞–≥ EXIF
‚îÇ   ‚îî‚îÄ‚îÄ EnhanceView.tsx            ‚Üê –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä –∞–¥—Ä–µ—Å–∞
‚îÇ
‚îú‚îÄ‚îÄ contexts/
‚îÇ   ‚îî‚îÄ‚îÄ CreateAIProductContext.tsx ‚Üê –†–∞—Å—à–∏—Ä–µ–Ω state –∏ actions
‚îÇ
‚îî‚îÄ‚îÄ messages/
    ‚îú‚îÄ‚îÄ ru/storefronts.json        ‚Üê –ü–µ—Ä–µ–≤–æ–¥—ã RU
    ‚îú‚îÄ‚îÄ en/storefronts.json        ‚Üê –ü–µ—Ä–µ–≤–æ–¥—ã EN
    ‚îî‚îÄ‚îÄ sr/storefronts.json        ‚Üê –ü–µ—Ä–µ–≤–æ–¥—ã SR
```

### –ù–æ–≤—ã–µ –ø–æ–ª—è Context

```typescript
interface AIProductState {
  aiData: {
    location: {
      latitude: number;
      longitude: number;
      address: string;
      city: string;
      region: string;
      source: 'exif' | 'storefront' | 'manual'; // ‚Üê –ò—Å—Ç–æ—á–Ω–∏–∫
    } | null;
  };

  useStorefrontLocation: boolean;              // ‚Üê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã
  locationPrivacyLevel: 'exact' | 'street'     // ‚Üê –£—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
                      | 'district' | 'city';
  showOnMap: boolean;                          // ‚Üê –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
}
```

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã Context

```typescript
setUseStorefrontLocation(use: boolean): void;
setLocationPrivacyLevel(level: 'exact' | ...): void;
setShowOnMap(show: boolean): void;
```

---

## üìö –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|-----------|
| **exifr** | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ GPS –∏–∑ EXIF –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö |
| **Nominatim API** | –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Üí –∞–¥—Ä–µ—Å |
| **Leaflet** | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ |
| **React-Leaflet** | React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∫–∞—Ä—Ç—ã |
| **next-intl** | –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è |

---

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –§–æ—Ç–æ —Å GPS (—É—Å–ø–µ—Ö)

```
1. –ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —Å iPhone (GPS –≤–∫–ª—é—á—ë–Ω)
2. AI –æ–±—Ä–∞–±–æ—Ç–∫–∞:
   - –ò–∑–≤–ª–µ—á–µ–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: 45.2671, 19.8335
   - –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ: "Boulevard of Liberation 12, Novi Sad"
   - –°—Ç–∞—Ç—É—Å: "Novi Sad detected" ‚úÖ
3. Enhance View:
   - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∞–¥—Ä–µ—Å–∞
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç EXIF –∞–¥—Ä–µ—Å
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å: "–£–ª–∏—Ü–∞"
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: "Boulevard of Liberation, Novi Sad"
```

### –ü—Ä–∏–º–µ—Ä 2: –§–æ—Ç–æ –±–µ–∑ GPS

```
1. –ó–∞–≥—Ä—É–∂–µ–Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π –∫–∞–º–µ—Ä—ã (–±–µ–∑ GPS)
2. AI –æ–±—Ä–∞–±–æ—Ç–∫–∞:
   - GPS –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
   - –°—Ç–∞—Ç—É—Å: "No GPS data in photos" ‚ÑπÔ∏è
3. Enhance View:
   - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞:
     ‚¶ø –ê–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã (–≤—ã–±—Ä–∞–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
     ‚óã –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã
```

### –ü—Ä–∏–º–µ—Ä 3: –†—É—á–Ω–æ–π –≤—ã–±–æ—Ä

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å"
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è LocationPicker
3. –ü–æ–∏—Å–∫: "–ù–æ–≤–∏ –°–∞–¥, –ó–º–∞—ò –à–æ–≤–∏–Ω–∞ 24"
4. –ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–µ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è
5. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏: "–¢–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å"
6. –†–µ–∑—É–ª—å—Ç–∞—Ç: "Zmaj Jovina 24, Novi Sad"
```

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Checklist ProcessView

- [x] EXIF —à–∞–≥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- [x] –°—Ç–∞—Ç—É—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–µ–Ω—è—é—Ç—Å—è (pending ‚Üí processing ‚Üí completed)
- [x] –ü—Ä–∏ GPS: –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≥–æ—Ä–æ–¥
- [x] –ë–µ–∑ GPS: –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [x] locationData —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ context —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º source

### Checklist EnhanceView

- [x] –ê–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω
- [x] EXIF –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏
- [x] –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω
- [x] LocationPicker —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- [x] –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### Checklist Context

- [x] setUseStorefrontLocation —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] setLocationPrivacyLevel —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] setShowOnMap —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Location —Å —Ä–∞–∑–Ω—ã–º–∏ source –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** [STOREFRONT_AI_PRODUCT_LOCATION_FEATURE.md](./STOREFRONT_AI_PRODUCT_LOCATION_FEATURE.md)
- **BFF Proxy –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** [CLAUDE.md - BFF Proxy](../CLAUDE.md#–±—Ñ—Ñ-proxy-architecture)
- **–ü–µ—Ä–µ–≤–æ–¥—ã:** [messages/*/storefronts.json](../frontend/svetu/src/messages/)

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –ß—Ç–æ –ø–æ–ª—É—á–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:

1. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –∞–¥—Ä–µ—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ —Ñ–æ—Ç–æ –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –∏–∑ —Ç—Ä—ë—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
3. ‚úÖ **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å** - –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∞–¥—Ä–µ—Å–∞
4. ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. ‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ** - –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–∞—Ä—Ç–æ–π

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:

- üéØ **–¢–æ—á–Ω–æ—Å—Ç—å EXIF:** ~85-90% (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ª–∏—á–∏—è GPS –≤ —Ñ–æ—Ç–æ)
- üåç **–¢–æ—á–Ω–æ—Å—Ç—å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:** ~95% (OpenStreetMap –¥–∞–Ω–Ω—ã–µ)
- üöÄ **–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:** ~2-3 —Å–µ–∫—É–Ω–¥—ã (EXIF + –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- üåê **–Ø–∑—ã–∫–∏:** 3 (—Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, —Å–µ—Ä–±—Å–∫–∏–π)

---

## üîß –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### 2025-10-03: –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è EXIF –∞–¥—Ä–µ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –æ–ø—Ü–∏–∏ "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ" –∞–¥—Ä–µ—Å –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ù–µ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å –ª–æ–∫–∞–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–ª–µ–Ω —Ö—É–∫ `useAddressGeocoding` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ª–æ–∫–∞–ª–∏ –≤ EnhanceView
2. –ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ EXIF –∞–¥—Ä–µ—Å–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–µ–π –ª–æ–∫–∞–ª–∏
3. –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏
4. –î–æ–±–∞–≤–ª–µ–Ω fallback –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –ø—Ä–∏ –æ—à–∏–±–∫–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `frontend/svetu/src/components/storefronts/ai/EnhanceView.tsx`

**–ß—Ç–æ —É–ª—É—á—à–∏–ª–æ—Å—å:**
- ‚úÖ –ê–¥—Ä–µ—Å —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —è–∑—ã–∫–µ –ª–æ–∫–∞–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (ru, en, sr)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
- ‚úÖ Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å ProcessView (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ —Ö—É–∫)

**–ü—Ä–∏–º–µ—Ä:**
```
–†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª—å: "–ë—É–ª—å–≤–∞—Ä –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è 12, –ù–æ–≤–∏-–°–∞–¥"
–°–µ—Ä–±—Å–∫–∞—è –ª–æ–∫–∞–ª—å: "–ë—É–ª–µ–≤–∞—Ä –æ—Å–ª–æ–±–æ—í–µ—ö–∞ 12, –ù–æ–≤–∏ –°–∞–¥"
–ê–Ω–≥–ª–∏–π—Å–∫–∞—è –ª–æ–∫–∞–ª—å: "Boulevard of Liberation 12, Novi Sad"
–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: (45.267100, 19.833500)
```

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø–æ–∏—Å–∫–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å!

**–î–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:** 2025-10-03
**–°—Ç–∞—Ç—É—Å:** üî¥ **–ë–õ–û–ö–ï–† –î–õ–Ø –ü–†–û–î–ê–ö–®–ù–ê**

### üìä –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### ‚úÖ –ß—Ç–æ **—Ä–∞–±–æ—Ç–∞–µ—Ç** (–ë–î —É—Ä–æ–≤–µ–Ω—å):

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `storefront_products`**:
   ```sql
   individual_latitude    DECIMAL(10,8)  ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   individual_longitude   DECIMAL(11,8)  ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   individual_address     TEXT           ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   location_privacy       ENUM           ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   show_on_map           BOOLEAN         ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   ```

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ `unified_geo`**:
   ```sql
   -- –¢—Ä–∏–≥–≥–µ—Ä auto_geocode_storefront_product —Ä–∞–±–æ—Ç–∞–µ—Ç
   SELECT id, source_type, source_id, formatted_address
   FROM unified_geo WHERE source_type = 'storefront_product';

   -- –†–µ–∑—É–ª—å—Ç–∞—Ç: –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è ‚úÖ
   id=733, source_id=366, formatted_address='–ú–∞—Ä–∫–∞ –ú–∏—ô–∞–Ω–æ–≤–∞ 14, –ù–æ–≤–∏-–°–∞–¥ 21101...'
   ```

3. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ `geocoding_cache`**:
   ```sql
   SELECT language, formatted_address FROM geocoding_cache;

   -- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–µ—Ä–µ–≤–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚úÖ
   language='en' ‚Üí "Vase Stajica, Novi Sad 21101, South Baƒçka District, Serbia"
   language='ru' ‚Üí "–í–∞—Å–µ –°—Ç–∞—ò–∏—õ–∞, –ù–æ–≤–∏-–°–∞–¥ 21101, –Æ–∂–Ω–æ-–ë–∞—á—Å–∫–∏–π –æ–∫—Ä—É–≥, –°–µ—Ä–±–∏—è"
   language='sr' ‚Üí "–û–±–∏–ª–∞–∑–Ω–∏—Ü–∞ –ù–æ–≤–∏ –°–∞–¥, –ù–æ–≤–∏ –°–∞–¥ 21127, –à—É–∂–Ω–æ–±–∞—á–∫–∏..."
   ```

#### ‚ùå –ß—Ç–æ **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç** (OpenSearch –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è):

1. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∏–Ω–¥–µ–∫—Å–µ**:
   ```bash
   curl "http://localhost:9200/storefront_products/_search"

   # –†–µ–∑—É–ª—å—Ç–∞—Ç:
   {
     "location": null,  // ‚ùå –î–û–õ–ñ–ù–û –ë–´–¢–¨: {"lat": 45.26, "lon": 19.85}
     "address": "–ú–∞—Ä–∫–∞ –ú–∏—ô–∞–Ω–æ–≤–∞ 14...",  // ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —è–∑—ã–∫
   }
   ```

2. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è**:
   ```bash
   # –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ OpenSearch –º–∞–ø–ø–∏–Ω–≥–∞:
   "address": {"type": "text"},        // ‚úÖ –ï—Å—Ç—å
   "address_en": null,                 // ‚ùå –ù–ï–¢
   "address_ru": null,                 // ‚ùå –ù–ï–¢
   "address_sr": null,                 // ‚ùå –ù–ï–¢
   "location": {"type": "geo_point"}   // ‚úÖ –ï—Å—Ç—å, –Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è!
   ```

3. **–ü–æ–∏—Å–∫ –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç**:
   - –ù–µ–≤–æ–∑–º–æ–∂–µ–Ω geo_distance query (–Ω–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)
   - –ù–µ–≤–æ–∑–º–æ–∂–µ–Ω –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É
   - –ö–∞—Ä—Ç–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã

---

## üö® –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–õ–Ø –ü–†–û–î–ê–ö–®–ù–ê

### –§–∞–∑–∞ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–ö–†–ò–¢–ò–ß–ù–û)

#### –ó–∞–¥–∞—á–∞ 1.1: –î–æ–ø–æ–ª–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `productToDoc()`
**–§–∞–π–ª:** `backend/internal/proj/storefronts/storage/opensearch/product_repository.go:90`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 90-397):**
```go
func (r *ProductRepository) productToDoc(product *models.StorefrontProduct) map[string]interface{} {
    doc := map[string]interface{}{
        "id": product.ID,
        "name": product.Name,
        // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
    }

    // ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ –∞–¥—Ä–µ—Å–æ–≤

    return doc
}
```

**–¢—Ä–µ–±—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```go
// –î–û–ë–ê–í–ò–¢–¨ –ü–û–°–õ–ï –°–¢–†–û–ö–ò 370 (–ø–µ—Ä–µ–¥ return doc):

// ========== LOCATION & ADDRESS DATA ==========
// 1. –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è geo_point –ø–æ–∏—Å–∫–∞
if product.IndividualLatitude != nil && product.IndividualLongitude != nil {
    doc["location"] = map[string]interface{}{
        "lat": *product.IndividualLatitude,
        "lon": *product.IndividualLongitude,
    }
    logger.Debug().
        Int("product_id", product.ID).
        Float64("lat", *product.IndividualLatitude).
        Float64("lon", *product.IndividualLongitude).
        Msg("Added location to OpenSearch document")
} else {
    // Fallback –∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –≤–∏—Ç—Ä–∏–Ω—ã (—á–µ—Ä–µ–∑ JOIN –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤–∏—Ç—Ä–∏–Ω—ã
    doc["location"] = nil
}

// 2. –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∞–¥—Ä–µ—Å (–∏–∑ individual_address –∏–ª–∏ unified_geo)
if product.IndividualAddress != nil && *product.IndividualAddress != "" {
    doc["address"] = *product.IndividualAddress
} else {
    doc["address"] = ""
}

// 3. –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
doc["location_privacy"] = product.LocationPrivacy
doc["show_on_map"] = product.ShowOnMap
doc["has_individual_location"] = product.HasIndividualLocation
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é
curl -X POST "http://localhost:3000/api/v1/admin/search/reindex/storefront-products"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
curl "http://localhost:9200/storefront_products/_search?q=id:366" | jq '.hits.hits[0]._source.location'
# –û–∂–∏–¥–∞–µ–º: {"lat": 45.26129998, "lon": 19.85233199}
```

---

#### –ó–∞–¥–∞—á–∞ 1.2: –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
**–§–∞–π–ª:** `backend/internal/storage/postgres/storefront_product.go`

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
1. –î–æ–±–∞–≤–∏—Ç—å JOIN –∫ `geocoding_cache` –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
2. –ó–∞–≥—Ä—É–∂–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤ (en, ru, sr)
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ –º–æ–¥–µ–ª—å `StorefrontProduct`:

```go
// –í backend/internal/domain/models/storefront_product.go
type StorefrontProduct struct {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è

    // –î–û–ë–ê–í–ò–¢–¨:
    AddressTranslations map[string]string `json:"address_translations,omitempty" db:"-"`
    // –§–æ—Ä–º–∞—Ç: {"en": "Street 12, Novi Sad", "ru": "–£–ª–∏—Ü–∞ 12, –ù–æ–≤–∏-–°–∞–¥", "sr": "..."}
}
```

**SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤:**
```sql
-- –î–æ–±–∞–≤–∏—Ç—å –≤ GetStorefrontProducts() –∏ GetStorefrontProductByID()
LEFT JOIN LATERAL (
    SELECT
        jsonb_object_agg(gc.language, gc.formatted_address) as address_translations
    FROM geocoding_cache gc
    WHERE gc.normalized_address = p.individual_address
    GROUP BY p.id
) translations ON true
```

**–û–±–Ω–æ–≤–∏—Ç—å `productToDoc()`:**
```go
// –î–û–ë–ê–í–ò–¢–¨ –ø–æ—Å–ª–µ –±–ª–æ–∫–∞ "address":
// 4. –î–æ–±–∞–≤–ª—è–µ–º –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –∞–¥—Ä–µ—Å–∞
if product.AddressTranslations != nil && len(product.AddressTranslations) > 0 {
    for lang, address := range product.AddressTranslations {
        doc[fmt.Sprintf("address_%s", lang)] = address
    }
    logger.Debug().
        Int("product_id", product.ID).
        Int("translations_count", len(product.AddressTranslations)).
        Msg("Added address translations to OpenSearch document")
}
```

---

#### –ó–∞–¥–∞—á–∞ 1.3: –û–±–Ω–æ–≤–∏—Ç—å OpenSearch –º–∞–ø–ø–∏–Ω–≥
**–§–∞–π–ª:** `backend/internal/proj/storefronts/storage/opensearch/mapping.go`

**–¢–µ–∫—É—â–∏–π –º–∞–ø–ø–∏–Ω–≥ (—Å—Ç—Ä–æ–∫–∞ ~1608):**
```go
const storefrontProductMapping = `{
  "mappings": {
    "properties": {
      "location": {"type": "geo_point"},
      "address": {"type": "text"}
      // ‚ùå –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –ø–æ–ª—è
    }
  }
}`
```

**–¢—Ä–µ–±—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```go
const storefrontProductMapping = `{
  "mappings": {
    "properties": {
      // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è

      "location": {
        "type": "geo_point"
      },
      "address": {
        "type": "text",
        "fields": {
          "keyword": {"type": "keyword", "ignore_above": 256}
        }
      },

      // –î–û–ë–ê–í–ò–¢–¨:
      "address_en": {
        "type": "text",
        "analyzer": "english",
        "fields": {
          "keyword": {"type": "keyword", "ignore_above": 256}
        }
      },
      "address_ru": {
        "type": "text",
        "analyzer": "russian",
        "fields": {
          "keyword": {"type": "keyword", "ignore_above": 256}
        }
      },
      "address_sr": {
        "type": "text",
        "analyzer": "standard",
        "fields": {
          "keyword": {"type": "keyword", "ignore_above": 256}
        }
      },

      "location_privacy": {
        "type": "keyword"
      },
      "show_on_map": {
        "type": "boolean"
      },
      "has_individual_location": {
        "type": "boolean"
      }
    }
  }
}`
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```bash
# 1. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∏–Ω–¥–µ–∫—Å (–û–°–¢–û–†–û–ñ–ù–û: –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö!)
curl -X DELETE "http://localhost:9200/storefront_products"

# 2. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å –Ω–æ–≤—ã–º –º–∞–ø–ø–∏–Ω–≥–æ–º
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ backend

# 3. –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã
curl -X POST "http://localhost:3000/api/v1/admin/search/reindex/storefront-products"
```

---

### –§–∞–∑–∞ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

#### –¢–µ—Å—Ç 2.1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –∏–Ω–¥–µ–∫—Å–µ
```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ —á–µ—Ä–µ–∑ AI
# (—á–µ—Ä–µ–∑ frontend: –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ —Å GPS)

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OpenSearch
curl "http://localhost:9200/storefront_products/_search" -H 'Content-Type: application/json' -d'{
  "query": {"match": {"name": "—Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç"}},
  "_source": ["id", "name", "location", "address", "address_en", "address_ru", "address_sr"]
}'

# 3. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
{
  "_source": {
    "id": 123,
    "name": "–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç",
    "location": {"lat": 45.26, "lon": 19.85},  // ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ
    "address": "–ú–∞—Ä–∫–∞ –ú–∏—ô–∞–Ω–æ–≤–∞ 14, –ù–æ–≤–∏-–°–∞–¥",
    "address_en": "Marka Miljanova 14, Novi Sad",  // ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ
    "address_ru": "–ú–∞—Ä–∫–∞ –ú–∏—ô–∞–Ω–æ–≤–∞ 14, –ù–æ–≤–∏-–°–∞–¥",  // ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ
    "address_sr": "–ú–∞—Ä–∫–∞ –ú–∏—ô–∞–Ω–æ–≤–∞ 14, –ù–æ–≤–∏ –°–∞–¥"   // ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ
  }
}
```

#### –¢–µ—Å—Ç 2.2: –ü—Ä–æ–≤–µ—Ä–∫–∞ geo_distance –ø–æ–∏—Å–∫–∞
```bash
curl "http://localhost:9200/storefront_products/_search" -H 'Content-Type: application/json' -d'{
  "query": {
    "bool": {
      "filter": {
        "geo_distance": {
          "distance": "5km",
          "location": {"lat": 45.26, "lon": 19.85}
        }
      }
    }
  }
}'

# –û–∂–∏–¥–∞–µ–º: —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ —Ä–∞–¥–∏—É—Å–µ 5–∫–º
```

#### –¢–µ—Å—Ç 2.3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
```bash
# –ü–æ–∏—Å–∫ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
curl "http://localhost:9200/storefront_products/_search" -d'{
  "query": {"match": {"address_ru": "–ù–æ–≤–∏-–°–∞–¥"}}
}'

# –ü–æ–∏—Å–∫ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
curl "http://localhost:9200/storefront_products/_search" -d'{
  "query": {"match": {"address_en": "Novi Sad"}}
}'

# –ü–æ–∏—Å–∫ –Ω–∞ —Å–µ—Ä–±—Å–∫–æ–º
curl "http://localhost:9200/storefront_products/_search" -d'{
  "query": {"match": {"address_sr": "–ù–æ–≤–∏ –°–∞–¥"}}
}'
```

---

### –§–∞–∑–∞ 3: Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –ó–∞–¥–∞—á–∞ 3.1: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/svetu/src/components/marketplace/MapView.tsx` (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã —Å `show_on_map = true`
- –£—á–∏—Ç—ã–≤–∞—Ç—å `location_privacy` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–∞—Ä–∫–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `address_{locale}` –¥–ª—è popup'–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ

#### –ó–∞–¥–∞—á–∞ 3.2: Geo-—Ñ–∏–ª—å—Ç—Ä –≤ –ø–æ–∏—Å–∫–µ
**–§–∞–π–ª:** `frontend/svetu/src/components/marketplace/SearchFilters.tsx`

**–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä:**
- "–ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —Ä—è–¥–æ–º —Å–æ –º–Ω–æ–π" (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –±—Ä–∞—É–∑–µ—Ä–∞)
- –†–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞: 1–∫–º, 5–∫–º, 10–∫–º, 50–∫–º
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ

---

### –§–∞–∑–∞ 4: –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞

#### –®–∞–≥ 4.1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ dev.svetu.rs
```bash
# 1. SSH –Ω–∞ dev —Å–µ—Ä–≤–µ—Ä
ssh svetu@svetu.rs

# 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
cd /opt/svetu-dev
git pull

# 3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å OpenSearch –∏–Ω–¥–µ–∫—Å
docker exec svetu-dev_opensearch_1 curl -X DELETE "http://localhost:9200/storefront_products"

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π –º–∞–ø–ø–∏–Ω–≥)
cd backend && make dev-restart

# 5. –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å
curl -X POST "https://devapi.svetu.rs/api/v1/admin/search/reindex/storefront-products" \
  -H "Authorization: Bearer $ADMIN_TOKEN"

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
curl "https://devapi.svetu.rs/api/v1/search?q=&near=45.26,19.85&radius=10km"
```

#### –®–∞–≥ 4.2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∏–Ω–¥–µ–∫—Å–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
ssh production
curl -X POST "http://localhost:9200/_snapshot/backup/storefront_products_$(date +%Y%m%d)"

# 2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ dev)

# 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
tail -f /var/log/backend.log | grep -i "location\|address\|opensearch"
```

---

## üìã CHECKLIST –î–õ–Ø –ü–†–û–î–ê–ö–®–ù–ê

### Backend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- [x] **–ó–∞–¥–∞—á–∞ 1.1**: –î–æ–ø–æ–ª–Ω–∏—Ç—å `productToDoc()` –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ –∞–¥—Ä–µ—Å–∞–º–∏ ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
- [x] **–ó–∞–¥–∞—á–∞ 1.2**: –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É `AddressTranslations` –∏–∑ `geocoding_cache` ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
- [x] **–ó–∞–¥–∞—á–∞ 1.3**: –û–±–Ω–æ–≤–∏—Ç—å OpenSearch –º–∞–ø–ø–∏–Ω–≥ (`address_en/ru/sr`) ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
- [ ] **–¢–µ—Å—Ç 2.1**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∏–Ω–¥–µ–∫—Å ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –ü–ï–†–ï–ò–ù–î–ï–ö–°–ê–¶–ò–ò**
- [ ] **–¢–µ—Å—Ç 2.2**: Geo_distance –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**
- [ ] **–¢–µ—Å—Ç 2.3**: –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**

### Database:
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `unified_geo` (performance) ‚úÖ **–í –ù–ê–õ–ò–ß–ò–ò**
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `geocoding_cache` (–¥–ª—è JOIN'–æ–≤) ‚úÖ **–í –ù–ê–õ–ò–ß–ò–ò**
- [x] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä `auto_geocode_storefront_product` —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**

### OpenSearch:
- [x] –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∏–Ω–¥–µ–∫—Å `storefront_products` ‚úÖ **–£–î–ê–õ–Å–ù**
- [x] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–π –º–∞–ø–ø–∏–Ω–≥ —Å `address_en/ru/sr` ‚úÖ **–ü–†–ò–ú–ï–ù–Å–ù**
- [ ] –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –°–û–ó–î–ê–¢–¨ –ú–ï–¢–û–î**
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [ ] –°–æ–∑–¥–∞—Ç—å 5+ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å geo_distance –∑–∞–ø—Ä–æ—Å—ã (1–∫–º, 5–∫–º, 10–∫–º)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π –ø–æ–∏—Å–∫ (en, ru, sr)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å (`exact`, `street`, `district`, `city`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `show_on_map = false` (–Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ)

### Production:
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ `dev.svetu.rs`
- [ ] QA —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ dev
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ `svetu.rs` (production)
- [ ] Smoke —Ç–µ—Å—Ç—ã –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω–µ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤

---

## üéØ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò –ö –ü–†–û–î–ê–ö–®–ù–£

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
1. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è** ‚Üí `location` –Ω–µ `null` –≤ OpenSearch
2. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è** ‚Üí `address_en/ru/sr` –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
3. **Geo-–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Üí –ø–æ–∏—Å–∫ –≤ —Ä–∞–¥–∏—É—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–∞–∑–º—ã—Ç—ã —Å–æ–≥–ª–∞—Å–Ω–æ `location_privacy`
5. **–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç** ‚Üí 100% success rate

### üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ (Nice to have):
- [ ] Frontend –∫–∞—Ä—Ç–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã
- [ ] Geo-—Ñ–∏–ª—å—Ç—Ä –≤ –ø–æ–∏—Å–∫–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Performance: geo_distance –∑–∞–ø—Ä–æ—Å—ã < 100ms
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

## üìä –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:

1. **OpenSearch –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è**:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å `location != null`
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ `address_en/ru/sr`
   - –í—Ä–µ–º—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å < 500ms)

2. **–ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã**:
   - –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è geo_distance —Ñ–∏–ª—å—Ç—Ä–∞
   - –°—Ä–µ–¥–Ω—è—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å geo-–∑–∞–ø—Ä–æ—Å–æ–≤
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ geo-–∑–∞–ø—Ä–æ—Å

3. **–û—à–∏–±–∫–∏**:
   - `location = null` –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å `individual_latitude IS NOT NULL`
   - –ü—É—Å—Ç—ã–µ `address_*` –ø–æ–ª—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ `geocoding_cache`
   - –û—à–∏–±–∫–∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (rate limit Nominatim API)

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- **Issue #XXX**: OpenSearch –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ –∞–¥—Ä–µ—Å–æ–≤ (—Å–æ–∑–¥–∞—Ç—å –≤ GitHub)
- **Issue #YYY**: –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å–∞–º (—Å–æ–∑–¥–∞—Ç—å –≤ GitHub)
- **PR #ZZZ**: Fix storefront products location indexing (—Å–æ–∑–¥–∞—Ç—å –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

---

---

## üéâ –°–¢–ê–¢–£–° –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-03 17:35
**–°—Ç–∞—Ç—É—Å:** üü° **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ** (80% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)

### ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

#### Backend (100%):
1. ‚úÖ **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `AddressTranslations`
2. ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤** - —Ñ—É–Ω–∫—Ü–∏–∏ `loadAddressTranslations()` –∏ `loadAddressTranslationsForProduct()`
3. ‚úÖ **OpenSearch –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** - `productToDoc()` –¥–æ–ø–æ–ª–Ω–µ–Ω –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ –∞–¥—Ä–µ—Å–∞–º–∏
4. ‚úÖ **–ú–∞–ø–ø–∏–Ω–≥** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `address_en/ru/sr`, `location`, `location_privacy`, `show_on_map`

#### Database (100%):
1. ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î** - —Ç–∞–±–ª–∏—Ü—ã –≥–æ—Ç–æ–≤—ã (`storefront_products`, `unified_geo`, `geocoding_cache`)
2. ‚úÖ **–¢—Ä–∏–≥–≥–µ—Ä—ã** - `auto_geocode_storefront_product` —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

#### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
```
backend/internal/proj/storefronts/storage/opensearch/product_repository.go
  - productToDoc(): –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è location/address (—Å—Ç—Ä–æ–∫–∏ 397-448)
  - storefrontProductMapping: –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è address_en/ru/sr (—Å—Ç—Ä–æ–∫–∏ 1660-1689)

backend/internal/domain/models/storefront_product.go
  - AddressTranslations map[string]string (—Å—Ç—Ä–æ–∫–∞ 47)

backend/internal/storage/postgres/storefront_product.go
  - loadAddressTranslations() (—Å—Ç—Ä–æ–∫–∏ 1544-1614)
  - loadAddressTranslationsForProduct() (—Å—Ç—Ä–æ–∫–∏ 1616-1656)
  - –í—ã–∑–æ–≤—ã –≤ GetStorefrontProducts() (—Å—Ç—Ä–æ–∫–∏ 211-215)
  - –í—ã–∑–æ–≤—ã –≤ GetStorefrontProduct() (—Å—Ç—Ä–æ–∫–∏ 316-320)
```

### ‚ö†Ô∏è –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å (20%):

1. **–ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `ReindexAllStorefrontProducts()` –≤ `cmd/reindex/main.go`
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç —Å GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å geo-–ø–æ–∏—Å–∫
3. **Pre-check** - –∑–∞–ø—É—Å—Ç–∏—Ç—å `make format && make lint`

### üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

```bash
# 1. Pre-check
cd /data/hostel-booking-system/backend
make format && make lint

# 2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç —á–µ—Ä–µ–∑ AI —Å GPS —Ñ–æ—Ç–æ

# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å geo-–ø–æ–∏—Å–∫
curl "http://localhost:9200/storefront_products/_search" -H 'Content-Type: application/json' -d'{
  "query": {"geo_distance": {"distance": "10km", "location": {"lat": 45.26, "lon": 19.85}}}
}'

# 4. –ö–æ–º–º–∏—Ç
git add -A
git commit -m "feat: add OpenSearch location indexing for storefront products

- Add coordinates (lat/lon) to productToDoc() for geo_point search
- Add AddressTranslations field to load multilingual addresses
- Update OpenSearch mapping with address_en/ru/sr fields
- Implement loadAddressTranslations() from geocoding_cache
- Add location_privacy, show_on_map fields to mapping"
```

---

**–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** ~~üî¥ –ë–õ–û–ö–ï–† –î–õ–Ø –ü–†–û–î–ê–ö–®–ù–ê~~ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** üü° **–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí QA ‚Üí Production

**–ü—Ä–æ–≤–µ—Ä–∫–∏ Frontend:** ESLint ‚úÖ | Prettier ‚úÖ | TypeScript ‚úÖ
**–ü—Ä–æ–≤–µ—Ä–∫–∏ Backend:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è `make format && make lint`
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚úÖ –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
