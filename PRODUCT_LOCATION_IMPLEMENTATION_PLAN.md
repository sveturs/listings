# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∞–¥—Ä–µ—Å–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤

## ‚úÖ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–û–ë–ù–û–í–õ–ï–ù–û)

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–í –ë–î —É–∂–µ –µ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤:
- –¢–∞–±–ª–∏—Ü–∞ `storefronts`: 
  - `geo_strategy` - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (storefront_location)
  - `latitude`, `longitude` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–∏—Ç—Ä–∏–Ω—ã
  - `default_privacy_level` - —É—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  
- –¢–∞–±–ª–∏—Ü–∞ `storefront_products`:
  - `has_individual_location` - —Ñ–ª–∞–≥ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞
  - `individual_address` - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å —Ç–æ–≤–∞—Ä–∞
  - `individual_latitude`, `individual_longitude` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ–≤–∞—Ä–∞
  - `location_privacy` - —É—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–∞ —Ç–æ–≤–∞—Ä–∞
  - `show_on_map` - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –Ω–∞ –∫–∞—Ä—Ç–µ

### Frontend
- ‚úÖ –ï—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `LocationPicker` –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞
- ‚úÖ –ï—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `LocationPrivacySettings` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù** —à–∞–≥ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —à–∞–≥ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –≤ ProductWizard

#### 1.1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç CreateProductContext
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `ProductState` –ø–æ–ª—è –¥–ª—è –∞–¥—Ä–µ—Å–∞:
  ```typescript
  location: {
    useStorefrontLocation: boolean;
    individualAddress?: string;
    latitude?: number;
    longitude?: number;
    city?: string;
    region?: string;
    country?: string;
    privacyLevel?: 'exact' | 'street' | 'district' | 'city';
    showOnMap?: boolean;
  }
  ```
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã actions –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

#### 1.2. ‚úÖ –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç LocationStep
–ü—É—Ç—å: `/frontend/svetu/src/components/products/steps/LocationStep.tsx`

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç:
1. ‚úÖ –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∞–¥—Ä–µ—Å–∞:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –£–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å —Ç–æ–≤–∞—Ä–∞
   
2. ‚úÖ –î–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞:
   - LocationPicker –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞
   - LocationPrivacySettings –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
   - –û–ø—Ü–∏—è "–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ"

3. ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

#### 1.3. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —à–∞–≥ –≤ ProductWizard
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —à–∞–≥ –ø–æ—Å–ª–µ BasicInfoStep
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –º–∞—Å—Å–∏–≤ STEPS
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã API —Ç–∏–ø—ã
- ‚úÖ Backend –º–æ–¥–µ–ª—å `StorefrontProduct` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è
- ‚úÖ API –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏

### 3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω PreviewStep
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –∞–¥—Ä–µ—Å–∞
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ **–ê–¥—Ä–µ—Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è —Å —É—á–µ—Ç–æ–º —É—Ä–æ–≤–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏**

### 4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ
- ‚úÖ –¢–æ–≤–∞—Ä—ã —Å `has_individual_location = true` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ —Å–≤–æ–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
- ‚úÖ –¢–æ–≤–∞—Ä—ã —Å `has_individual_location = false` –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É –≤–∏—Ç—Ä–∏–Ω—ã
- ‚úÖ **–í—Å–µ –ø–æ–ø–∞–ø—ã –∫–∞—Ä—Ç—ã —É—á–∏—Ç—ã–≤–∞—é—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∞–¥—Ä–µ—Å–æ–≤**

## üÜï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∞–¥—Ä–µ—Å–æ–≤
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `formatAddressWithPrivacy` –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤
2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞—Ä—Ç—ã:
   - `ClusterHoverPopup` - –ø–æ–ø–∞–ø –∫–ª–∞—Å—Ç–µ—Ä–∞
   - `MarkerHoverPopup` - –ø–æ–ø–∞–ø –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
   - `MarkerClickPopup` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–æ–ø–∞–ø
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö:
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞ –≤–∏—Ç—Ä–∏–Ω—ã
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ marketplace
4. ‚úÖ Backend (storefronts) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `processProductLocationPrivacy`

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. **–í—ã–±–æ—Ä –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –º–µ–∂–¥—É –∞–¥—Ä–µ—Å–æ–º –≤–∏—Ç—Ä–∏–Ω—ã –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏** - –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —É—Ä–æ–≤–Ω–∏: exact, approximate, city_only, hidden
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏** - –∞–¥—Ä–µ—Å–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞—Ä—Ç–æ–π** - —Ç–æ–≤–∞—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ —Å–≤–æ–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (22.07.2025):
1. **GIS API** - —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `privacy_level` –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ –≤–∏—Ç—Ä–∏–Ω (–±–µ—Ä–µ—Ç—Å—è –∏–∑ `storefronts.default_privacy_level`)
2. **Backend —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–æ–±–∞–≤–ª–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –≤ GIS —Å–µ—Ä–≤–∏—Å–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `utils.FormatAddressWithPrivacy`
3. **Frontend –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `MarkerHoverPopup` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–ª–µ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

### ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **MarketplaceListing** - –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `location_privacy` –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π marketplace
2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏** - –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –≤–æ –≤—Å–µ—Ö API endpoints

### üìã –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏:
- **exact** - –ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **approximate/street** - –∞–¥—Ä–µ—Å –±–µ–∑ –Ω–æ–º–µ—Ä–∞ –¥–æ–º–∞
- **district** - —Ç–æ–ª—å–∫–æ —Ä–∞–π–æ–Ω –∏ –≥–æ—Ä–æ–¥  
- **city_only/city** - —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
- **hidden** - "–ê–¥—Ä–µ—Å —Å–∫—Ä—ã—Ç"

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ (–∞–¥—Ä–µ—Å –≤–∏—Ç—Ä–∏–Ω—ã):
```json
{
  "has_individual_location": false,
  "show_on_map": true
}
```

### –î–ª—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å):
```json
{
  "has_individual_location": true,
  "individual_address": "–ú–∏—Å –ò—Ä–±–∏—ò–µ–≤–µ 58, –ë–µ–ª–≥—Ä–∞–¥ 11050, –°–µ—Ä–±–∏—è",
  "individual_latitude": 44.8125,
  "individual_longitude": 20.4612,
  "location_privacy": "approximate",
  "show_on_map": true
}
```