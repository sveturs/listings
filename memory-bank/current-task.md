# Текущая задача: Массовое управление товарами и проблема безопасности изображений

## Статус: Активна
## Дата начала: 2025-06-22

### История задач:

#### Предыдущая задача: Улучшение функционала витрин (Завершена)
- ✅ Создана таблица для хранения реальной аналитики (storefront_analytics)
- ✅ Создана таблица для событий (storefront_events)
- ✅ Реализован API endpoint для получения аналитики витрины
- ✅ Реализован сервис сбора событий аналитики
- ✅ Создан хук useAnalytics для отслеживания событий на frontend
- ✅ Обновлен дашборд для отображения реальных данных
- ✅ Добавлено отслеживание просмотров страниц витрины
- ✅ Создан background job для агрегации аналитики

#### Предыдущая задача: Исправление импорта товаров (Завершена)
- ✅ Исправлены селекторы Redux (storefronts вместо listings)
- ✅ Добавлена авторизация в запросы (Bearer token)
- ✅ Создан роут на основе slug витрины
- ✅ Исправлен парсинг XML файлов (images теперь массив)
- ✅ Успешно протестирован импорт товаров (ID: 19, 20)

### Текущие задачи:

#### 1. Массовое управление товарами (В процессе)
- ✅ Исправлена ошибка загрузки изображений с Unsplash
- ✅ Исправлена проблема с async params в Next.js 13+
- ✅ Реализован UI для массового выбора товаров (чекбоксы)
- ✅ Создан компонент BulkActions для массовых операций
- ✅ Добавлены переводы для массовых операций
- ✅ Начата реализация backend endpoints для bulk операций
- ✅ Закоммичены все изменения
- ✅ Синхронизирована ветка с main (Fast-forward merge)

#### 2. Критическая проблема безопасности (Требует решения)
**Проблема**: Система хранит только URL изображений из XML файлов. Это создает уязвимость - изображения могут быть подменены на источнике после модерации.

**Решение**: Необходимо реализовать загрузку изображений в MinIO при импорте товаров.

### План действий:
1. [ ] Завершить реализацию backend для массовых операций
2. [ ] Протестировать функционал массового управления
3. [ ] Реализовать загрузку изображений в MinIO при импорте
4. [ ] Добавить прогресс-бар для массовых операций
5. [ ] Добавить фильтрацию по атрибутам товаров

### Примечания:
- Ветка feature/improve-product-attributes-selection опережает origin на 3 коммита
- Все изменения успешно синхронизированы с main
- Backend работает на порту 3000, frontend на порту 3001