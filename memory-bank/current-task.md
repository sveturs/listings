# –¢–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫ –ø–æ–∏—Å–∫–∞

## üìã –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ—Å—Å–∏–∏:
1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ**
   - –ü–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∏—Å–∫–∞ —Å `search_logs` –Ω–∞ `user_behavior_events`
   - –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –∫–æ–¥
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è 000097
   - –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å API

### üéØ –¢–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞:
**–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ–∏—Å–∫–∞**

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ—Ç–æ–¥ `UpdateSearchMetrics` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `search_behavior_metrics` –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É (cron job –∏–ª–∏ background worker) –¥–ª—è –≤—ã–∑–æ–≤–∞ `UpdateSearchMetrics` –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### API endpoints:
- `GET /api/v1/analytics/metrics/search` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ–∏—Å–∫–∞
- `POST /api/v1/analytics/metrics/update` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (–∞–¥–º–∏–Ω—Å–∫–∏–π)

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `backend/internal/proj/behavior_tracking/storage/postgres/repository.go` - UpdateSearchMetrics
- `backend/internal/proj/behavior_tracking/handler/handler.go` - UpdateMetrics handler
- `backend/internal/proj/behavior_tracking/service/service.go` - —Å–µ—Ä–≤–∏—Å

### –¢–∞–±–ª–∏—Ü—ã:
- `user_behavior_events` - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
- `search_behavior_metrics` - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

## üí° –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **Cron job** (–≤–Ω–µ—à–Ω–∏–π)
2. **Background worker** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
3. **Scheduler** –≤ Go (–Ω–∞–ø—Ä–∏–º–µ—Ä, gocron)
4. **Trigger** –≤ PostgreSQL

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- –°–æ–±—ã—Ç–∏—è –ø–æ–∏—Å–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `user_behavior_events`
- API —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Å–æ–±—ã—Ç–∏–π
- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é