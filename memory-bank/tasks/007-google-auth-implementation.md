# Задача 007: Реализация авторизации через Google OAuth

## Задача
Изучить бэкенд касательно авторизации и создать во фронтенде необходимый функционал для авторизации.

## Анализ бэкенда
Система авторизации бэкенда использует:
- OAuth 2.0 через Google
- Сессионная аутентификация с HTTP-only cookies
- Нет традиционной регистрации через email/пароль
- Основные эндпоинты:
  - `/auth/session` - проверка текущей сессии
  - `/auth/google` - инициация OAuth процесса
  - `/auth/google/callback` - callback от Google
  - `/auth/logout` - выход из системы

## Реализованный функционал

### 1. Типы TypeScript (`src/types/auth.ts`)
- `User` - интерфейс пользователя
- `SessionResponse` - ответ от сервера о сессии
- `UserProfile` - профиль пользователя с расширенными данными
- Типы для запросов обновления профиля

### 2. Сервис авторизации (`src/services/auth.ts`)
- `AuthService` класс с методами:
  - `getSession()` - получение текущей сессии
  - `logout()` - выход из системы
  - `loginWithGoogle()` - редирект на Google OAuth
  - `getProfile()` - получение профиля пользователя
  - `updateProfile()` - обновление профиля

### 3. React Context (`src/contexts/AuthContext.tsx`)
- Глобальное управление состоянием авторизации
- Hook `useAuth()` для доступа к данным пользователя
- Автоматическая проверка сессии при загрузке

### 4. Компонент AuthButton (`src/components/AuthButton.tsx`)
- Кнопка "Sign in with Google" для неавторизованных
- Аватар и dropdown меню для авторизованных пользователей
- Использует next/image для оптимизации изображений

### 5. Страницы
- `/profile` - страница профиля пользователя
- `/admin` - админ-панель (доступна только админам)

### 6. Интернационализация
- Добавлены переводы для всех текстов авторизации на EN и RU

### 7. Конфигурация
- Добавлены домены Google (*.googleusercontent.com) в разрешенные для next/image

## Исправленные проблемы
1. Проблема с редиректом после OAuth (порт 3001 → 3999)
2. Ошибки ESLint и форматирования
3. Проблема с отображением аватаров из Google

## Результат
Полнофункциональная система авторизации через Google OAuth интегрирована в Next.js фронтенд.

## Дата выполнения
30.05.2025