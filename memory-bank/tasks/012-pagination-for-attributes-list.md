# Task 012: Пагинация для списков атрибутов

## Статус: ✅ Завершено

## Описание задачи
Реализовать пагинацию для списков атрибутов в админ-панели согласно рекомендации из code review.

## Выполненная работа

### 1. Backend API
- ✅ Добавлена модель `PaginatedResponse` в `/backend/internal/domain/models/models.go`
- ✅ Обновлен handler `GetAttributes` для поддержки параметров:
  - `page` - номер страницы (по умолчанию 1)
  - `page_size` - размер страницы (по умолчанию 20, максимум 100)
  - `search` - поиск по имени и отображаемому названию
  - `type` - фильтрация по типу атрибута
- ✅ Реализован SQL запрос с динамическим построением WHERE условий
- ✅ Добавлены LIMIT/OFFSET для пагинации
- ✅ Подсчет общего количества записей для расчета страниц

### 2. Frontend
- ✅ Добавлен интерфейс `PaginatedResponse<T>` в `/frontend/svetu/src/services/admin.ts`
- ✅ Обновлен метод `adminApi.attributes.getAll()` для передачи параметров пагинации
- ✅ Добавлено состояние пагинации в компонент страницы атрибутов:
  - `currentPage` - текущая страница
  - `totalPages` - общее количество страниц
  - `totalItems` - общее количество элементов
  - `pageSize` - размер страницы (20)
- ✅ Реализован UI пагинации с использованием DaisyUI компонентов
- ✅ Добавлены переводы для текста пагинации

### 3. Улучшения UX
- ✅ Реализован debounce для поиска (500мс)
- ✅ Сохранение и восстановление фокуса при обновлении данных
- ✅ Сохранение позиции курсора в поле ввода
- ✅ Автоматический сброс на первую страницу при изменении фильтров

### 4. Исправленные проблемы
- ✅ Поиск и фильтрация теперь работают по всем данным на сервере, а не только по текущей странице
- ✅ Фокус больше не теряется при вводе текста в поле поиска
- ✅ Обеспечена обратная совместимость с API

## Технические детали

### SQL запрос с фильтрацией
```sql
SELECT COUNT(*) FROM category_attributes WHERE ...
SELECT id, name, display_name, ... FROM category_attributes 
WHERE ... 
ORDER BY sort_order, id 
LIMIT $n OFFSET $m
```

### Использование debounce
```typescript
const debouncedSearchTerm = useDebounce(searchTerm, 500);
```

### Восстановление фокуса
```typescript
requestAnimationFrame(() => {
  if (isSearchFocused && searchInputRef.current) {
    searchInputRef.current.focus();
    searchInputRef.current.setSelectionRange(cursorPosition, cursorPosition);
  }
});
```

## Результат
Пагинация успешно реализована и протестирована. Список атрибутов теперь отображает по 20 элементов на странице с возможностью навигации, поиска и фильтрации.