# Задача 022: Реализация витрин (storefronts) - Фаза 1

## Статус: В процессе

### Выполнено:
1. ✅ Изучена существующая структура backend
   - Найдена старая реализация витрин в `internal/domain/models/storefront.go`
   - Обнаружены несоответствия между старой и новой структурой
   - Определены паттерны проекта для моделей, репозиториев и сервисов

2. ✅ Проанализирован рудиментарный код
   - Старая таблица: `user_storefronts` 
   - Новая таблица: `storefronts` (с расширенной структурой)
   - Можно переиспользовать: логику импорта, обработку изображений, генерацию slug

3. ✅ Найдена команда для миграций
   - Сборка: `make build_migrator`
   - Применение: `make migrate_up`

4. ✅ Применена миграция 20250618_create_storefronts_tables.sql
   - Создано 6 таблиц: storefronts, storefront_staff, storefront_hours, storefront_payment_methods, storefront_delivery_options, storefront_analytics
   - Добавлена поддержка геолокации (latitude, longitude)
   - Подготовлена структура для killer features

### Важные открытия:

1. **Картографический сервис отсутствует**
   - В проекте нет существующей интеграции с картами
   - Нужно выбрать библиотеку (Leaflet, Mapbox, Google Maps)
   - Требуется создать полноценный картографический функционал

2. **Геолокация уже в миграции**
   - Поля latitude/longitude добавлены в таблицу storefronts
   - Поддержка зон доставки в storefront_delivery_options
   - Не требуется PostGIS для базового функционала

3. **Стратегия миграции данных**
   - Рекомендуется создать новую реализацию параллельно
   - Постепенная миграция данных из старых таблиц
   - Сохранение обратной совместимости на переходный период

### Следующие шаги:
1. Создать Go модели для новой структуры витрин
2. Определить стратегию миграции старых данных
3. Выбрать картографическую библиотеку для frontend

### Примечания:
- Миграция содержит все необходимые поля для картографического сервиса
- Структура готова для интеграции с локальными службами доставки (Pošta Srbije)
- Поддержка локальных платежных систем (Poštanska štedionica)