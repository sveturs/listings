# План получения реальных административных границ районов Сербии

## Текущее состояние
- Создан работающий скрипт для обработки GeoJSON файлов
- Протестировано обновление на примере района Земун
- Нужны реальные геоданные для всех районов

## Рекомендуемые источники данных

### 1. OpenStreetMap Overpass API
```python
# Пример запроса для получения районов Белграда
overpass_query = """
[out:json][timeout:25];
area["name"="Београд"]->.searchArea;
(
  relation["boundary"="administrative"]["admin_level"="10"](area.searchArea);
);
out body;
>;
out skel qt;
"""
```

### 2. Официальные источники Сербии
- **Републички геодетски завод**: https://www.rgz.gov.rs/
- **GeoSrbija**: https://geosrbija.rs/
- **OpenData портал**: https://data.gov.rs/

### 3. GitHub репозитории
- https://github.com/osm-rs/osm-serbia - неофициальные экстракты OSM для Сербии
- https://github.com/mapsforge/mapsforge - содержит векторные карты региона

### 4. GADM данные
- https://gadm.org/download_country.html
- Выбрать Serbia, формат GeoJSON или Shapefile
- Содержит административные границы уровней 0-3

## Рекомендуемый подход

### Шаг 1: Загрузка данных OSM
1. Использовать Overpass API для каждого города
2. Фильтровать по admin_level=9 или 10 для городских районов
3. Сохранить в отдельные GeoJSON файлы

### Шаг 2: Валидация и упрощение
1. Проверить валидность полигонов
2. Упростить сложные границы (ST_SimplifyPreserveTopology)
3. Убедиться, что центральные точки содержатся в границах

### Шаг 3: Обновление центральных точек
```sql
-- Обновить центры после изменения границ
UPDATE districts 
SET center_point = ST_Centroid(boundary)
WHERE boundary IS NOT NULL;
```

### Шаг 4: Поэтапное внедрение
1. Начать с Белграда (17 районов)
2. Затем Нови Сад (16 районов)
3. Остальные города по убыванию размера

## Альтернативный подход - ручная оцифровка

Если официальные данные недоступны:
1. Использовать QGIS для ручной оцифровки границ
2. Базовые карты: OSM, Google Maps, Yandex
3. Экспорт в GeoJSON

## Скрипт для автоматизации

```bash
# Загрузка данных для всех городов
python3 fetch_osm_boundaries.py --cities "Београд,Нови Сад,Ниш,Крагујевац"

# Обработка и генерация SQL
python3 process_all_boundaries.py --input geodata/ --output migrations/

# Применение миграций
./migrator migrate
```

## Контроль качества

1. Визуальная проверка на карте
2. Проверка площадей районов (реалистичные значения)
3. Проверка соседства районов (отсутствие пересечений)
4. Тестирование поиска по районам

## Временные решения

Пока нет реальных данных:
1. Использовать увеличенные прямоугольники (текущее решение)
2. Создать приблизительные полигоны вручную для ключевых районов
3. Постепенно заменять на реальные данные по мере их получения