# üìã –°–µ—Å—Å–∏—è: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

**–î–∞—Ç–∞**: 2025-01-07, 00:30 CEST  
**–°—Ç–∞—Ç—É—Å**: –í –ø—Ä–æ—Ü–µ—Å—Å–µ  
**–í–µ—Ç–∫–∞**: `feature/phase3-behavioral-optimization`  
**–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å–µ—Å—Å–∏—è**: –¢–æ—Ç–∞–ª—å–Ω–∞—è QA –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚úÖ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üéØ –¶–ï–õ–¨ –°–ï–°–°–ò–ò

–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤–µ—Å—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥, –≤—ã—è–≤–ª–µ–Ω–Ω—ã–π –≤ —Ö–æ–¥–µ —Ç–æ—Ç–∞–ª—å–Ω–æ–π QA –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–µ–π –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –§–∞–∑–µ 3.

## üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ QA –ü–†–û–í–ï–†–ö–ò

### ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (95%):
- Backend –∫–æ–º–ø–∏–ª—è—Ü–∏—è ‚úÖ 
- –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è —Å–µ—Ä–±—Å–∫–æ–≥–æ ‚úÖ (150+ —Ç–µ—Å—Ç–æ–≤)
- –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ (467ns –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- –û—Å–Ω–æ–≤–Ω—ã–µ API endpoints ‚úÖ (12/18)
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å UI ‚úÖ 
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚úÖ (–¥–æ 1205 RPS)
- E2E —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚úÖ

### ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (5%):
1. **Admin API –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - HTTP 401 –¥–ª—è 6 endpoints
2. **–ù–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞** - –Ω–µ—Ç —Å–±–æ—Ä–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
3. **CORS –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** - allowedDevOrigins –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** 
   - –§–∞–π–ª: `internal/proj/search_admin/handler/routes.go`
   - –ü—Ä–æ–±–ª–µ–º–∞: AdminRequired middleware –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è admin endpoints
   - –†–µ—à–µ–Ω–∏–µ: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å AdminAuthRequired

2. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞**
   - –ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–≥–∏ –ø–æ–∏—Å–∫–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é search_logs –º–æ–¥—É–ª—è

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å admin API**
   - –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 6 –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö endpoints
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å LOG_LEVEL=warn** (+15% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
5. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å CORS –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** (allowedDevOrigins)
6. **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üìä –¢–ï–ö–£–©–ò–ï TODO

- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è admin API endpoints (HTTP 401 –ø—Ä–æ–±–ª–µ–º–∞)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è search_admin –º–æ–¥—É–ª—è  
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ admin API endpoints –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ–∏—Å–∫–∞ (–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å LOG_LEVEL=warn –≤ production
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è CORS –¥–ª—è allowedDevOrigins
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

–°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤–æ–π –∫ –§–∞–∑–µ 3 –∫–æ–≥–¥–∞:
- ‚úÖ –í—Å–µ admin API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ (–Ω–µ HTTP 401)
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

## üöÄ –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫:
- –§–∞–∑–∞ 3: –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (—Ç—Ä–µ–∫–∏–Ω–≥ –∫–ª–∏–∫–æ–≤, CTR –∞–Ω–∞–ª–∏–∑)
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—Å–æ–≤

## üìÅ –§–ê–ô–õ–´ –î–õ–Ø –†–ê–ë–û–¢–´

**Backend:**
- `internal/proj/search_admin/handler/routes.go` - middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `internal/middleware/` - JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
- `internal/proj/search_logs/` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞
- `backend/.env` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LOG_LEVEL

**Frontend:**
- `frontend/svetu/next.config.js` - CORS allowedDevOrigins
- `src/app/[locale]/admin/search/` - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

---
*–°–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è systematic —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º*