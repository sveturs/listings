# Session Handover: Unified Search –ü–æ–ª–Ω–æ—Å—Ç—å—é –ò—Å–ø—Ä–∞–≤–ª–µ–Ω

**–î–∞—Ç–∞:** 30 –∏—é–Ω—è 2025  
**–í—Ä–µ–º—è:** –í–µ—á–µ—Ä  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

## üéØ –ó–∞–¥–∞—á–∞
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤–∏—Ç—Ä–∏–Ω –Ω–∞ frontend, —á—Ç–æ–±—ã —Ç–æ–≤–∞—Ä "111111111111" –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–∏—Å–∫–∞.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ product_types
**–ü—Ä–æ–±–ª–µ–º–∞:** Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `product_types=marketplace&product_types=storefront`  
**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω `unifiedSearch.ts` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `product_types=marketplace,storefront`

```typescript
// frontend/svetu/src/services/unifiedSearch.ts
if (key === 'product_types') {
  url.searchParams.append(key, value.join(',')); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–ø—è—Ç—É—é –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
}
```

### 2. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ relevance
**–ü—Ä–æ–±–ª–µ–º–∞:** OpenSearch –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ –ø–æ–ª–µ `relevance`  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –æ–±–æ–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `_score`:

```go
// backend/internal/proj/marketplace/storage/opensearch/repository.go
case "relevance":
    query["sort"] = []interface{}{
        map[string]interface{}{
            "_score": map[string]interface{}{
                "order": "desc",
            },
        },
    }

// backend/internal/proj/storefronts/storage/opensearch/product_repository.go
case "relevance":
    sort = append(sort, map[string]interface{}{
        "_score": map[string]interface{}{
            "order": "desc",
        },
    })
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
```bash
curl "http://localhost:3001/api/v1/search?query=111111111111&product_types=marketplace,storefront&sort_by=relevance"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: {"total": 1, "items": [{"name": "111111111111", "product_type": "storefront"}]}
```

### Frontend –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞:
- URL: http://localhost:3001/ru/search?q=111111111111
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∏—Å–∫–∞

## üîç –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –≤ `unifiedSearch.ts`
2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ relevance** –≤ –æ–±–æ–∏—Ö OpenSearch —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö
3. **–ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω frontend** –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–∏—Å–∫** —á–µ—Ä–µ–∑ API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## ‚ö° –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

- ‚úÖ Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ OpenSearch —Å–æ–¥–µ—Ä–∂–∏—Ç 1252 —Ç–æ–≤–∞—Ä–∞ –≤–∏—Ç—Ä–∏–Ω
- ‚úÖ Frontend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ relevance —Ä–∞–±–æ—Ç–∞–µ—Ç

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã –∏ —Ç–æ—á–µ—á–Ω—ã - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.