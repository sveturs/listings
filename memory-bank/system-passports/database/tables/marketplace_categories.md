# –ü–∞—Å–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü—ã: marketplace_categories

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

```sql
CREATE TABLE marketplace_categories (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) NOT NULL UNIQUE,
    parent_id INT REFERENCES marketplace_categories(id),
    icon VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    sort_order INT DEFAULT 0,
    level INT DEFAULT 0,
    count INT DEFAULT 0,
    external_id VARCHAR(255)
);
```

## –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (SERIAL)
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ —è–∑—ã–∫–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)
- `slug` - URL-friendly –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)

### –ò–µ—Ä–∞—Ä—Ö–∏—è
- `parent_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é (NULL –¥–ª—è –∫–æ—Ä–Ω–µ–≤—ã—Ö)
- `level` - —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ (0 –¥–ª—è –∫–æ—Ä–Ω–µ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π)

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- `icon` - –∏–∫–æ–Ω–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –∏–ª–∏ emoji)
- `sort_order` - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å—Ä–µ–¥–∏ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- `external_id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑ –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º—ã (–¥–ª—è –∏–º–ø–æ—Ä—Ç–∞)

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–æ–ª—è
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

## –ò–Ω–¥–µ–∫—Å—ã

1. **idx_marketplace_categories_parent** - –∏–Ω–¥–µ–∫—Å –ø–æ parent_id –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞
2. **idx_marketplace_categories_sort_order** - –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
3. **idx_marketplace_categories_external_id** - –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –≤–Ω–µ—à–Ω–µ–º—É ID
4. **idx_marketplace_categories_slug** - –∏–Ω–¥–µ–∫—Å –ø–æ slug –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

## –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏

### –ü—Ä—è–º—ã–µ —Å–≤—è–∑–∏ (—ç—Ç–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞)
- `parent_id` ‚Üí `marketplace_categories.id` - —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (self-reference)

### –û–±—Ä–∞—Ç–Ω—ã–µ —Å–≤—è–∑–∏ (–¥—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ marketplace_categories)
- `marketplace_listings.category_id` - –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `category_attributes.category_id` - –∞—Ç—Ä–∏–±—É—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `category_attribute_mapping.category_id` - –º–∞–ø–ø–∏–Ω–≥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- `translations` - –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—á–µ—Ä–µ–∑ entity_type='category')

## –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

1. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å slug** - –∫–∞–∂–¥–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π slug
2. **–ò–µ—Ä–∞—Ä—Ö–∏—è** - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–º —Å–∞–º–æ–π —Å–µ–±–µ
3. **–£—Ä–æ–≤–Ω–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏**:
   - level = 0 - –∫–æ—Ä–Ω–µ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - level = 1 - –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è
   - –∏ —Ç.–¥.
4. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ sort_order, –∑–∞—Ç–µ–º –ø–æ name
5. **–ü–æ–¥—Å—á–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π** - –ø–æ–ª–µ count –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```sql
INSERT INTO marketplace_categories (name, slug, icon, sort_order) 
VALUES ('–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', 'electronics', 'üì±', 10);
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```sql
INSERT INTO marketplace_categories (name, slug, parent_id, level, sort_order) 
VALUES ('–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã', 'smartphones', 1, 1, 10);
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```sql
WITH RECURSIVE category_tree AS (
    SELECT * FROM marketplace_categories WHERE parent_id IS NULL
    UNION ALL
    SELECT c.* FROM marketplace_categories c
    INNER JOIN category_tree ct ON c.parent_id = ct.id
)
SELECT * FROM category_tree ORDER BY level, sort_order;
```

### –ü–æ–¥—Å—á–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```sql
UPDATE marketplace_categories 
SET count = (
    SELECT COUNT(*) FROM marketplace_listings 
    WHERE category_id = marketplace_categories.id 
    AND status = 'active'
);
```

## –ü—Ä–∏–º–µ—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```
üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ (electronics)
  ‚îî‚îÄ‚îÄ üì± –°–º–∞—Ä—Ç—Ñ–æ–Ω—ã (smartphones)
  ‚îî‚îÄ‚îÄ üíª –ù–æ—É—Ç–±—É–∫–∏ (laptops)
  ‚îî‚îÄ‚îÄ üì∑ –§–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞ (cameras)

üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (transport)
  ‚îî‚îÄ‚îÄ üöó –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ (cars)
  ‚îî‚îÄ‚îÄ üèçÔ∏è –ú–æ—Ç–æ—Ü–∏–∫–ª—ã (motorcycles)
  ‚îî‚îÄ‚îÄ üö≤ –í–µ–ª–æ—Å–∏–ø–µ–¥—ã (bicycles)

üè† –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å (real-estate)
  ‚îî‚îÄ‚îÄ üè¢ –ö–≤–∞—Ä—Ç–∏—Ä—ã (apartments)
  ‚îî‚îÄ‚îÄ üè° –î–æ–º–∞ (houses)
  ‚îî‚îÄ‚îÄ üè¢ –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è (commercial)
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É translations
2. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–æ–ª–µ count –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **External ID** - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
4. **–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - parent_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç—É –∂–µ —Ç–∞–±–ª–∏—Ü—É
5. **URL-friendly slugs** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ URL –¥–ª—è SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## –ú–∏–≥—Ä–∞—Ü–∏–∏

- **000001** - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- **000035** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ sort_order, level, count, external_id
- **000039** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –ø–æ slug

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

1. **Frontend** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö
2. **OpenSearch** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –≤ –∏–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞
3. **Import** - external_id –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
4. **Translations** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤