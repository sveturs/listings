# Паспорт компонента: LocationMap

## Метаданные
- **Путь**: `/frontend/svetu/src/components/storefronts/create/LocationMap.tsx`
- **Роль**: Интерактивная карта для выбора локации
- **Тип**: Компонент карты с Leaflet
- **Размер**: 63 строки

## Назначение
Простая интерактивная карта для выбора местоположения витрины. Позволяет кликом по карте установить маркер в нужной точке. Используется в шаге LocationStep при создании витрины.

## Props
```typescript
interface LocationMapProps {
  position: LatLngExpression;                          // Текущая позиция маркера [lat, lng]
  onLocationSelect: (lat: number, lng: number) => void; // Обработчик выбора новой позиции
}
```

## Зависимости
### Внешние
- `leaflet` - основная библиотека карт
- `react-leaflet` - React компоненты для Leaflet

### Внутренние
- Нет внутренних зависимостей

## Управление состоянием
### Локальное состояние
- `markerRef` - ref для прямого доступа к маркеру

### Внешние данные
- `position` - позиция маркера контролируется родителем

## Бизнес-логика
1. **Инициализация маркеров**:
   - Переопределение путей к иконкам маркеров
   - Использование стандартных иконок Leaflet

2. **Взаимодействие с картой**:
   - Клик по карте вызывает `onLocationSelect` с координатами
   - Маркер автоматически перемещается при изменении position

3. **LocationPicker компонент**:
   - Внутренний компонент для обработки кликов
   - Использует `useMapEvents` хук

4. **Параметры карты**:
   - Зум по умолчанию: 15 (уровень улиц)
   - Тайлы: OpenStreetMap
   - Размер: 100% контейнера

## UI структура
```
<MapContainer> // Основной контейнер карты
  ├── <TileLayer> // OSM тайлы с атрибуцией
  ├── <Marker> // Маркер текущей позиции
  └── <LocationPicker> // Невидимый компонент для кликов
```

## Примеры использования
```typescript
// В LocationStep
const [coordinates, setCoordinates] = useState({
  lat: 44.8125,
  lng: 20.4612
});

<LocationMap
  position={[coordinates.lat, coordinates.lng]}
  onLocationSelect={(lat, lng) => {
    setCoordinates({ lat, lng });
    updateFormData({ latitude: lat, longitude: lng });
  }}
/>
```

## Известные особенности
### Позитивные
- Простой и понятный интерфейс
- Клик в любом месте перемещает маркер
- Автоматическое обновление при изменении position
- Минималистичный дизайн

### Технический долг
- Type casting для ref (`as any`)
- Глобальное изменение L.Icon.Default
- Нет контролов карты (zoom, layers)

### Возможные улучшения
- Добавить контролы масштабирования
- Поиск адреса на карте
- Кнопка "Моё местоположение"
- Отмена последнего действия
- Анимация перемещения маркера
- Кастомная иконка для маркера витрины