# Паспорт компонента: PreviewPublishStep

## Метаданные
- **Путь**: `/frontend/svetu/src/components/storefronts/create/steps/PreviewPublishStep.tsx`
- **Роль**: Предпросмотр и публикация витрины
- **Тип**: Компонент подтверждения с отправкой данных
- **Размер**: 308 строк

## Назначение
Финальный седьмой шаг мастера создания витрины. Показывает сводку всех введенных данных для проверки и позволяет опубликовать новую витрину магазина.

## Props
```typescript
interface PreviewPublishStepProps {
  onBack: () => void;     // Возврат к предыдущему шагу
  onComplete: () => void; // Завершение процесса создания
}
```

## Зависимости
### Внешние
- `next-intl` - локализация

### Внутренние
- `@/contexts/CreateStorefrontContext` - контекст формы с методом отправки

## Управление состоянием
### Локальное состояние
- Нет локального состояния

### Контекст
- `formData` - все данные формы для отображения
- `isSubmitting` - статус отправки данных
- `submitStorefront` - метод отправки на сервер

## Бизнес-логика
1. **Разделы предпросмотра**:
   - Основная информация (название, slug, описание, тип)
   - Бизнес-детали (регистрационные номера, контакты)
   - Местоположение (адрес, координаты)
   - Часы работы (по дням недели)
   - Оплата и доставка (методы и службы)
   - Персонал (сотрудники и разрешения)

2. **Процесс публикации**:
   - Вызов `submitStorefront()` из контекста
   - Ожидание результата
   - При успехе - вызов `onComplete()`
   - Блокировка кнопок во время отправки

3. **Форматирование данных**:
   - Координаты округляются до 6 знаков
   - Дни недели локализованы
   - Условное отображение секций (только если есть данные)

4. **Дни недели** (массив для индексации):
   - 0: sunday, 1: monday, ..., 6: saturday

## UI структура
```
<div className="card"> // Основная карточка
  └── <div className="card-body">
      ├── <h2> // "Предпросмотр и публикация"
      ├── <p> // Подзаголовок
      │
      └── <div className="space-y-6"> // Секции данных
          ├── <div className="card bg-base-200"> // Основная информация
          │   ├── Название
          │   ├── URL (svetu.rs/slug)
          │   ├── Описание
          │   └── Тип бизнеса
          │
          ├── <div className="card"> // Бизнес-детали
          │   └── Сетка с номерами и контактами
          │
          ├── <div className="card"> // Местоположение
          │   ├── Адрес, город, индекс
          │   ├── Страна
          │   └── Координаты (если есть)
          │
          ├── <div className="card"> // Часы работы
          │   └── Список дней с временем/закрыто
          │
          ├── <div className="card"> // Оплата и доставка
          │   ├── Badges способов оплаты
          │   └── Список служб доставки с параметрами
          │
          └── {staff && <div className="card">} // Персонал
              └── Список сотрудников с разрешениями
      
      └── <div className="card-actions"> // Кнопки
          ├── Назад (ghost, блокируется при отправке)
          └── Опубликовать (primary, с loading)
```

## Примеры использования
```typescript
// В мастере создания витрины
<PreviewPublishStep
  onBack={() => setCurrentStep(6)}
  onComplete={() => {
    toast.success('Витрина создана!');
    router.push('/profile/storefronts');
  }}
/>
```

## Известные особенности
### Позитивные
- Полный обзор всех данных перед публикацией
- Условное отображение только заполненных полей
- Блокировка интерфейса во время отправки
- Группировка данных по логическим секциям
- Локализация всех текстов

### Технический долг
- Жестко закодированная валюта RSD для доставки
- Нет возможности редактировать данные прямо в preview
- Нет индикации обязательных полей

### Возможные улучшения
- Inline редактирование в режиме preview
- Сохранение черновика перед публикацией
- Предварительный просмотр публичной страницы
- Выбор времени публикации
- Отправка на модерацию вместо прямой публикации
- Прогресс-бар отправки данных