# Паспорт компонента: StaffSetupStep

## Метаданные
- **Путь**: `/frontend/svetu/src/components/storefronts/create/steps/StaffSetupStep.tsx`
- **Роль**: Управление персоналом витрины
- **Тип**: Компонент формы с динамическим списком
- **Размер**: 293 строки

## Назначение
Шестой шаг мастера создания витрины. Позволяет добавлять сотрудников с различными ролями и разрешениями для управления витриной магазина.

## Props
```typescript
interface StaffSetupStepProps {
  onNext: () => void;  // Переход к следующему шагу
  onBack: () => void;  // Возврат к предыдущему шагу
}
```

## Зависимости
### Внешние
- `react` - хук состояния
- `next-intl` - локализация

### Внутренние
- `@/contexts/CreateStorefrontContext` - контекст формы создания

## Управление состоянием
### Локальное состояние
- `newStaffMember` - форма добавления нового сотрудника
- `errors` - ошибки валидации email

### Контекст
- `formData.staff` - массив добавленных сотрудников
- `updateFormData` - обновление данных

## Бизнес-логика
1. **Структура сотрудника**:
   ```typescript
   interface StaffMember {
     email: string;              // Email сотрудника
     role: string;               // Роль (staff/manager/admin)
     canManageProducts: boolean; // Управление товарами
     canManageOrders: boolean;   // Управление заказами
     canManageSettings: boolean; // Управление настройками
   }
   ```

2. **Роли сотрудников**:
   - staff - Обычный сотрудник
   - manager - Менеджер
   - admin - Администратор

3. **Разрешения**:
   - Управление товарами - добавление, редактирование, удаление
   - Управление заказами - обработка, статусы, возвраты
   - Управление настройками - изменение данных витрины

4. **Валидация**:
   - Email обязателен и должен быть валидным
   - Проверка на дубликаты email
   - Минимум одно разрешение должно быть активно

## UI структура
```
<div className="card"> // Карточка формы
  └── <div className="card-body">
      ├── <h2> // "Настройка персонала"
      ├── <p> // Подзаголовок
      │
      ├── {staff.length > 0 && // Список сотрудников
      │   ├── <h3> // "Текущий персонал"
      │   └── {staff.map()} // Карточки сотрудников
      │       └── <div className="bg-base-200">
      │           ├── Email и роль
      │           ├── Badges разрешений
      │           └── Кнопка удаления
      │
      ├── <div className="card"> // Форма добавления
      │   ├── <h3> // "Добавить сотрудника"
      │   ├── <div className="grid"> // 2 колонки
      │   │   ├── Email (с валидацией)
      │   │   └── Роль (select)
      │   ├── <div> // Разрешения
      │   │   ├── Checkbox "Управление товарами"
      │   │   ├── Checkbox "Управление заказами"
      │   │   └── Checkbox "Управление настройками"
      │   └── Кнопка "Добавить"
      │
      ├── <alert> // Информационное сообщение
      └── <div className="card-actions"> // Кнопки
          ├── Назад (ghost)
          └── Далее (primary)
```

## Примеры использования
```typescript
// В мастере создания витрины
<StaffSetupStep
  onNext={() => setCurrentStep(7)}
  onBack={() => setCurrentStep(5)}
/>

// Данные в контексте после заполнения
{
  staff: [
    {
      email: "manager@store.com",
      role: "manager",
      canManageProducts: true,
      canManageOrders: true,
      canManageSettings: true
    },
    {
      email: "sales@store.com",
      role: "staff",
      canManageProducts: true,
      canManageOrders: true,
      canManageSettings: false
    }
  ]
}
```

## Известные особенности
### Позитивные
- Гранулярные разрешения для каждого сотрудника
- Валидация email и дубликатов
- Предустановленные значения для удобства
- Информационная подсказка
- Визуальные badges для разрешений

### Технический долг
- Роли определены но не влияют на разрешения автоматически
- Нет интеграции с реальными пользователями системы
- Сотрудники добавляются по email без проверки существования

### Возможные улучшения
- Автоматические разрешения на основе роли
- Поиск существующих пользователей по email
- Шаблоны ролей с предустановленными разрешениями
- Приглашение сотрудников по email
- История изменений персонала
- Массовое добавление из CSV