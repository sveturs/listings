# –ü–∞—Å–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: MarketplaceCard

## üìã –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- **–ü—É—Ç—å**: `/frontend/svetu/src/components/MarketplaceCard.tsx`
- **–†–æ–ª—å**: –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
- **–¢–∏–ø**: Client Component
- **–†–∞–∑–º–µ—Ä**: 337 —Å—Ç—Ä–æ–∫

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:
- Grid view - –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è —Å–µ—Ç–∫–∏
- List view - –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è —Å–ø–∏—Å–∫–∞
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ —á–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Props
```typescript
interface MarketplaceCardProps {
  item: MarketplaceItem;        // –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
  locale: string;               // –õ–æ–∫–∞–ª—å –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  viewMode?: 'grid' | 'list';   // –†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (default: 'grid')
}
```

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:
- `MarketplaceItem` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞
- `MarketplaceImage` - —Ç–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `SafeImage` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `Link` (Next.js) - –Ω–∞–≤–∏–≥–∞—Ü–∏—è

### –ö–æ–Ω—Ç–µ–∫—Å—Ç:
- `useAuth` - –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —á–∞—Ç–∞

### –•—É–∫–∏:
- `useRouter` - –ø—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- `useTranslations` - –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
```typescript
mounted: boolean  // –§–ª–∞–≥ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è SSR
```

### –î–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
```typescript
user: User | null          // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
isAuthenticated: boolean   // –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

## üîß –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### formatPrice:
```typescript
formatPrice(price?: number, currency?: string)
```
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Intl.NumberFormat
- –í–∞–ª—é—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: USD
- –ë–µ–∑ –¥—Ä–æ–±–Ω–æ–π —á–∞—Å—Ç–∏

### formatDate:
```typescript
formatDate(dateString: string)
```
- "—Ç–æ–ª—å–∫–æ —á—Ç–æ" - –º–µ–Ω–µ–µ —á–∞—Å–∞
- "X —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥" - –º–µ–Ω–µ–µ —Å—É—Ç–æ–∫
- "X –¥–Ω–µ–π –Ω–∞–∑–∞–¥" - –º–µ–Ω–µ–µ –Ω–µ–¥–µ–ª–∏
- –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ - –±–æ–ª–µ–µ –Ω–µ–¥–µ–ª–∏

### getImageUrl:
```typescript
getImageUrl(image?: MarketplaceImage)
```
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç public_url –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- SafeImage —Å–∞–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Ç–∏

## üé® UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### Grid View:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  [–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]  [üí¨]‚îÇ  <- –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –ó–∞–≥–æ–ª–æ–≤–æ–∫          ‚îÇ
‚îÇ  –¶–µ–Ω–∞ (—Å–æ —Å–∫–∏–¥–∫–æ–π)  ‚îÇ
‚îÇ  üìç –õ–æ–∫–∞—Ü–∏—è         ‚îÇ
‚îÇ  –î–∞—Ç–∞               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### List View:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [Img] ‚îÇ –ó–∞–≥–æ–ª–æ–≤–æ–∫        –¶–µ–Ω–∞  [üí¨] ‚îÇ
‚îÇ       ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ         –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞‚îÇ
‚îÇ       ‚îÇ üìç –õ–æ–∫–∞—Ü–∏—è, –î–∞—Ç–∞            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üéØ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
1. –ò—â–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å `is_main = true`
2. –ï—Å–ª–∏ –Ω–µ—Ç, –±–µ—Ä–µ—Ç –ø–µ—Ä–≤–æ–µ –∏–∑ –º–∞—Å—Å–∏–≤–∞
3. Fallback –Ω–∞ SVG –∏–∫–æ–Ω–∫—É

### –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º
- –°–∫—Ä—ã—Ç–∞ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –ü–µ—Ä–µ—Ö–æ–¥: `/{locale}/chat?listing_id={id}&seller_id={user_id}`

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã:
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤–∞–ª—é—Ç–µ RSD
- –ü–æ–∫–∞–∑ —Å—Ç–∞—Ä–æ–π —Ü–µ–Ω—ã –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–∫–∏–¥–∫–∏
- –ó–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π —Å—Ç–∏–ª—å –¥–ª—è —Å—Ç–∞—Ä–æ–π —Ü–µ–Ω—ã

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. SSR –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
```typescript
const [mounted, setMounted] = useState(false);
useEffect(() => { setMounted(true); }, []);
```
- –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. Responsive images:
- Grid: `sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"`
- List: `sizes="128px"`

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞:
- `line-clamp-1/2` –¥–ª—è –æ–±—Ä–µ–∑–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- –£—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

## üåç –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª—é—á–∏:
- `common.justNow` - —Ç–æ–ª—å–∫–æ —á—Ç–æ
- `common.hoursAgo` - —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
- `common.daysAgoWithCount` - –¥–Ω–µ–π –Ω–∞–∑–∞–¥ (—Å —á–∏—Å–ª–æ–º)
- `common.sendMessage` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- `common.chat` - —á–∞—Ç

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- DaisyUI card –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Hover —ç—Ñ—Ñ–µ–∫—Ç—ã —Ç–µ–Ω–∏
- Responsive —Ä–∞–∑–º–µ—Ä—ã –∏ –æ—Ç—Å—Ç—É–ø—ã
- Z-index –¥–ª—è –∫–Ω–æ–ø–∫–∏ —á–∞—Ç–∞

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **Debug –¥–ª—è ID 177**:
   - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π console.log –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 79-85)

2. **Hardcoded –≤–∞–ª—é—Ç–∞**:
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RSD –¥–ª—è —Ü–µ–Ω—ã
   - TODO: –±—Ä–∞—Ç—å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–æ–≤–∞—Ä–∞

3. **Chat –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**:
   - –ú–æ–ª—á–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫–ª–∏–∫ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
   - TODO: –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –º–æ–¥–∞–ª

4. **Mounted –ø—Ä–æ–≤–µ—Ä–∫–∞**:
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç hydration mismatch
   - –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```tsx
// –í —Å–ø–∏—Å–∫–µ —Ç–æ–≤–∞—Ä–æ–≤
<MarketplaceCard
  item={marketplaceItem}
  locale="ru"
  viewMode="grid"
/>

// –í –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —Å–ø–∏—Å–∫–µ
<MarketplaceCard
  item={marketplaceItem}
  locale="en"
  viewMode="list"
/>
```

## üîÑ –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `MarketplaceList` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `SafeImage` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `Chat` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞ (—á–µ—Ä–µ–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏—é)
- `MarketplaceDetail` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞