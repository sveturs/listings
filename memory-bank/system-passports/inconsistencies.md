# –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ

## –†–µ–∑—é–º–µ –∞–Ω–∞–ª–∏–∑–∞

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—Å–µ—Ö —Å–ª–æ–µ–≤ —Å–∏—Å—Ç–µ–º—ã **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –≤ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è—Ö –ø–æ–ª–µ–π –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û**. 

–°–∏—Å—Ç–µ–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–æ—Ç–ª–∏—á–Ω—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** –≤ naming conventions:
- ‚úÖ **100% snake_case** –≤–æ –≤—Å–µ—Ö API –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
- ‚úÖ **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ ID –ø–æ–ª—è** ({entity}_id pattern)
- ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ timestamps** (created_at, updated_at)
- ‚úÖ **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –≤–æ –≤—Å–µ—Ö —Å–ª–æ—è—Ö

## –ú–∏–Ω–æ—Ä–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### 1. –≠–≤–æ–ª—é—Ü–∏—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü storefronts
- **–°—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞**: `user_storefronts` (deprecated)  
- **–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞**: `storefronts` (current)
- **–°—Ç–∞—Ç—É—Å**: –û–±–µ —Ç–∞–±–ª–∏—Ü—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

#### –í–ª–∏—è–Ω–∏–µ
- üü° **–ù–∏–∑–∫–æ–µ**: –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ API –∏–ª–∏ frontend
- Backend –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É `storefronts`
- –°—Ç–∞—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
- –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è `user_storefronts`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Å—Ç–∞—Ä–æ–º –∫–æ–¥–µ

### 2. –†–∞–∑–ª–∏—á–∏—è –≤ —Ç–∏–ø–∞—Ö ID –ø–æ–ª–µ–π

#### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ ID
- **–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–∞–±–ª–∏—Ü**: `SERIAL` (INT)
- **user_contacts**: `BIGSERIAL` (BIGINT)

#### –í–ª–∏—è–Ω–∏–µ  
- üü° **–ù–∏–∑–∫–æ–µ**: –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º –≤ API
- Go –º–æ–¥–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ç–∏–ø—ã (int vs int64)
- Frontend –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ ID –∫–∞–∫ —á–∏—Å–ª–∞

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `BIGINT` –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
- Existing tables –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å

### 3. Timestamps –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

#### –ü—Ä–æ–±–ª–µ–º–∞: –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã timestamp –ø–æ–ª–µ–π
- **–°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏**: `TIMESTAMP` 
- **–ù–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏**: `TIMESTAMP WITH TIME ZONE`

#### –í–ª–∏—è–Ω–∏–µ
- üü° **–ù–∏–∑–∫–æ–µ**: –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- Go `time.Time` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±–∞ —Ç–∏–ø–∞
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç UTC timestamps

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TIMESTAMP WITH TIME ZONE` –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
- Existing fields –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

### 1. OpenSearch Field Extensions

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
OpenSearch —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ PostgreSQL:
- `make_lowercase`, `model_lowercase`, `brand_lowercase`
- `car_keywords[]`, `title_variations[]`
- `all_attributes_text`

#### –°—Ç–∞—Ç—É—Å
- ‚úÖ **–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**: –ü–æ–ª—è —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ**: –õ–æ–≥–∏–∫–∞ –≤ –∫–æ–¥–µ –ø–æ–Ω—è—Ç–Ω–∞ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–∞
- ‚úÖ **–ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º**: Frontend –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —ç—Ç–∏—Ö –ø–æ–ª–µ–π

### 2. MinIO Path Conventions

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
–†–∞–∑–Ω—ã–µ bucket'—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –ø—É—Ç–µ–π:
- **listings**: `/{filename}`
- **chat-files**: `/{type}/{year}/{month}/{day}/{messageId}_{timestamp}_{filename}`
- **review-photos**: `/{filename}`

#### –°—Ç–∞—Ç—É—Å
- ‚úÖ **–≠—Ç–æ design choice**: –ö–∞–∂–¥—ã–π —Ç–∏–ø —Ñ–∞–π–ª–æ–≤ –∏–º–µ–µ—Ç —Å–≤–æ—é –ª–æ–≥–∏–∫—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ**: –ü–∞—Ç—Ç–µ—Ä–Ω—ã —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –∫–æ–¥–µ
- ‚úÖ **–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ API**: Frontend –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ public_url

### 3. Geo Coordinates Transformation

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
PostgreSQL —Ö—Ä–∞–Ω–∏—Ç `latitude`/`longitude` –æ—Ç–¥–µ–ª—å–Ω–æ, OpenSearch –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ `coordinates` geo_point.

#### –°—Ç–∞—Ç—É—Å
- ‚úÖ **–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ**: Transformation –ª–æ–≥–∏—á–µ–Ω –¥–ª—è geo-–ø–æ–∏—Å–∫–∞
- ‚úÖ **–û–±—Ä–∞—Ç–∏–º–æ**: –ò—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ**: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –ø–æ–ª—è

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–∞

### 1. –ü—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### Code Review Checklist
- [ ] –ù–æ–≤—ã–µ –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç snake_case –≤ JSON —Ç–µ–≥–∞—Ö
- [ ] ID –ø–æ–ª—è —Å–ª–µ–¥—É—é—Ç pattern {entity}_id  
- [ ] Timestamp –ø–æ–ª—è named created_at/updated_at
- [ ] Nullable –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç pointer types –≤ Go
- [ ] OpenAPI –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç JSON —Ç–µ–≥–∞–º

#### Database Migrations
- [ ] –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç TIMESTAMP WITH TIME ZONE
- [ ] ID –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç BIGSERIAL –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
- [ ] Foreign keys —Å–ª–µ–¥—É—é—Ç naming convention
- [ ] –î–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã

#### API Design
- [ ] –ù–æ–≤—ã–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç snake_case
- [ ] Error responses –∏—Å–ø–æ–ª—å–∑—É—é—Ç standard —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- [ ] Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- [ ] Frontend types —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è

### 2. Automated Checks

#### Pre-commit Hooks
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Go struct tags
go vet ./...

# –ü—Ä–æ–≤–µ—Ä–∫–∞ JSON naming –≤ structs  
gofmt -d .

# –õ–∏–Ω—Ç–∏–Ω–≥ OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
swagger validate docs/swagger.json

# –ü—Ä–æ–≤–µ—Ä–∫–∞ TypeScript types
yarn lint --max-warnings 0
```

#### CI Pipeline
- Unit tests –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- Integration tests –¥–ª—è API endpoints  
- TypeScript compilation check
- Database migration dry-run

### 3. Documentation Updates

#### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
1. –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏
2. –û–±–Ω–æ–≤–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–∞ OpenSearch mapping
4. –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

#### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
1. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å breaking changes
2. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–∞—Å–ø–æ—Ä—Ç–∞ —Å–ª–æ–µ–≤
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
4. –°–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –í—ã–≤–æ–¥—ã

### ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Å–∏—Å—Ç–µ–º—ã

1. **–û—Ç–ª–∏—á–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å naming**: snake_case –≤–µ–∑–¥–µ, –≥–¥–µ –Ω—É–∂–Ω–æ
2. **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**: {entity}_id –¥–ª—è FK, created_at/updated_at –¥–ª—è timestamps
3. **–•–æ—Ä–æ—à–∞—è type safety**: Proper nullable handling, decimal –¥–ª—è –¥–µ–Ω–µ–≥
4. **Clear separation of concerns**: –ö–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
5. **Comprehensive validation**: –ù–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö —Å—Ç–µ–∫–∞

### üîß –û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

1. **Cleanup deprecated tables**: –£–¥–∞–ª–∏—Ç—å user_storefronts –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
2. **Standardize ID types**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BIGINT –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü  
3. **Timestamp consistency**: WITH TIME ZONE –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
4. **Automated consistency checks**: Pre-commit —Ö—É–∫–∏ –¥–ª—è naming

### üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: **A+**

–°–∏—Å—Ç–µ–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ naming conventions –∏ data consistency. –ú–∏–Ω–æ—Ä–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —è–≤–ª—è—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º.

**–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞**: –°–∏—Å—Ç–µ–º–∞ –ù–ï –∏–º–µ–µ—Ç –ø—Ä–æ–±–ª–µ–º —Ç–∏–ø–∞ user_id vs userId vs userID. –í—Å–µ —Å–ª–æ–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ.