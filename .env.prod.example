# Listings Service Production Configuration (dev.vondi.rs)
# Copy this file to .env.prod and configure for production deployment
#
# IMPORTANT: .env.prod should NEVER be committed to git!

# ========================================
# Application Settings
# ========================================
VONDILISTINGS_ENV=production
VONDILISTINGS_LOG_LEVEL=info
VONDILISTINGS_LOG_FORMAT=json

# ========================================
# Server Ports
# ========================================
# gRPC Internal API (not exposed via Nginx)
VONDILISTINGS_GRPC_PORT=50053
VONDILISTINGS_GRPC_HOST=0.0.0.0

# HTTP REST API (exposed via Nginx as listings.dev.vondi.rs)
VONDILISTINGS_HTTP_PORT=8086
VONDILISTINGS_HTTP_HOST=0.0.0.0

# Prometheus Metrics (internal only, NOT exposed)
VONDILISTINGS_METRICS_PORT=9093
VONDILISTINGS_METRICS_HOST=0.0.0.0

# ========================================
# Database Configuration (PostgreSQL)
# ========================================
# Production database on dev server
# Using separate database from main svetu database
VONDILISTINGS_DB_HOST=localhost
VONDILISTINGS_DB_PORT=35433
VONDILISTINGS_DB_USER=listings_user
VONDILISTINGS_DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
VONDILISTINGS_DB_NAME=listings_dev_db
VONDILISTINGS_DB_SSLMODE=disable

# Connection Pool Settings (production-optimized)
VONDILISTINGS_DB_MAX_OPEN_CONNS=50
VONDILISTINGS_DB_MAX_IDLE_CONNS=25
VONDILISTINGS_DB_CONN_MAX_LIFETIME=30m
VONDILISTINGS_DB_CONN_MAX_IDLE_TIME=15m

# ========================================
# Redis Configuration
# ========================================
# Separate Redis instance for listings service
VONDILISTINGS_REDIS_HOST=localhost
VONDILISTINGS_REDIS_PORT=36380
VONDILISTINGS_REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
VONDILISTINGS_REDIS_DB=0

# Redis Connection Pool
VONDILISTINGS_REDIS_POOL_SIZE=20
VONDILISTINGS_REDIS_MIN_IDLE_CONNS=10

# Cache TTL Settings (production-optimized)
VONDILISTINGS_CACHE_LISTING_TTL=10m
VONDILISTINGS_CACHE_SEARCH_TTL=5m

# ========================================
# OpenSearch Configuration
# ========================================
# Use existing OpenSearch instance from main svetu
VONDILISTINGS_OPENSEARCH_ADDRESSES=http://localhost:9200
VONDILISTINGS_OPENSEARCH_USERNAME=admin
VONDILISTINGS_OPENSEARCH_PASSWORD=CHANGE_ME_OPENSEARCH_PASSWORD
VONDILISTINGS_OPENSEARCH_INDEX=marketplace_listings

# ========================================
# MinIO Configuration (S3-compatible storage)
# ========================================
# Use existing MinIO instance from main svetu
VONDILISTINGS_MINIO_ENDPOINT=localhost:9000
VONDILISTINGS_MINIO_ACCESS_KEY=CHANGE_ME_MINIO_ACCESS_KEY
VONDILISTINGS_MINIO_SECRET_KEY=CHANGE_ME_MINIO_SECRET_KEY
VONDILISTINGS_MINIO_USE_SSL=false
VONDILISTINGS_MINIO_BUCKET=listings-images

# ========================================
# Auth Service Integration
# ========================================
# Use preprod auth service instance
VONDILISTINGS_AUTH_SERVICE_URL=http://localhost:28086
VONDILISTINGS_AUTH_PUBLIC_KEY_PATH=/opt/svetu-authpreprod/keys/public.pem

# ========================================
# Worker Configuration
# ========================================
VONDILISTINGS_WORKER_ENABLED=true
VONDILISTINGS_WORKER_CONCURRENCY=10
VONDILISTINGS_WORKER_QUEUE_NAME=listings_indexing

# ========================================
# Rate Limiting
# ========================================
VONDILISTINGS_RATE_LIMIT_ENABLED=true
VONDILISTINGS_RATE_LIMIT_RPS=200
VONDILISTINGS_RATE_LIMIT_BURST=500

# ========================================
# Tracing & Monitoring
# ========================================
# Disable tracing in dev (can enable if needed)
VONDILISTINGS_TRACING_ENABLED=false
VONDILISTINGS_JAEGER_ENDPOINT=http://localhost:14268/api/traces

# ========================================
# CORS Configuration
# ========================================
# Allow requests from dev frontend
VONDILISTINGS_CORS_ALLOWED_ORIGINS=https://dev.vondi.rs,https://devapi.vondi.rs,http://localhost:3001
VONDILISTINGS_CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
VONDILISTINGS_CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# ========================================
# Feature Flags
# ========================================
VONDILISTINGS_FEATURE_ASYNC_INDEXING=true
VONDILISTINGS_FEATURE_IMAGE_OPTIMIZATION=true
VONDILISTINGS_FEATURE_CACHE_ENABLED=true

# ========================================
# Production-Specific Settings
# ========================================
# Graceful shutdown timeout
VONDILISTINGS_SHUTDOWN_TIMEOUT=30s

# Request timeout
VONDILISTINGS_REQUEST_TIMEOUT=60s

# Maximum request body size (50MB for image uploads)
VONDILISTINGS_MAX_BODY_SIZE=52428800
