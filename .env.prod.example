# Listings Service Production Configuration (dev.svetu.rs)
# Copy this file to .env.prod and configure for production deployment
#
# IMPORTANT: .env.prod should NEVER be committed to git!

# ========================================
# Application Settings
# ========================================
SVETULISTINGS_ENV=production
SVETULISTINGS_LOG_LEVEL=info
SVETULISTINGS_LOG_FORMAT=json

# ========================================
# Server Ports
# ========================================
# gRPC Internal API (not exposed via Nginx)
SVETULISTINGS_GRPC_PORT=50053
SVETULISTINGS_GRPC_HOST=0.0.0.0

# HTTP REST API (exposed via Nginx as listings.dev.svetu.rs)
SVETULISTINGS_HTTP_PORT=8086
SVETULISTINGS_HTTP_HOST=0.0.0.0

# Prometheus Metrics (internal only, NOT exposed)
SVETULISTINGS_METRICS_PORT=9093
SVETULISTINGS_METRICS_HOST=0.0.0.0

# ========================================
# Database Configuration (PostgreSQL)
# ========================================
# Production database on dev server
# Using separate database from main svetu database
SVETULISTINGS_DB_HOST=localhost
SVETULISTINGS_DB_PORT=35433
SVETULISTINGS_DB_USER=listings_user
SVETULISTINGS_DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
SVETULISTINGS_DB_NAME=listings_dev_db
SVETULISTINGS_DB_SSLMODE=disable

# Connection Pool Settings (production-optimized)
SVETULISTINGS_DB_MAX_OPEN_CONNS=50
SVETULISTINGS_DB_MAX_IDLE_CONNS=25
SVETULISTINGS_DB_CONN_MAX_LIFETIME=30m
SVETULISTINGS_DB_CONN_MAX_IDLE_TIME=15m

# ========================================
# Redis Configuration
# ========================================
# Separate Redis instance for listings service
SVETULISTINGS_REDIS_HOST=localhost
SVETULISTINGS_REDIS_PORT=36380
SVETULISTINGS_REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
SVETULISTINGS_REDIS_DB=0

# Redis Connection Pool
SVETULISTINGS_REDIS_POOL_SIZE=20
SVETULISTINGS_REDIS_MIN_IDLE_CONNS=10

# Cache TTL Settings (production-optimized)
SVETULISTINGS_CACHE_LISTING_TTL=10m
SVETULISTINGS_CACHE_SEARCH_TTL=5m

# ========================================
# OpenSearch Configuration
# ========================================
# Use existing OpenSearch instance from main svetu
SVETULISTINGS_OPENSEARCH_ADDRESSES=http://localhost:9200
SVETULISTINGS_OPENSEARCH_USERNAME=admin
SVETULISTINGS_OPENSEARCH_PASSWORD=CHANGE_ME_OPENSEARCH_PASSWORD
SVETULISTINGS_OPENSEARCH_INDEX=marketplace_listings

# ========================================
# MinIO Configuration (S3-compatible storage)
# ========================================
# Use existing MinIO instance from main svetu
SVETULISTINGS_MINIO_ENDPOINT=localhost:9000
SVETULISTINGS_MINIO_ACCESS_KEY=CHANGE_ME_MINIO_ACCESS_KEY
SVETULISTINGS_MINIO_SECRET_KEY=CHANGE_ME_MINIO_SECRET_KEY
SVETULISTINGS_MINIO_USE_SSL=false
SVETULISTINGS_MINIO_BUCKET=listings-images

# ========================================
# Auth Service Integration
# ========================================
# Use preprod auth service instance
SVETULISTINGS_AUTH_SERVICE_URL=http://localhost:28086
SVETULISTINGS_AUTH_PUBLIC_KEY_PATH=/opt/svetu-authpreprod/keys/public.pem

# ========================================
# Worker Configuration
# ========================================
SVETULISTINGS_WORKER_ENABLED=true
SVETULISTINGS_WORKER_CONCURRENCY=10
SVETULISTINGS_WORKER_QUEUE_NAME=listings_indexing

# ========================================
# Rate Limiting
# ========================================
SVETULISTINGS_RATE_LIMIT_ENABLED=true
SVETULISTINGS_RATE_LIMIT_RPS=200
SVETULISTINGS_RATE_LIMIT_BURST=500

# ========================================
# Tracing & Monitoring
# ========================================
# Disable tracing in dev (can enable if needed)
SVETULISTINGS_TRACING_ENABLED=false
SVETULISTINGS_JAEGER_ENDPOINT=http://localhost:14268/api/traces

# ========================================
# CORS Configuration
# ========================================
# Allow requests from dev frontend
SVETULISTINGS_CORS_ALLOWED_ORIGINS=https://dev.svetu.rs,https://devapi.svetu.rs,http://localhost:3001
SVETULISTINGS_CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
SVETULISTINGS_CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# ========================================
# Feature Flags
# ========================================
SVETULISTINGS_FEATURE_ASYNC_INDEXING=true
SVETULISTINGS_FEATURE_IMAGE_OPTIMIZATION=true
SVETULISTINGS_FEATURE_CACHE_ENABLED=true

# ========================================
# Production-Specific Settings
# ========================================
# Graceful shutdown timeout
SVETULISTINGS_SHUTDOWN_TIMEOUT=30s

# Request timeout
SVETULISTINGS_REQUEST_TIMEOUT=60s

# Maximum request body size (50MB for image uploads)
SVETULISTINGS_MAX_BODY_SIZE=52428800
