# Deployment Configuration
# Copy this file to .env.deploy and configure for your environment

#######################################
# Production Server Configuration
#######################################

# Server hostname or IP
PROD_HOST="production.example.com"

# SSH user (must have sudo privileges)
PROD_USER="deploy"

# Application directory on server
PROD_DIR="/opt/listings"

# Domain name for the service
PROD_DOMAIN="listings.example.com"

#######################################
# Blue-Green Configuration
#######################################

# Blue instance (current stable)
BLUE_PORT=8080

# Green instance (new version)
GREEN_PORT=8081

#######################################
# Database Configuration
#######################################

# PostgreSQL settings
DB_USER="listings"
DB_NAME="listings_prod"

# Database backup retention (days)
DB_BACKUP_RETENTION=30

#######################################
# Nginx Configuration
#######################################

# Nginx config file path
NGINX_CONFIG_PATH="/etc/nginx/sites-available/listings"

# Nginx reload timeout (seconds)
NGINX_RELOAD_TIMEOUT=10

#######################################
# Notification Configuration
#######################################

# Slack webhook URL for deployment notifications
# Get from: https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK_URL=""

# Email for critical alerts
ALERT_EMAIL=""

#######################################
# On-Call Configuration
#######################################

# Current on-call engineer
ONCALL_ENGINEER=""

# Incident commander
INCIDENT_COMMANDER=""

#######################################
# Deployment Settings
#######################################

# Canary phase durations (seconds)
CANARY_PHASE1_DURATION=300  # 5 minutes at 10%
CANARY_PHASE2_DURATION=300  # 5 minutes at 50%

# Rollback window (seconds)
ROLLBACK_WINDOW=600  # 10 minutes

# Health check retries
HEALTH_CHECK_RETRIES=5

# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=2

# Error rate threshold (errors per 1000 log lines)
ERROR_RATE_THRESHOLD=10

#######################################
# Build Configuration
#######################################

# Go build flags
GO_BUILD_FLAGS="-ldflags='-s -w'"

# Binary name
BINARY_NAME="listings-prod"

#######################################
# Monitoring Configuration
#######################################

# Metrics endpoint
METRICS_ENDPOINT="/metrics"

# Health check endpoint
HEALTH_ENDPOINT="/health"

# Readiness check endpoint
READINESS_ENDPOINT="/ready"

#######################################
# Backup Configuration
#######################################

# Backup directory
BACKUP_DIR="${PROD_DIR}/backups"

# Keep last N backups
BACKUP_KEEP_COUNT=10

#######################################
# Logging Configuration
#######################################

# Log directory
LOG_DIR="${PROD_DIR}/logs"

# Log retention (days)
LOG_RETENTION=30

# Archive old logs
ARCHIVE_LOGS=true

#######################################
# Security Configuration
#######################################

# Environment file permissions
ENV_FILE_PERMISSIONS=600

# Binary file permissions
BINARY_PERMISSIONS=755

#######################################
# Timeout Configuration
#######################################

# SSH connection timeout (seconds)
SSH_TIMEOUT=10

# Build timeout (seconds)
BUILD_TIMEOUT=300

# Migration timeout (seconds)
MIGRATION_TIMEOUT=600

# Smoke test timeout (seconds)
SMOKE_TEST_TIMEOUT=120

#######################################
# Advanced Settings
#######################################

# Dry run mode (set to "true" to test without deploying)
DRY_RUN=false

# Verbose output
VERBOSE=false

# Skip tests (not recommended for production)
SKIP_TESTS=false

# Force deployment (bypass validation)
FORCE_DEPLOY=false

#######################################
# Docker Configuration (if using containers)
#######################################

# PostgreSQL container name
POSTGRES_CONTAINER="listings_postgres"

# Redis container name
REDIS_CONTAINER="listings_redis"

# Docker network
DOCKER_NETWORK="listings_network"

#######################################
# Feature Flags
#######################################

# Enable automatic rollback on errors
AUTO_ROLLBACK=true

# Enable deployment reports
GENERATE_REPORTS=true

# Enable notifications
SEND_NOTIFICATIONS=true

# Enable metrics collection
COLLECT_METRICS=true

#######################################
# Custom Commands (optional)
#######################################

# Pre-deployment hook
PRE_DEPLOY_HOOK=""

# Post-deployment hook
POST_DEPLOY_HOOK=""

# Pre-rollback hook
PRE_ROLLBACK_HOOK=""

# Post-rollback hook
POST_ROLLBACK_HOOK=""

#######################################
# Notes
#######################################

# 1. Never commit .env.deploy to git - add it to .gitignore
# 2. Keep credentials secure - use environment variables or secrets manager
# 3. Test configuration in staging before using in production
# 4. Update ONCALL_ENGINEER regularly based on rotation schedule
# 5. Verify SLACK_WEBHOOK_URL is correct for your team's channel
# 6. Review and adjust timeout values based on your application's needs
# 7. Enable AUTO_ROLLBACK for safety, disable only for hotfixes
# 8. Keep DB_BACKUP_RETENTION high enough for recovery scenarios
